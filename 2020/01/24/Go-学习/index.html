<!DOCTYPE html>
<html lang="zh-Hans">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="wywwzjj">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="wywwzjj">
    
    <meta name="keywords" content="wywwzjj,wywwzjj blog,wywwzjj ctf,wywwzjj web security">
    
    <meta name="description" content>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Go 学习 · wywwzjj&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/B.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/">wywwzjj&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">Go 学习</a>
            </div>
    </div>
    
    <a class="home-link" href="/">wywwzjj's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            Go 学习
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class="post-intro-tags">
    
        <a class="post-tag" href="javascript:void(0);" data-tags="笔记">笔记</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">17.1k</span>阅读时长: <span class="post-count reading-time">79 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/01/24</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h2 id="为什么要学-Go？"><a href="#为什么要学-Go？" class="headerlink" title="为什么要学 Go？"></a>为什么要学 Go？</h2><blockquote>
<p>以下引用自左耳听风专栏。</p>
</blockquote>
<p>第一，<strong>语言简单，上手快</strong>。Go 语言的语法特性简直是太简单了，简单到你几乎玩不出什么花招，直来直去的，学习难度很低，容易上手。</p>
<p>第二，<strong>并行和异步编程几乎无痛点</strong>。Go 语言的 Goroutine 和 Channel 这两个神器简直就是并发和异步编程的巨大福音。像 C、C++、Java、Python 和 JavaScript 这些语言的并发和异步的编程方式控制起来就比较复杂了，并且容易出错，但 Go 语言却用非常优雅和流畅的方式解决了这个问题。这对于编程多年受尽并发和异步折磨的我来说，完全就是眼前一亮的感觉。</p>
<p><img src="https://static001.geekbang.org/resource/image/8d/5f/8df5fd56cbb6343a9030265a5f3a565f.png" alt="img"></p>
<p>（图片来自 Medium：Why should you learn Go?）</p>
<p>第三，<strong>Go 语言的 lib 库 “麻雀虽小，五脏俱全”</strong>。Go 语言的 lib 库中基本上有绝大多数常用的库，虽然有些库还不是很好，但我觉得这都不是主要问题，因为随着技术的发展和成熟，这些问题肯定也都会随之解决。</p>
<p>第四，<strong>C 语言的理念和 Python 的姿态</strong>。C 语言的理念是信任程序员，保持语言的小巧，不屏蔽底层且对底层友好，关注语言的执行效率和性能。而 Python 的姿态是用尽量少的代码完成尽量多的事。于是我能够感觉到，Go 语言是想要把 C 和 Python 统一起来，这是多棒的一件事。</p>
<p><img src="https://static001.geekbang.org/resource/image/03/f7/03ea333bf7b7bb2fe350c4f433047df7.png" alt="img"></p>
<p>（图片来自 Medium：Why should you learn Go?）</p>
<p>所以，即便 Go 语言存在诸多的问题，比如垃圾回收、异常处理、泛型编程等，但相较于上面这几个优势，我认为这些问题都是些小问题。于是就毫不犹豫地入坑了。</p>
<h2 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h2><p>资源合集：<a href="https://github.com/developer-learning/learning-golang" target="_blank" rel="noopener">https://github.com/developer-learning/learning-golang</a></p>
<p>官方教程：<a href="https://learn.go.dev/" target="_blank" rel="noopener">https://learn.go.dev/</a></p>
<p><strong>入门</strong></p>
<p>首首推，通过 TDD 学习 Go <a href="https://studygolang.gitbook.io/learn-go-with-tests/" target="_blank" rel="noopener">https://studygolang.gitbook.io/learn-go-with-tests/</a></p>
<p>首推 <a href="https://gobyexample.com/" target="_blank" rel="noopener">Go by Example</a> 作为你的入门教程。然后，<a href="https://go101.org/article/101.html" target="_blank" rel="noopener">Go 101</a> 也是一个很不错的在线电子书。</p>
<p>The Go Programming Language 中译本：Go 语言圣经</p>
<p>Go 语言官方的 <a href="https://golang.org/doc/effective_go.html" target="_blank" rel="noopener">Effective Go</a> 是必读的，这篇文章告诉你如何更好地使用 Go 语言，以及 Go 语言中的一些原理。</p>
<p>web 开发：<a href="https://github.com/astaxie/build-web-application-with-golang/" target="_blank" rel="noopener">https://github.com/astaxie/build-web-application-with-golang/</a> 33.7k 星</p>
<p><strong>进阶</strong></p>
<p>查询 Go 项目，<a href="https://gowalker.org/，感觉是" target="_blank" rel="noopener">https://gowalker.org/，感觉是</a> GitHub advance search 的封装。</p>
<p>Go 语言高级编程 <a href="https://github.com/chai2010/advanced-go-programming-book" target="_blank" rel="noopener">https://github.com/chai2010/advanced-go-programming-book</a></p>
<p>Go 语言原本 <a href="https://changkun.de/golang/" target="_blank" rel="noopener">https://changkun.de/golang/</a> 学习源码</p>
<p>如何写出优雅的 Go <a href="https://draveness.me/golang-101" target="_blank" rel="noopener">https://draveness.me/golang-101</a></p>
<p><a href="https://github.com/qcrao/Go-Questions" target="_blank" rel="noopener">https://github.com/qcrao/Go-Questions</a></p>
<p><strong>博客</strong></p>
<p>只收录有深度的博客，请享用！</p>
<table>
<thead>
<tr>
<th>博客名</th>
<th>简介</th>
<th>地址</th>
</tr>
</thead>
<tbody><tr>
<td>码农桃花源</td>
<td>本项目作者博客园</td>
<td><a href="https://www.cnblogs.com/qcrao-2018" target="_blank" rel="noopener">https://www.cnblogs.com/qcrao-2018</a></td>
</tr>
<tr>
<td>欧神开源书《Go 语言原本》</td>
<td>Golang committers</td>
<td><a href="https://changkun.de/golang" target="_blank" rel="noopener">https://changkun.de/golang</a></td>
</tr>
<tr>
<td>No Headback</td>
<td>滴滴技术大神曹春晖</td>
<td><a href="http://xargin.com/" target="_blank" rel="noopener">http://xargin.com</a></td>
</tr>
<tr>
<td>面向信仰编程</td>
<td>给 kubernetes 提交 pr 的大神</td>
<td><a href="https://draveness.me/" target="_blank" rel="noopener">https://draveness.me</a></td>
</tr>
<tr>
<td>煎鱼的迷之博客</td>
<td>知其然，知其所以然</td>
<td><a href="https://github.com/EDDYCJY/blog" target="_blank" rel="noopener">https://github.com/EDDYCJY/blog</a></td>
</tr>
</tbody></table>
<p>Go 语言最突出之处是并发编程，Unix 老牌黑客罗勃・派克（Rob Pike）在 Google I/O 上的两个分享，可以让你学习到一些并发编程的模式。</p>
<ul>
<li>Go Concurrency Patterns（ <a href="https://talks.golang.org/2012/concurrency.slide" target="_blank" rel="noopener">幻灯片</a>和<a href="https://www.youtube.com/watch?v=f6kdp27TYZs" target="_blank" rel="noopener">演讲视频</a>）。</li>
<li>Advanced Go Concurrency Patterns（<a href="https://talks.golang.org/2013/advconc.slide" target="_blank" rel="noopener">幻灯片</a>、<a href="https://youtu.be/QDDwwePbDtw" target="_blank" rel="noopener">演讲视频</a>）。</li>
</ul>
<p>然后，Go 在 GitHub 的 wiki 上有好多不错的学习资源，你可以从中学习到多。比如：</p>
<ul>
<li><a href="https://github.com/golang/go/wiki/Articles" target="_blank" rel="noopener">Go 精华文章列表</a>。</li>
<li><a href="https://github.com/golang/go/wiki/Blogs" target="_blank" rel="noopener">Go 相关博客列表</a>。</li>
<li><a href="https://github.com/golang/go/wiki/GoTalks" target="_blank" rel="noopener">Go Talks</a>。</li>
</ul>
<p>此外，还有个内容丰富的 Go 资源列表 <a href="https://github.com/avelino/awesome-go" target="_blank" rel="noopener">Awesome Go</a>，推荐看看。</p>
<p>类似 awesome-go <a href="https://github.com/hackstoic/golang-open-source-projects" target="_blank" rel="noopener">https://github.com/hackstoic/golang-open-source-projects</a></p>
<p>Go roadmap <a href="https://github.com/Alikhll/golang-developer-roadmap" target="_blank" rel="noopener">https://github.com/Alikhll/golang-developer-roadmap</a></p>
<p><a href="http://tmrts.com/go-patterns/" target="_blank" rel="noopener">http://tmrts.com/go-patterns/</a></p>
<p>Uber Go Style Guide <a href="https://github.com/uber-go/guide/blob/master/style.md" target="_blank" rel="noopener">https://github.com/uber-go/guide/blob/master/style.md</a></p>
<p>官方规范 <a href="https://github.com/golang/go/wiki/CodeReviewComments" target="_blank" rel="noopener">https://github.com/golang/go/wiki/CodeReviewComments</a></p>
<p>GoLand Tips &amp; Tricks <a href="https://www.bilibili.com/video/av57075824" target="_blank" rel="noopener">https://www.bilibili.com/video/av57075824</a></p>
<p>Goroutine Leak 检测器，Uber出品。<a href="https://github.com/uber-go/goleak" target="_blank" rel="noopener">https://github.com/uber-go/goleak</a></p>
<h2 id="有关安全项目"><a href="#有关安全项目" class="headerlink" title="有关安全项目"></a>有关安全项目</h2><p>库</p>
<ul>
<li>gopacket - Go语言用于处理网络数据包的库</li>
<li>xorm - Go语言实现的ORM库，支持多种数据库</li>
</ul>
<p>代码安全</p>
<ul>
<li>Go-SCP - Go语言安全编码实践指南</li>
<li>gosec - Go语言源码安全分析工具</li>
</ul>
<p>安全工具</p>
<ul>
<li>certigo - Go语言编写用于检查/验证证书信息的命令行工具</li>
<li>Blind-SQL-Injector - Go语言编写的手工盲注辅助工具</li>
<li>lonely-shell - Go语言实现的反弹Shell后门</li>
<li>hershell - Go语言反弹Shell后门</li>
<li>go-deliver - Go语言编写的Payload交互工具</li>
<li>go-shellcode - Go语言编写的ShellCode执行工具</li>
<li>go-mimikatz - Go语言版本的Mimikatz</li>
<li>NtlmSocks - 一个工作在网络层的跨平台哈希传递工具</li>
<li>CHAOS - Go语言编写的Windows远控工具</li>
<li>judas - Go语言编写的反向钓鱼工具</li>
<li>Modlishka - Go语言编写的反向代理钓鱼工具</li>
<li>Gophish - Go语言编写的开源钓鱼框架</li>
<li>goddi - Go语言编写的活动目录信息导出工具</li>
<li>goHackTools - Go语言编写的黑客工具集</li>
<li>honeybits - 一款Go语言开发的蜜罐</li>
<li>xsec-checker - Go语言编写的服务器安全检测辅助工具</li>
<li>janusec - Golang打造的开源WAF网关</li>
<li>xsec-ip-database - Go语言实现的恶意IP和域名库</li>
<li>xsec-traffic - Go语言编写的轻量级恶意流量分析程序</li>
<li>GoCrack - Go语言编写密码爆破平台</li>
</ul>
<p>扫描工具</p>
<ul>
<li>blacksheepwall - Go语言编写的域名信息搜集工具</li>
<li>amass - Go语言编写的子域名收集工具</li>
<li>vuls - Go语言编写的Linux/FreeBSD漏洞扫描器</li>
<li>gryffin - 大规模Web安全扫描平台</li>
<li>Gobuster - Kai下敏感目录扫描工具</li>
<li>OnionScan - Go语言编写的暗网扫描仪</li>
<li>x-crack - Go语言编写的弱口令扫描器</li>
<li>kraken - Go语言编写的YARA跨平台扫描器</li>
</ul>
<p>网络工具</p>
<ul>
<li>GoReplay - Go语言编写HTTP流量记录重放工具</li>
<li>NATBypass - LCX/Htran在Golang下的实现</li>
<li>ngrok - 反向代理/内网穿透工具</li>
<li>brook - Go语言编写的一款跨平台代理应用</li>
<li>Hyperfox - HTTP/HTTPS流量监控工具</li>
<li>gost - Go语言编写多功能网络代理转发工具</li>
<li>gomitmproxy - Go语言实现的Mitmproxy</li>
<li>netcap - Go语言编写的网络流量分析框架</li>
</ul>
<h2 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h2><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>每个类型都有默认的初值，比如 0，“”，false</p>
<p>定义的变量必须要用到，实在不用的可以用 “_”</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a, b, c <span class="keyword">int</span> = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b, c = <span class="number">1</span>, <span class="string">'a'</span>, <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    home = os.Getenv(<span class="string">"HOME"</span>)</span><br><span class="line">    user = os.Getenv(<span class="string">"USER"</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">a, b, c := <span class="number">1</span>, <span class="string">'a'</span>, <span class="literal">false</span>  <span class="comment">// 只能在函数内使用</span></span><br></pre></td></tr></table></figure>

<h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><blockquote>
<p>必须显式强制类型转换</p>
</blockquote>
<p>布尔：bool</p>
<p>整型：int、(u)int8、(u)int16、(u)int32、(u)int64、uintptr</p>
<p>浮点：float32、float64、原生复数：complex64、complex128</p>
<p>字符串：string</p>
<p>字符：rune（int32 别名）</p>
<p>byte：（int8 别名）</p>
<p><strong>派生：</strong></p>
<ul>
<li>结构体 struct</li>
<li>channel</li>
<li>func</li>
<li>slice</li>
<li>interface</li>
<li>map</li>
</ul>
<p>可用 type 设置别名</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> S <span class="keyword">string</span></span><br></pre></td></tr></table></figure>

<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Go operator precedence:</span><br><span class="line">1. *   /   %  &lt;&lt;  &gt;&gt;  &amp;  &amp;^</span><br><span class="line">2. +   -   |  ^</span><br><span class="line">3. ==  !=  &lt;  &lt;=  &gt;   &gt;=</span><br><span class="line">4. &amp;&amp;</span><br><span class="line">5. ||</span><br></pre></td></tr></table></figure>

<h3 id="new-与-make"><a href="#new-与-make" class="headerlink" title="new 与 make"></a>new 与 make</h3><p>Go 提供了两种分配原语，即 new 和 make。</p>
<p>new 是分配一个内存，返回一个内存地址，它不会初始化内存，只会将内存置零。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> SyncedBuffer <span class="keyword">struct</span> &#123;</span><br><span class="line">    lock sync.Mutex</span><br><span class="line">    buffer bytes.Buffer</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p := <span class="built_in">new</span>(SyncedBuffer)  <span class="comment">// type *SyncedBuffer</span></span><br></pre></td></tr></table></figure>

<p>make 只用于创建 slice、map 和 channel，并返回一个“已初始化”的值。</p>
<h3 id="常量与枚举"><a href="#常量与枚举" class="headerlink" title="常量与枚举"></a>常量与枚举</h3><p>未指定类型的常量类似替换，不需要关心类型转换</p>
<p>Go 里的大写有其他含义，常量不再大写</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> b <span class="keyword">string</span> = <span class="string">"string"</span>  <span class="comment">// 指定后需要显式类型转换</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="string">"string"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举</span></span><br><span class="line"><span class="keyword">const</span>(</span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    c = <span class="number">3</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span>(</span><br><span class="line">    cpp = ioat</span><br><span class="line">    python</span><br><span class="line">    java</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span>(</span><br><span class="line">    _ = <span class="literal">iota</span>  <span class="comment">// 通过赋予空白标识符来忽略第一个值</span></span><br><span class="line">    b = <span class="number">1</span> &lt;&lt; (<span class="number">10</span> * <span class="literal">iota</span>)</span><br><span class="line">    kb</span><br><span class="line">    mb</span><br><span class="line">    gb</span><br><span class="line">    tb</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> contents, err := ioutil.ReadFile(filename); err != <span class="literal">nil</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认添加了 break，不 break 需指定</span></span><br><span class="line"><span class="keyword">switch</span> i &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">g := <span class="string">""</span></span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> g:</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">whatAmI := <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> t := i.(<span class="keyword">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">bool</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">whatAmI(<span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">i := <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i &lt;= <span class="number">3</span> &#123;</span><br><span class="line">    fmt.Println(i)</span><br><span class="line">    i </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt; <span class="number">3</span>; j++ &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"loop"</span>)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>Go 只有值传递，每次传值都拷贝了一个副本，只是这副本里的某个部分可能指着同一块内存，比如 slice。</p>
<p>可传递指针</p>
<p>返回一个局部变量的地址没有问题，该局部变量对应的数据在函数返回后依然有效，编译器采用逃逸分析技术。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 返回多个值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">eval</span><span class="params">(a, b <span class="keyword">int</span>, opt <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>, fmt.Errorf(<span class="string">"error: %s"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回值命名</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span> <span class="title">t</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    t = <span class="string">"test"</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数参数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">apply</span><span class="params">(op <span class="keyword">func</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">int</span>, <span class="title">a</span>, <span class="title">b</span> <span class="title">int</span>) <span class="title">int</span></span> &#123;</span><br><span class="line">    p := reflect.ValueOf(op).Pointer()</span><br><span class="line">    opName := runtime.FuncForPC(p).Name()</span><br><span class="line">    fmt.Printf(<span class="string">"Calling function %s with args %d, %d"</span>, opName, a, b)</span><br><span class="line">    <span class="keyword">return</span> op(a, b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匿名函数</span></span><br><span class="line">apply(<span class="function"><span class="keyword">func</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匿名函数递归，不直接支持。</span></span><br><span class="line"><span class="keyword">var</span> f <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">f</span> = <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    f()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可变参数列表，无默认参数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sumArgs</span><span class="params">(members ...<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    s := <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> numbers &#123;</span><br><span class="line">        s += numbers[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">arr := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">sumArgs(arr...)</span><br></pre></td></tr></table></figure>

<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>指针不能运算</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="keyword">int</span> = <span class="number">2</span></span><br><span class="line"><span class="keyword">var</span> pa *<span class="keyword">int</span> = &amp;a</span><br><span class="line">*pa = <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>Go 一般不用数组，用切片</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr [<span class="number">5</span>]<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">b := [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">b := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> grid [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> grid [][]<span class="keyword">int</span> = [][]<span class="keyword">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">grid := [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> grid &#123;</span><br><span class="line">    fmt.Println(k, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [10]int，[5]int 是不同类型，数组传递是值传递，会拷贝</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printArray</span><span class="params">(arr [10]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    fmt.Println(arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><p>切片本身没有数据，是对底层数组的一个 view，是功能强悍的”动态数组“。</p>
<p>切片通过对数组进行封装，为数据序列提供了更通用、强大的接口。</p>
<p>除了矩阵变换这类需要明确维度的情况外， Go 中大部分数组编程都是通过切片来实现的。</p>
<p>切片保存了对底层数组的引用，若将某个切片赋值给另一个切片，它们将引用同一个数组。</p>
<p><code>len(s)</code> 用来获取长度，当前有多少个值，用了多少</p>
<p><code>cap(s)</code> 切片总容量</p>
<p><code>append(s, tg)</code> 添加元素</p>
<p><code>copy(dst, src)</code> 拷贝切片</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">slice := []<span class="keyword">int</span></span><br><span class="line">slice := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line">slice := <span class="built_in">make</span>([]<span class="keyword">type</span>, <span class="built_in">len</span>)  <span class="comment">// 创建空切片，可不指定 cap</span></span><br><span class="line">slice := <span class="built_in">make</span>([]<span class="keyword">type</span>, <span class="built_in">len</span>, <span class="built_in">cap</span>)</span><br><span class="line"></span><br><span class="line">fmt.Println(arr[:])</span><br><span class="line">fmt.Println(arr[:<span class="number">3</span>])</span><br><span class="line">fmt.Println(arr[<span class="number">2</span>:])</span><br><span class="line">fmt.Println(arr[<span class="number">3</span>:<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多次切片，可以超过上次切片范围，不可超过 cap(s)，即向后扩展</span></span><br><span class="line">s := arr[<span class="number">3</span>:<span class="number">5</span>]</span><br><span class="line">rs := s[<span class="number">4</span>:<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展，由于是值传递，必须用个变量来接收，底层将创建一个新的 array 来支撑切片</span></span><br><span class="line">b = <span class="built_in">append</span>(b, <span class="number">10</span>)</span><br><span class="line">b = <span class="built_in">append</span>(b, s...)  <span class="comment">// 不能 +，但可变参数能直接添加切片</span></span><br><span class="line">fmt.Println(b)</span><br></pre></td></tr></table></figure>

<h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">intList := []<span class="keyword">int</span>&#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>&#125;</span><br><span class="line">float8List := []<span class="keyword">float64</span>&#123;<span class="number">4.2</span>, <span class="number">5.9</span>, <span class="number">12.3</span>, <span class="number">10.0</span>, <span class="number">50.4</span>, <span class="number">99.9</span>, <span class="number">31.4</span>, <span class="number">27.81828</span>, <span class="number">3.14</span>&#125;</span><br><span class="line">stringList := []<span class="keyword">string</span>&#123;<span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"b"</span>, <span class="string">"d"</span>, <span class="string">"f"</span>, <span class="string">"i"</span>, <span class="string">"z"</span>, <span class="string">"x"</span>, <span class="string">"w"</span>, <span class="string">"y"</span>&#125;</span><br><span class="line"></span><br><span class="line">sort.Ints(intList)</span><br><span class="line">sort.Sort(sort.IntSlice(intList))</span><br><span class="line">sort.Sort(sort.Reverse(sort.IntSlice(intList)))</span><br><span class="line">sort.Sort(sort.Reverse(sort.Float64Slice(float8List)))</span><br><span class="line">sort.Sort(sort.Reverse(sort.StringSlice(stringList)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为什么好好的 []int 类型还要类型转换一次呢？答案在下面，只有这个别名类型才实现了这些接口。</span></span><br><span class="line"><span class="comment">// 是不是还与 Go 的显式类型转换有关？</span></span><br><span class="line"><span class="keyword">type</span> IntSlice []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p IntSlice)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span>           &#123; <span class="keyword">return</span> <span class="built_in">len</span>(p) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p IntSlice)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123; <span class="keyword">return</span> p[i] &lt; p[j] &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p IntSlice)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span>      &#123; p[i], p[j] = p[j], p[i] &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sort is a convenience method.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p IntSlice)</span> <span class="title">Sort</span><span class="params">()</span></span> &#123; Sort(p) &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义排序</span></span><br><span class="line">sort.Slice(arr, <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    	<span class="keyword">return</span> arr[i][<span class="number">0</span>] &lt; arr[j][<span class="number">0</span>]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个为内置 `[]string` 类型的别名的 `ByLength` 类型</span></span><br><span class="line"><span class="keyword">type</span> ByLength []<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 `sort.Interface` 的 `Len`，`Less` 和 `Swap` 方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s ByLength)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s ByLength)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    s[i], s[j] = s[j], s[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s ByLength)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(s[i]) &lt; <span class="built_in">len</span>(s[j])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fruits := []<span class="keyword">string</span>&#123;<span class="string">"peach"</span>, <span class="string">"banana"</span>, <span class="string">"kiwi"</span>&#125;</span><br><span class="line">sort.Sort(ByLength(fruits))</span><br></pre></td></tr></table></figure>

<h4 id="就地去重，需要先排序"><a href="#就地去重，需要先排序" class="headerlink" title="就地去重，需要先排序"></a>就地去重，需要先排序</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"sort"</span></span><br><span class="line"></span><br><span class="line">in := []<span class="keyword">int</span>&#123;<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">1</span>&#125; <span class="comment">// any item can be sorted</span></span><br><span class="line">sort.Ints(in)</span><br><span class="line">j := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(in); i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> in[j] == in[i] &#123;</span><br><span class="line">    	<span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    j++</span><br><span class="line">    <span class="comment">// preserve the original data</span></span><br><span class="line">    <span class="comment">// in[i], in[j] = in[j], in[i]</span></span><br><span class="line">    <span class="comment">// only set what is required</span></span><br><span class="line">    in[j] = in[i]</span><br><span class="line">&#125;</span><br><span class="line">result := in[:j+<span class="number">1</span>]</span><br><span class="line">fmt.Println(result) <span class="comment">// [1 2 3 4]</span></span><br></pre></td></tr></table></figure>

<h4 id="删除元素"><a href="#删除元素" class="headerlink" title="删除元素"></a>删除元素</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">a = <span class="built_in">append</span>(a[:i], a[i+<span class="number">1</span>:]...)</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">a = a[:i+<span class="built_in">copy</span>(a[i:], a[i+<span class="number">1</span>:])]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 快版本，改变了相对顺序</span></span><br><span class="line">a := []<span class="keyword">string</span>&#123;<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>&#125;</span><br><span class="line">i := <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Remove the element at index i from a.</span></span><br><span class="line">a[i] = a[<span class="built_in">len</span>(a)<span class="number">-1</span>] <span class="comment">// Copy last element to index i.</span></span><br><span class="line">a[<span class="built_in">len</span>(a)<span class="number">-1</span>] = <span class="string">""</span>   <span class="comment">// Erase last element (write zero value).</span></span><br><span class="line">a = a[:<span class="built_in">len</span>(a)<span class="number">-1</span>]   <span class="comment">// Truncate slice.</span></span><br><span class="line"></span><br><span class="line">fmt.Println(a) <span class="comment">// [A B E D]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 慢版本，保持相对顺序</span></span><br><span class="line"><span class="built_in">copy</span>(a[i:], a[i+<span class="number">1</span>:]) <span class="comment">// Shift a[i+1:] left one index.</span></span><br><span class="line">a[<span class="built_in">len</span>(a)<span class="number">-1</span>] = <span class="string">""</span>     <span class="comment">// Erase last element (write zero value).</span></span><br><span class="line">a = a[:<span class="built_in">len</span>(a)<span class="number">-1</span>]     <span class="comment">// Truncate slice.</span></span><br></pre></td></tr></table></figure>

<h4 id="切片比较"><a href="#切片比较" class="headerlink" title="切片比较"></a>切片比较</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">reflect.DeepEqual(s1, s2)</span><br><span class="line"><span class="comment">// 还可以用来比较 map</span></span><br></pre></td></tr></table></figure>

<h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><p>To replace the contents of a slice with the same elements but in reverse order:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="built_in">len</span>(a)/<span class="number">2</span><span class="number">-1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">    opp := <span class="built_in">len</span>(a)<span class="number">-1</span>-i</span><br><span class="line">    a[i], a[opp] = a[opp], a[i]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The same thing, except with two indices:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> left, right := <span class="number">0</span>, <span class="built_in">len</span>(a)<span class="number">-1</span>; left &lt; right; left, right = left+<span class="number">1</span>, right<span class="number">-1</span> &#123;</span><br><span class="line">    a[left], a[right] = a[right], a[left]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="底层结构"><a href="#底层结构" class="headerlink" title="底层结构"></a>底层结构</h4><p><a href="https://github.com/golang/go/blob/440f7d64048cd94cba669e16fe92137ce6b84073/src/runtime/slice.go" target="_blank" rel="noopener">https://github.com/golang/go/blob/440f7d64048cd94cba669e16fe92137ce6b84073/src/runtime/slice.go</a></p>
<p>加深理解：<a href="https://www.calhoun.io/why-are-slices-sometimes-altered-when-passed-by-value-in-go/" target="_blank" rel="noopener">https://www.calhoun.io/why-are-slices-sometimes-altered-when-passed-by-value-in-go/</a></p>
<p>所以传值的时候，slice 对应的变量是拷贝的，但里面指向的 array 没变，除非 append 等操作改变了这个指针。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">type slice struct &#123;</span><br><span class="line">    array unsafe.Pointer</span><br><span class="line">    len   int</span><br><span class="line">    cap   int</span><br><span class="line">&#125;</span><br><span class="line">      +--------+</span><br><span class="line">      |        |</span><br><span class="line">      |  ptr   |+------------+-------+-----------+</span><br><span class="line">      |        |                     |           |</span><br><span class="line">      +--------+                     |           |</span><br><span class="line">      |        |                     |           |</span><br><span class="line">      |        |                     |           |</span><br><span class="line">      | len  5 |                     |           |</span><br><span class="line">      |        |                     |           |</span><br><span class="line">      +--------+                     v           v</span><br><span class="line">      |        |             +-----+-----+-----+-----+----+</span><br><span class="line">      |        |             |     |     |     |     |    |</span><br><span class="line">      | cap  5 |     [5]int  |  0  |  1  |  2  |  3  | 4  |</span><br><span class="line">      |        |             +-----+-----+-----+-----+----+</span><br><span class="line">      +--------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       slice := arr[1:4]             arr := [5]int&#123;0,1,2,3,4&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">0</span>, <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++ &#123;</span><br><span class="line">    	s = <span class="built_in">append</span>(s, i)</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(s)</span><br><span class="line">    fmt.Println(<span class="built_in">len</span>(s), <span class="built_in">cap</span>(s))</span><br><span class="line">    fmt.Println(s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reverse</span><span class="params">(s []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    newElem := <span class="number">999</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">len</span>(s) &lt; <span class="built_in">cap</span>(s) &#123;</span><br><span class="line">    	fmt.Println(<span class="string">"Adding an element:"</span>, newElem, <span class="string">"cap:"</span>, <span class="built_in">cap</span>(s), <span class="string">"len:"</span>, <span class="built_in">len</span>(s))</span><br><span class="line">    	s = <span class="built_in">append</span>(s, newElem)</span><br><span class="line">    	newElem++</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(<span class="built_in">len</span>(s), <span class="built_in">cap</span>(s))</span><br><span class="line">    fmt.Println(s)</span><br><span class="line">    <span class="keyword">for</span> i, j := <span class="number">0</span>, <span class="built_in">len</span>(s)<span class="number">-1</span>; i &lt; j; i++ &#123;</span><br><span class="line">    	j = <span class="built_in">len</span>(s) - (i + <span class="number">1</span>)</span><br><span class="line">    	s[i], s[j] = s[j], s[i]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这样的结果就很容易理解了</span></span><br><span class="line">Adding an element: <span class="number">999</span> <span class="built_in">cap</span>: <span class="number">7</span> <span class="built_in">len</span>: <span class="number">3</span></span><br><span class="line">Adding an element: <span class="number">1000</span> <span class="built_in">cap</span>: <span class="number">7</span> <span class="built_in">len</span>: <span class="number">4</span></span><br><span class="line">Adding an element: <span class="number">1001</span> <span class="built_in">cap</span>: <span class="number">7</span> <span class="built_in">len</span>: <span class="number">5</span></span><br><span class="line">Adding an element: <span class="number">1002</span> <span class="built_in">cap</span>: <span class="number">7</span> <span class="built_in">len</span>: <span class="number">6</span></span><br><span class="line"><span class="number">7</span> <span class="number">7</span></span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">999</span> <span class="number">1000</span> <span class="number">1001</span> <span class="number">1002</span>]</span><br><span class="line"><span class="number">3</span> <span class="number">7</span></span><br><span class="line">[<span class="number">1002</span> <span class="number">1001</span> <span class="number">1000</span>]</span><br></pre></td></tr></table></figure>

<h4 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">b = make([]T, len(a))</span><br><span class="line">copy(b, a)</span><br><span class="line">// or</span><br><span class="line">b = append([]T(nil), a...)</span><br><span class="line">// or</span><br><span class="line">b = append(a[:0:0], a...)  // See https://github.com/go101/go101/wiki</span><br></pre></td></tr></table></figure>

<h4 id="Cut"><a href="#Cut" class="headerlink" title="Cut"></a>Cut</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append(a[:i], a[j:]...)</span><br></pre></td></tr></table></figure>

<h4 id="Delete-without-preserving-order"><a href="#Delete-without-preserving-order" class="headerlink" title="Delete without preserving order"></a>Delete without preserving order</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a[i] = a[len(a)-1] </span><br><span class="line">a = a[:len(a)-1]</span><br></pre></td></tr></table></figure>

<p><strong>NOTE</strong> If the type of the element is a <em>pointer</em> or a struct with pointer fields, which need to be garbage collected, the above implementations of <code>Cut</code> and <code>Delete</code> have a potential <em>memory leak</em> problem: some elements with values are still referenced by slice <code>a</code> and thus can not be collected. The following code can fix this problem:</p>
<blockquote>
<p><strong>Cut</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy(a[i:], a[j:])</span><br><span class="line">for k, n := len(a)-j+i, len(a); k &lt; n; k++ &#123;</span><br><span class="line">    a[k] = nil // or the zero value of T</span><br><span class="line">&#125;</span><br><span class="line">a = a[:len(a)-j+i]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Delete</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if i &lt; len(a)-1 &#123;</span><br><span class="line">  copy(a[i:], a[i+1:])</span><br><span class="line">&#125;</span><br><span class="line">a[len(a)-1] = nil // or the zero value of T</span><br><span class="line">a = a[:len(a)-1]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Delete without preserving order</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a[i] = a[len(a)-1]</span><br><span class="line">a[len(a)-1] = nil</span><br><span class="line">a = a[:len(a)-1]</span><br></pre></td></tr></table></figure>

<h4 id="Expand"><a href="#Expand" class="headerlink" title="Expand"></a>Expand</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append(a[:i], append(make([]T, j), a[i:]...)...)</span><br></pre></td></tr></table></figure>

<h4 id="Extend"><a href="#Extend" class="headerlink" title="Extend"></a>Extend</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append(a, make([]T, j)...)</span><br></pre></td></tr></table></figure>

<h4 id="Filter-in-place"><a href="#Filter-in-place" class="headerlink" title="Filter (in place)"></a>Filter (in place)</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">n := 0</span><br><span class="line">for _, x := range a &#123;</span><br><span class="line">    if keep(x) &#123;</span><br><span class="line">    	a[n] = x</span><br><span class="line">    	n++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">a = a[:n]</span><br></pre></td></tr></table></figure>

<h4 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append(a[:i], append([]T&#123;x&#125;, a[i:]...)...)</span><br></pre></td></tr></table></figure>

<p><strong>NOTE</strong> The second <code>append</code> creates a new slice with its own underlying storage and copies elements in <code>a[i:]</code> to that slice, and these elements are then copied back to slice <code>a</code> (by the first <code>append</code>). The creation of the new slice (and thus memory garbage) and the second copy can be avoided by using an alternative way:</p>
<blockquote>
<p><strong>Insert</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s = append(s, 0 /* use the zero value of the element type */)</span><br><span class="line">copy(s[i+1:], s[i:])</span><br><span class="line">s[i] = x</span><br></pre></td></tr></table></figure>

<h4 id="InsertVector"><a href="#InsertVector" class="headerlink" title="InsertVector"></a>InsertVector</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append(a[:i], append(b, a[i:]...)...)</span><br></pre></td></tr></table></figure>

<h4 id="Push-Front-Unshift"><a href="#Push-Front-Unshift" class="headerlink" title="Push Front/Unshift"></a>Push Front/Unshift</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a = append([]T&#123;x&#125;, a...)</span><br></pre></td></tr></table></figure>

<h4 id="Pop-Front-Shift"><a href="#Pop-Front-Shift" class="headerlink" title="Pop Front/Shift"></a>Pop Front/Shift</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">x, a = a[0], a[1:]</span><br></pre></td></tr></table></figure>

<h3 id="Filtering-without-allocating"><a href="#Filtering-without-allocating" class="headerlink" title="Filtering without allocating"></a>Filtering without allocating</h3><p>This trick uses the fact that a slice shares the same backing array and capacity as the original, so the storage is reused for the filtered slice. Of course, the original contents are modified.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">b := a[:0]</span><br><span class="line">for _, x := range a &#123;</span><br><span class="line">    if f(x) &#123;</span><br><span class="line">    	b = append(b, x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For elements which must be garbage collected, the following code can be included afterwards:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for i := len(b); i &lt; len(a); i++ &#123;</span><br><span class="line">    a[i] = nil // or the zero value of T</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Reversing"><a href="#Reversing" class="headerlink" title="Reversing"></a>Reversing</h3><h3 id="Shuffling"><a href="#Shuffling" class="headerlink" title="Shuffling"></a>Shuffling</h3><p>Fisher–Yates algorithm:</p>
<blockquote>
<p>Since go1.10, this is available at <a href="https://godoc.org/math/rand#Shuffle" target="_blank" rel="noopener">math/rand.Shuffle</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for i := len(a) - 1; i &gt; 0; i-- &#123;</span><br><span class="line">    j := rand.Intn(i + 1)</span><br><span class="line">    a[i], a[j] = a[j], a[i]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Batching-with-minimal-allocation"><a href="#Batching-with-minimal-allocation" class="headerlink" title="Batching with minimal allocation"></a>Batching with minimal allocation</h3><p>Useful if you want to do batch processing on large slices.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">actions := []int&#123;0, 1, 2, 3, 4, 5, 6, 7, 8, 9&#125;</span><br><span class="line">batchSize := 3</span><br><span class="line">batches := make([][]int, 0, (len(actions) + batchSize - 1) / batchSize)</span><br><span class="line"></span><br><span class="line">for batchSize &lt; len(actions) &#123;</span><br><span class="line">    actions, batches = actions[batchSize:], append(batches, actions[0:batchSize:batchSize])</span><br><span class="line">&#125;</span><br><span class="line">batches = append(batches, actions)</span><br></pre></td></tr></table></figure>

<p>Yields the following:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[[0 1 2] [3 4 5] [6 7 8] [9]]</span><br></pre></td></tr></table></figure>

<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>哈希表实现，除了 slice、map、function 的内建类型都可以做 key，不含这些字段的 Struct 也可</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)  <span class="comment">// 创建空map</span></span><br><span class="line">m[<span class="string">"one"</span>] = <span class="number">1</span></span><br><span class="line">m[<span class="string">"two"</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span> &#123;</span><br><span class="line">    <span class="string">"one"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">"two"</span>: <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> m <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问，不存在放回 nil</span></span><br><span class="line">one := m[<span class="string">"one"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否存在，为啥能选择返回值？</span></span><br><span class="line">one, ok := m[<span class="string">"one"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">    fmt.Println(k, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">delete</span>(m, <span class="string">"one"</span>)</span><br></pre></td></tr></table></figure>

<h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><blockquote>
<p>项目要用的话直接 import “github.com/golang-collections/collections/stack”</p>
<p>用 list 实现 stack</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> stack</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> <span class="string">"container/list"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Stack <span class="keyword">struct</span> &#123;</span><br><span class="line">    list *list.List</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStack</span><span class="params">()</span> *<span class="title">Stack</span></span> &#123;</span><br><span class="line">    list := list.New()</span><br><span class="line">    <span class="keyword">return</span> &amp;Stack&#123;list&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stack *Stack)</span> <span class="title">Push</span><span class="params">(value <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    stack.list.PushBack(value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stack *Stack)</span> <span class="title">Pop</span><span class="params">()</span> <span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">    e := stack.list.Back()</span><br><span class="line">    <span class="keyword">if</span> e != <span class="literal">nil</span> &#123;</span><br><span class="line">        stack.list.Remove(e)</span><br><span class="line">        <span class="keyword">return</span> e.Value</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stack *Stack)</span> <span class="title">Peak</span><span class="params">()</span> <span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">    e := stack.list.Back()</span><br><span class="line">    <span class="keyword">if</span> e != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> e.Value</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stack *Stack)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> stack.list.Len()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stack *Stack)</span> <span class="title">Empty</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> stack.list.Len() == <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="heap"><a href="#heap" class="headerlink" title="heap"></a>heap</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>Go 特意做了优化，设计了 rune，可以完美的支持多语言。</p>
<p><code>&#39;a&#39;</code> 为字符 rune、<code>&quot;abc&quot;</code> 为字符串，`` 可包含复杂的字符串。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">s := <span class="string">"我爱Go语言!"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, ch := <span class="keyword">range</span> []<span class="keyword">rune</span>(s) &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"(%d %c)"</span>, i, ch)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// (0 我)(1 爱)(2 G)(3 o)(4 语)(5 言)(6 !)</span></span><br><span class="line"></span><br><span class="line">s[i] 并不是字符串，而是 <span class="keyword">uint8</span>，即 ASCII 码，需要转一下 str := <span class="keyword">string</span>(s[i])</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">fmt.Printf(<span class="string">"%t\n"</span>, <span class="number">1</span>==<span class="number">2</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%t\n"</span>, <span class="literal">true</span>)  <span class="comment">// 格式化布尔值是简单的。</span></span><br><span class="line">fmt.Printf(<span class="string">"二进制：%b\n"</span>, <span class="number">255</span>)</span><br><span class="line">fmt.Printf(<span class="string">"八进制：%o\n"</span>, <span class="number">255</span>)</span><br><span class="line">fmt.Printf(<span class="string">"十进制：%d\n"</span>, <span class="number">255</span>)</span><br><span class="line">fmt.Printf(<span class="string">"十六进制：%X\n"</span>, <span class="number">255</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%c\n"</span>, <span class="number">33</span>)  <span class="comment">// 这个输出给定整数的对应字符。</span></span><br><span class="line">fmt.Printf(<span class="string">"浮点数：%f\n"</span>, math.Pi)</span><br><span class="line">fmt.Printf(<span class="string">"字符串：%s\n"</span>, <span class="string">"hello world"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%q\n"</span>, <span class="string">"\"string\""</span>)  <span class="comment">// 带双引号的字符串</span></span><br><span class="line">fmt.Printf(<span class="string">"%p\n"</span>, &amp;p)  <span class="comment">// 指针</span></span><br><span class="line">fmt.Printf(<span class="string">"类型：%T\n"</span>, <span class="string">"hello world"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"字段在内的实例的完整信息：%+v\n"</span>, <span class="string">"hello world"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"字段和限定类型名称在内的实例的完整信息：%#v\n"</span>, <span class="string">"hello world"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Go 为常规 Go 值的格式化设计提供了多种打印方式。例如，这里打印了 `point` 结构体的一个实例。</span></span><br><span class="line">p := point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">fmt.Printf(<span class="string">"%v\n"</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果值是一个结构体，`%+v` 的格式化输出内容将包括结构体的字段名。</span></span><br><span class="line">fmt.Printf(<span class="string">"%+v\n"</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="comment">// `%#v` 形式则输出这个值的 Go 语法表示。例如，值的运行源代码片段。</span></span><br><span class="line">fmt.Printf(<span class="string">"%#v\n"</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要打印值的类型，使用 `%T`。</span></span><br><span class="line">fmt.Printf(<span class="string">"%T\n"</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="comment">// `%e` 和 `%E` 将浮点型格式化为（稍微有一点不同的）科学记数法表示形式。</span></span><br><span class="line">fmt.Printf(<span class="string">"%e\n"</span>, <span class="number">123400000.0</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%E\n"</span>, <span class="number">123400000.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 和上面的整型数一样，`%x` 输出使用 base-16 编码的字符串，每个字节使用 2 个字符表示。</span></span><br><span class="line">fmt.Printf(<span class="string">"%x\n"</span>, <span class="string">"hex this"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当输出数字的时候，你将经常想要控制输出结果的宽度和精度，可以使用在 `%` 后面使用数字来控制输出宽度。</span></span><br><span class="line"><span class="comment">// 默认结果使用右对齐并且通过空格来填充空白部分。</span></span><br><span class="line">fmt.Printf(<span class="string">"|%6d|%6d|\n"</span>, <span class="number">12</span>, <span class="number">345</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你也可以指定浮点型的输出宽度，同时也可以通过 宽度.精度 的语法来指定输出的精度。</span></span><br><span class="line">fmt.Printf(<span class="string">"|%6.2f|%6.2f|\n"</span>, <span class="number">1.2</span>, <span class="number">3.45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 要左对齐，使用 `-` 标志。</span></span><br><span class="line">fmt.Printf(<span class="string">"|%-6.2f|%-6.2f|\n"</span>, <span class="number">1.2</span>, <span class="number">3.45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你也许也想控制字符串输出时的宽度，特别是要确保他们在类表格输出时的对齐。这是基本的右对齐宽度表示。</span></span><br><span class="line">fmt.Printf(<span class="string">"|%6s|%6s|\n"</span>, <span class="string">"foo"</span>, <span class="string">"b"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 要左对齐，和数字一样，使用 `-` 标志。</span></span><br><span class="line">fmt.Printf(<span class="string">"|%-6s|%-6s|\n"</span>, <span class="string">"foo"</span>, <span class="string">"b"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 到目前为止，我们已经看过 `Printf`了，它通过 `os.Stdout`输出格式化的字符串。`Sprintf` 则格式化并返回一个字符串而不带任何输出。</span></span><br><span class="line">s := fmt.Sprintf(<span class="string">"a %s"</span>, <span class="string">"string"</span>)</span><br><span class="line">fmt.Println(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以使用 `Fprintf` 来格式化并输出到 `io.Writers`而不是 `os.Stdout`。</span></span><br><span class="line">fmt.Fprintf(os.Stderr, <span class="string">"an %s\n"</span>, <span class="string">"error"</span>)</span><br></pre></td></tr></table></figure>

<p>还有对应的 strings、strconv 包。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">s := <span class="string">"This is an example of a string.中文"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 前后缀</span></span><br><span class="line"><span class="built_in">println</span>(strings.HasPrefix(s, <span class="string">"This"</span>))</span><br><span class="line"><span class="built_in">println</span>(strings.HasSuffix(s, <span class="string">"string"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 包含子串</span></span><br><span class="line"><span class="built_in">println</span>(strings.Contains(s, <span class="string">"a "</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子串在父串中的索引</span></span><br><span class="line"><span class="built_in">println</span>(strings.Index(s, <span class="string">"is"</span>))</span><br><span class="line"><span class="built_in">println</span>(strings.LastIndex(s, <span class="string">"i"</span>))</span><br><span class="line"><span class="comment">// println(strings.IndexRune(s, []rune("string"))) // 非 ASCII 用这个</span></span><br><span class="line"></span><br><span class="line">strings.Replace()</span><br><span class="line">strings.ToLower(s) <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数字转 string，不能 string()，这样等于 chr()</span></span><br><span class="line">strconv.Itoa(<span class="keyword">int</span>(item))  <span class="comment">// 正确操作</span></span><br></pre></td></tr></table></figure>

<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// os.Open</span></span><br><span class="line">f, err := os.Open(<span class="string">'/etc/passwd'</span>)</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line"></span><br><span class="line">buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">10</span>)</span><br><span class="line">f.Read(buf)</span><br><span class="line"></span><br><span class="line"><span class="comment">// os.OpenFile</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// bufio 缓冲</span></span><br><span class="line">r := bufio.NewReader(f)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    str, err := r.ReadString(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ioutil 一次读完</span></span><br><span class="line">content, err := ioutil.ReadFile(<span class="string">'/etc/passwd'</span>)  <span class="comment">// content 为 []byte</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 目录</span></span><br><span class="line">ioutil.ReadDir(<span class="string">"."</span>)</span><br></pre></td></tr></table></figure>

<h3 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">cmd := exec.Command(<span class="string">"id"</span>)</span><br><span class="line">stdoutStderr, err := cmd.CombinedOutput()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    log.Fatal(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"strings"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回目标字符串 `t` 出现的的第一个索引位置，或者在没有匹配值时返回 -1。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(vs []<span class="keyword">string</span>, t <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> vs &#123;</span><br><span class="line">        <span class="keyword">if</span> v == t &#123;</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果目标字符串 `t` 在这个切片中则返回 `true`。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Include</span><span class="params">(vs []<span class="keyword">string</span>, t <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Index(vs, t) &gt;= <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果这些切片中的字符串有一个满足条件 `f` 则返回 `true`。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Any</span><span class="params">(vs []<span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">string</span>)</span> <span class="title">bool</span>) <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> vs &#123;</span><br><span class="line">        <span class="keyword">if</span> f(v) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果切片中的所有字符串都满足条件 `f` 则返回 `true`。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">All</span><span class="params">(vs []<span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">string</span>)</span> <span class="title">bool</span>) <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> vs &#123;</span><br><span class="line">        <span class="keyword">if</span> !f(v) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个包含所有切片中满足条件 `f` 的字符串的新切片。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Filter</span><span class="params">(vs []<span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">string</span>)</span> <span class="title">bool</span>) []<span class="title">string</span></span> &#123;</span><br><span class="line">    vsf := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> vs &#123;</span><br><span class="line">        <span class="keyword">if</span> f(v) &#123;</span><br><span class="line">            vsf = <span class="built_in">append</span>(vsf, v)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> vsf</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个对原始切片中所有字符串执行函数 `f` 后的新切片。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Map</span><span class="params">(vs []<span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">string</span>)</span> <span class="title">string</span>) []<span class="title">string</span></span> &#123;</span><br><span class="line">    vsm := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="built_in">len</span>(vs))</span><br><span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> vs &#123;</span><br><span class="line">        vsm[i] = f(v)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> vsm</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里试试这些组合函数。</span></span><br><span class="line">    <span class="keyword">var</span> strs = []<span class="keyword">string</span>&#123;<span class="string">"peach"</span>, <span class="string">"apple"</span>, <span class="string">"pear"</span>, <span class="string">"plum"</span>&#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(Index(strs, <span class="string">"pear"</span>))</span><br><span class="line"></span><br><span class="line">    fmt.Println(Include(strs, <span class="string">"grape"</span>))</span><br><span class="line"></span><br><span class="line">    fmt.Println(Any(strs, <span class="function"><span class="keyword">func</span><span class="params">(v <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">        <span class="keyword">return</span> strings.HasPrefix(v, <span class="string">"p"</span>)</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">    fmt.Println(All(strs, <span class="function"><span class="keyword">func</span><span class="params">(v <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">        <span class="keyword">return</span> strings.HasPrefix(v, <span class="string">"p"</span>)</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">    fmt.Println(Filter(strs, <span class="function"><span class="keyword">func</span><span class="params">(v <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">        <span class="keyword">return</span> strings.Contains(v, <span class="string">"e"</span>)</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 上面的例子都是用的匿名函数，但是你也可以使用类型正确的命名函数</span></span><br><span class="line">    fmt.Println(Map(strs, strings.ToUpper))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="面向“对象”"><a href="#面向“对象”" class="headerlink" title="面向“对象”"></a>面向“对象”</h2><p>仅支持封装，不支持继承和多态</p>
<h3 id="结构体和方法"><a href="#结构体和方法" class="headerlink" title="结构体和方法"></a>结构体和方法</h3><p>用大小写来区分，大写开头 public、小写开头 private，private 只能在当前包内使用（使用工厂模式解决，即自行实现（大写开头）构造函数）</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Books <span class="keyword">struct</span> &#123;</span><br><span class="line">    title <span class="keyword">string</span></span><br><span class="line">    author <span class="keyword">string</span></span><br><span class="line">    book_id <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">books := Books&#123;</span><br><span class="line">    title:   <span class="string">"Go"</span>,</span><br><span class="line">    author:  <span class="string">"Tim"</span>,</span><br><span class="line">    book_id: <span class="string">"1"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tag</span></span><br><span class="line"><span class="keyword">type</span> Member <span class="keyword">struct</span> &#123;</span><br><span class="line">    Id     <span class="keyword">int</span>    <span class="string">`json:"id,-"`</span></span><br><span class="line">    Name   <span class="keyword">string</span> <span class="string">`json:"name"`</span></span><br><span class="line">    Email  <span class="keyword">string</span> <span class="string">`json:"email"`</span></span><br><span class="line">    Gender <span class="keyword">int</span>    <span class="string">`json:"gender,"`</span></span><br><span class="line">    Age    <span class="keyword">int</span>    <span class="string">`json:"age"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">books = Books&#123;<span class="string">"Go"</span>, <span class="string">"Tim"</span>, <span class="string">"2"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传值，注意一致性，如果有指针接收，最好全用指针接收</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(book Books)</span> <span class="title">print</span><span class="params">()</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传指针，nil 指针也可以调用方法，某些情景下需要加下判断</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(book *Books)</span> <span class="title">print</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> book == <span class="literal">nil</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承</span></span><br><span class="line"><span class="keyword">type</span> Edu <span class="keyword">struct</span> &#123;</span><br><span class="line">    Books  <span class="comment">// 写个匿名结构体就行</span></span><br><span class="line">    name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="包和封装"><a href="#包和封装" class="headerlink" title="包和封装"></a>包和封装</h3><p>同一个目录下只能有一个包，main 包下为主入口</p>
<p>为结构定义的方法必须放在同一个包内</p>
<p>可以是不同文件</p>
<p>import 中可以使用相对路径 <code>./</code>、<code>../</code> 引用包，如果没有用相对路径，go 会去 $GOPATH/src/ 目录找</p>
<h3 id="扩展已有类型"><a href="#扩展已有类型" class="headerlink" title="扩展已有类型"></a>扩展已有类型</h3><h4 id="定义别名"><a href="#定义别名" class="headerlink" title="定义别名"></a>定义别名</h4><h4 id="使用组合"><a href="#使用组合" class="headerlink" title="使用组合"></a>使用组合</h4><h3 id="使用内嵌来扩展已有类型"><a href="#使用内嵌来扩展已有类型" class="headerlink" title="使用内嵌来扩展已有类型"></a>使用内嵌来扩展已有类型</h3><h2 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h2><h3 id="依赖管理-1"><a href="#依赖管理-1" class="headerlink" title="依赖管理"></a>依赖管理</h3><h3 id="GOPATH-和-GOVENDOR"><a href="#GOPATH-和-GOVENDOR" class="headerlink" title="GOPATH 和 GOVENDOR"></a>GOPATH 和 GOVENDOR</h3><p>gopath 和 path 一样，可以接受多个路径，路径之间用冒号分隔</p>
<h3 id="go-mod"><a href="#go-mod" class="headerlink" title="go mod"></a>go mod</h3><p>go: cannot find main module; see ‘go help modules’</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line"></span><br><span class="line">go env -w GOPROXY=https://mirrors.aliyun.com/goproxy/,direct</span><br></pre></td></tr></table></figure>

<p>go mod 子命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go mod init module_name</span><br><span class="line"></span><br><span class="line">go list -m -u all  # 检查可以升级的包</span><br><span class="line">go get -u need-upgrade-package  # 升级</span><br><span class="line"></span><br><span class="line">download</span><br><span class="line">edit</span><br><span class="line">graph</span><br><span class="line">init</span><br><span class="line">tidy</span><br><span class="line">vendor</span><br><span class="line">verify</span><br><span class="line">why</span><br></pre></td></tr></table></figure>

<h2 id="面向接口"><a href="#面向接口" class="headerlink" title="面向接口"></a>面向接口</h2><h3 id="duck-typing"><a href="#duck-typing" class="headerlink" title="duck typing"></a>duck typing</h3><ul>
<li>“像鸭子走路，像鸭子叫，长的像鸭子，那么就是鸭子”</li>
<li>描述事物的外部行为而非内部结构</li>
<li>严格来说 go 属于结构化类型系统，类似 duck typing</li>
</ul>
<p>Python 中的鸭子</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">// 运行时才知道传入的 retriever 有没有 get 方法</span><br><span class="line">// 需要注释来说明接口</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(retriever)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> retriever.get(<span class="string">"http://qq.com"</span>)</span><br></pre></td></tr></table></figure>

<p>C++ 中的鸭子</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 同 Python</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">R</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">string</span> <span class="title">download</span>(<span class="title">const</span> <span class="title">R</span>&amp; <span class="title">retriver</span>) &#123;</span></span><br><span class="line">    <span class="keyword">return</span> retriver.get(<span class="string">"http://qq.com"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Java 中的类似代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 传入的参数必须实现 Retriever 接口</span></span><br><span class="line"><span class="comment">// 不是 duck typing</span></span><br><span class="line"><span class="comment">// 同时需要 Readable、Appendable 怎么办？（Apache polygene）</span></span><br><span class="line">&lt;R extends Retriver&gt;</span><br><span class="line"><span class="function">String <span class="title">download</span><span class="params">(R r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> r.get(<span class="string">"http://qq.com"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Retriver <span class="keyword">interface</span> &#123;</span><br><span class="line">    Get(source <span class="keyword">string</span>) <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">(retriver Retriver)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> retriver.Get(<span class="string">"http://qq.com"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口的概念"><a href="#接口的概念" class="headerlink" title="接口的概念"></a>接口的概念</h3><p>接口由使用者定义</p>
<p>接口的实现时隐式的，只要实现里面的方法（不太理解这句话</p>
<p>接口本身不能创建实例，但可以指向一个实现了该接口的（自定义）类型的变量。</p>
<p>一个自定义类型需要将某个接口的所有方法都实现，才说这个自定义类型实现了该接口，否则编译不通过。</p>
<p>一个自定义类型可以实现多个接口</p>
<p>一个接口可以继承多个接口</p>
<p>interface 类型默认是一个指针</p>
<p>空接口 <code>interface{}</code> 没有任何方法，所以所有类型都实现了空接口，即可以把任何一个变量赋值给空接口。</p>
<p><strong>类型断言</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> x <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> f <span class="keyword">float32</span> = <span class="number">1.1</span></span><br><span class="line">x = f</span><br><span class="line">y := x.(<span class="keyword">float32</span>)  <span class="comment">// 这里改成 float64 将 panic</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 加入检测</span></span><br><span class="line"><span class="keyword">if</span> y, ok := x.(<span class="keyword">float32</span>); ok &#123;</span><br><span class="line">    <span class="comment">// xx</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>继承与接口</strong></p>
<p>当 A 结构体继承了 B 结构体，那么 A 就有了 B 的所有字段和方法，并可以直接调用。</p>
<p>当 A 结构体需要扩展功能，同时不希望破坏继承关系，实现某个接口即可。</p>
<p>因此，实现接口可以看做是对继承机制的补充。</p>
<p>继承的价值：解决代码的复用性和可维护性。</p>
<p>接口的价值：设计，设计好各种规范（方法），让其它自定义类型去实现这种方法。</p>
<p>接口比继承更加灵活，继承是满足 is-a 的关系，而接口只需满足 like-a 的关系，在一定程度上实现了解耦。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1gbaenlc9mtj20gs05dtc1.jpg" alt="image.png"></p>
<h3 id="接口的定义和实现"><a href="#接口的定义和实现" class="headerlink" title="接口的定义和实现"></a>接口的定义和实现</h3><blockquote>
<p>实际上就是实现了多态，同样的方法在不同对象调用时表现不同的意义？</p>
<p>还有个典型的列子，即 <code>sort()</code>，需要实现三个方法就可以给自定义类型排序</p>
<ul>
<li>Len</li>
<li>Less</li>
<li>Swap</li>
</ul>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 几何学接口</span></span><br><span class="line"><span class="keyword">type</span> geometry <span class="keyword">interface</span> &#123;</span><br><span class="line">    area() <span class="keyword">float64</span></span><br><span class="line">    perim() <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> rect <span class="keyword">struct</span> &#123;</span><br><span class="line">    width, height <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> circle <span class="keyword">struct</span> &#123;</span><br><span class="line">    radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span> <span class="title">area</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span> <span class="title">perim</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (r.width + r.height) * <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> math.Pi * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span> <span class="title">perim</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * math.Pi * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 统一</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">measure</span><span class="params">(g geometry)</span></span> &#123;</span><br><span class="line">    fmt.Println(g)</span><br><span class="line">    fmt.Println(g.area())</span><br><span class="line">    fmt.Println(g.perim())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := rect&#123;width: <span class="number">3</span>, height: <span class="number">4</span>&#125;</span><br><span class="line">    c := circle&#123;radius: <span class="number">5</span>&#125;</span><br><span class="line">    </span><br><span class="line">    measure(r)</span><br><span class="line">    measure(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口的值类型"><a href="#接口的值类型" class="headerlink" title="接口的值类型"></a>接口的值类型</h3><h3 id="接口的组合"><a href="#接口的组合" class="headerlink" title="接口的组合"></a>接口的组合</h3><h3 id="常用系统接口"><a href="#常用系统接口" class="headerlink" title="常用系统接口"></a>常用系统接口</h3><h2 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h2><h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>函数内的局部变量 + 匿名函数构成闭包</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">()</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    sum := <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(value <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    	sum += value</span><br><span class="line">    	<span class="keyword">return</span> sum</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为函数实现接口</p>
<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>使用反射遍历结构体字段，调用结构体的方法，并获取结构体标签的值。</p>
<p>定义多个函数，再定义一个适配器函数用作统一处理接口。</p>
<p>使用反射创建并操作结构体。</p>
<h2 id="错误处理和资源管理"><a href="#错误处理和资源管理" class="headerlink" title="错误处理和资源管理"></a>错误处理和资源管理</h2><h3 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h3><p>延时机制，在 return 后再调用，先 defer 的后调用。</p>
<p>常常需要创建资源（数据库连接、文件句柄、锁），使用 defer 来关闭更省心。</p>
<h3 id="错误处理概念"><a href="#错误处理概念" class="headerlink" title="错误处理概念"></a>错误处理概念</h3><h3 id="服务器统一出错处理"><a href="#服务器统一出错处理" class="headerlink" title="服务器统一出错处理"></a>服务器统一出错处理</h3><h3 id="panic-和-recover"><a href="#panic-和-recover" class="headerlink" title="panic 和 recover"></a>panic 和 recover</h3><p>panic 一旦出错直接终止程序。</p>
<p>recover 可对接收到的错误自定义处理。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err &#123;</span><br><span class="line">        <span class="built_in">println</span>(err)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

<p>哪些不能 Recover：</p>
<ul>
<li>Thread Limit，超过了系统的线程限制，详细参考下面的说明；</li>
<li>Concurrent Map Writers，竞争条件，同时写 map，参考下面的例子。推荐使用标准库的 sync.Map 解决这个问题。</li>
</ul>
<h4 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h4><p>Go 的 err 过于简单，需要增加上下文信息。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Handler <span class="keyword">interface</span> &#123;</span><br><span class="line">    Filter(err error, r <span class="keyword">interface</span>&#123;&#125;) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Logger <span class="keyword">interface</span> &#123;</span><br><span class="line">    Ef(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Handle panic by hdr, which filter the error.</span></span><br><span class="line"><span class="comment">// Finally log err with logger.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HandlePanic</span><span class="params">(hdr Handler, logger Logger)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> handlePanic(<span class="built_in">recover</span>(), hdr, logger)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> hdrFunc <span class="function"><span class="keyword">func</span><span class="params">(err error, r <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="params">(v hdrFunc)</span> <span class="title">Filter</span><span class="params">(err error, r <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> v(err, r)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> loggerFunc <span class="function"><span class="keyword">func</span><span class="params">(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="params">(v loggerFunc)</span> <span class="title">Ef</span><span class="params">(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    v(format, a...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Handle panic by hdr, which filter the error.</span></span><br><span class="line"><span class="comment">// Finally log err with logger.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HandlePanicFunc</span><span class="params">(hdr <span class="keyword">func</span>(err error, r <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span>,</span></span><br><span class="line"><span class="function">    <span class="title">logger</span> <span class="title">func</span><span class="params">(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span>,</span></span><br><span class="line"><span class="function">) <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> f Handler</span><br><span class="line">    <span class="keyword">if</span> hdr != <span class="literal">nil</span> &#123;</span><br><span class="line">        f = hdrFunc(hdr)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> l Logger</span><br><span class="line">    <span class="keyword">if</span> logger != <span class="literal">nil</span> &#123;</span><br><span class="line">        l = loggerFunc(logger)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> handlePanic(<span class="built_in">recover</span>(), f, l)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handlePanic</span><span class="params">(r <span class="keyword">interface</span>&#123;&#125;, hdr Handler, logger Logger)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> r != <span class="literal">nil</span> &#123;</span><br><span class="line">        err, ok := r.(error)</span><br><span class="line">        <span class="keyword">if</span> !ok &#123;</span><br><span class="line">            err = fmt.Errorf(<span class="string">"r is %v"</span>, r)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> hdr != <span class="literal">nil</span> &#123;</span><br><span class="line">            err = hdr.Filter(err, r)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &amp;&amp; logger != <span class="literal">nil</span> &#123;</span><br><span class="line">            logger.Ef(<span class="string">"panic err %+v"</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> HandlePanicFunc(<span class="literal">nil</span>, <span class="function"><span class="keyword">func</span><span class="params">(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">            fmt.Println(fmt.Sprintf(format, a...))</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">panic</span>(<span class="string">"ok"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    logger := <span class="function"><span class="keyword">func</span><span class="params">(format <span class="keyword">string</span>, a ...<span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">        fmt.Println(fmt.Sprintf(format, a...))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> HandlePanicFunc(<span class="literal">nil</span>, logger)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">panic</span>(<span class="string">"ok"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="问题追踪和调试"><a href="#问题追踪和调试" class="headerlink" title="问题追踪和调试"></a>问题追踪和调试</h3><h4 id="打印日志"><a href="#打印日志" class="headerlink" title="打印日志"></a>打印日志</h4><h4 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h4><h2 id="测试与调优"><a href="#测试与调优" class="headerlink" title="测试与调优"></a>测试与调优</h2><h3 id="TDD"><a href="#TDD" class="headerlink" title="TDD"></a>TDD</h3><p><strong>先写测试</strong> =&gt; <strong>尝试运行测试</strong> =&gt; <strong>写少量代码跑起来</strong> =&gt; <strong>补充完整通过测试</strong> =&gt; <strong>重构</strong> =&gt; <strong>跳到第二步</strong></p>
<p>先写测试代码，编写足够的代码来使编译通过，<em>仅此而已</em> 。</p>
<p>请记住，我们要查看的是，测试是否因为合理的原因失败。</p>
<p>迭代！</p>
<p><strong>尽你所能拆分需求是一项很重要的技能，这样你就能拥有可以工作的软件</strong>。</p>
<p><strong>在测试的支持下，将功能切分成小的功能点，并使其首尾相连顺利的运行。</strong></p>
<p>敏捷开发：<a href="http://wiki.c2.com/?MakeItWorkMakeItRightMakeItFast" target="_blank" rel="noopener">让它运作，使它正确，使它快速</a></p>
<p><a href="http://wiki.c2.com/?PrematureOptimization" target="_blank" rel="noopener">过早的优化是万恶之源</a> —— Donald Knuth</p>
<h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>单元测试：保证项目工程质量的最有效办法。</p>
<ul>
<li>可测试：意味着面向接口编程以及减少单个函数中包含的逻辑，使用『小方法』；</li>
<li>组织方式：使用 Go 语言默认的 Test 框架、开源的 <code>suite</code> 或者 BDD 的风格对单元测试进行合理组织；</li>
<li>Mock 方法：四种不同的单元测试 Mock 方法；<ul>
<li><a href="https://github.com/golang/mock" target="_blank" rel="noopener">gomock</a>：最标准的也是最被鼓励的方式；</li>
<li><a href="https://github.com/DATA-DOG/go-sqlmock" target="_blank" rel="noopener">sqlmock</a>：处理依赖的数据库；</li>
<li><a href="https://github.com/jarcoal/httpmock" target="_blank" rel="noopener">httpmock</a>：处理依赖的 HTTP 请求；</li>
<li><a href="https://github.com/bouk/monkey" target="_blank" rel="noopener">monkey</a>：万能的方法，但是只在万不得已时使用，类似的代码写起来非常冗长而且不直观；</li>
</ul>
</li>
<li>断言：使用社区的 <a href="https://github.com/stretchr/testify" target="_blank" rel="noopener">testify</a> 快速验证方法的返回值；</li>
</ul>
<p><strong>命名约定</strong></p>
<ul>
<li><p>测试用例文件名必须以 <code>_test.go</code> 结尾。</p>
</li>
<li><p>测试函数必须以 <code>Test</code> 开头</p>
</li>
</ul>
<ul>
<li>测试函数只接受一个 <code>t *testing.T</code> 参数。</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// hello_test.go</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestHello</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    assertCorrectMessage := <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T, got <span class="keyword">string</span>, want <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    	t.Helper()  <span class="comment">// 声明是辅助函数</span></span><br><span class="line">    	<span class="keyword">if</span> got != want &#123;</span><br><span class="line">    		t.Errorf(<span class="string">"want %q got %q"</span>, want, got)</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t.Run(<span class="string">"saying hello to people"</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    	got := Hello(<span class="string">"wywwzj"</span>)</span><br><span class="line">    	want := <span class="string">"Hello, wywwzjj"</span></span><br><span class="line">    	assertCorrectMessage(t, got, want)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    t.Run(<span class="string">"empty string defaults to 'world'"</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    	want := <span class="string">"Hello, world"</span></span><br><span class="line">    	got := Hello(<span class="string">""</span>)</span><br><span class="line">    	assertCorrectMessage(t, got, want)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 表格式测试（Goland 可直接生成）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestFib</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> fibTests = []<span class="keyword">struct</span> &#123;</span><br><span class="line">        in       <span class="keyword">int</span> <span class="comment">// input</span></span><br><span class="line">        expected <span class="keyword">int</span> <span class="comment">// expected result</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>, <span class="number">1</span>&#125;,</span><br><span class="line">        &#123;<span class="number">3</span>, <span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="number">4</span>, <span class="number">3</span>&#125;,</span><br><span class="line">        &#123;<span class="number">5</span>, <span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">6</span>, <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="number">7</span>, <span class="number">13</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, tt := <span class="keyword">range</span> fibTests &#123;</span><br><span class="line">        actual := Fib(tt.in)</span><br><span class="line">        <span class="keyword">if</span> actual != tt.expected &#123;</span><br><span class="line">            t.Errorf(<span class="string">"Fib(%d) = %d; expected %d"</span>, tt.in, actual, tt.expected)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试并发中的条件竞争</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go test -race</span><br></pre></td></tr></table></figure>

<h4 id="example"><a href="#example" class="headerlink" title="example"></a>example</h4><p>既能生成文档，也是做了一次测试。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Example_GetScore</span><span class="params">()</span></span> &#123;</span><br><span class="line">    score := getScore(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">2.1</span>)</span><br><span class="line">    fmt.Println(score)</span><br><span class="line">    <span class="comment">// Output:</span></span><br><span class="line">    <span class="comment">// 31.1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="testing-的变量"><a href="#testing-的变量" class="headerlink" title="testing 的变量"></a>testing 的变量</h4><p>gotest 的变量有这些：</p>
<ul>
<li>test.short : 一个快速测试的标记，在测试用例中可以使用 testing.Short () 来绕开一些测试</li>
<li>test.outputdir : 输出目录</li>
<li>test.coverprofile : 测试覆盖率参数，指定输出文件</li>
<li>test.run : 指定正则来运行某个 / 某些测试用例</li>
<li>test.memprofile : 内存分析参数，指定输出文件</li>
<li>test.memprofilerate : 内存分析参数，内存分析的抽样率</li>
<li>test.cpuprofile : cpu 分析输出参数，为空则不做 cpu 分析</li>
<li>test.blockprofile : 阻塞事件的分析参数，指定输出文件</li>
<li>test.blockprofilerate : 阻塞事件的分析参数，指定抽样频率</li>
<li>test.timeout : 超时时间</li>
<li>test.cpu : 指定 cpu 数量</li>
<li>test.parallel : 指定运行测试用例的并行数</li>
</ul>
<h4 id="testing-包内的结构"><a href="#testing-包内的结构" class="headerlink" title="testing 包内的结构"></a>testing 包内的结构</h4><ul>
<li>B : 压力测试</li>
<li>BenchmarkResult : 压力测试结果</li>
<li>Cover : 代码覆盖率相关结构体</li>
<li>CoverBlock : 代码覆盖率相关结构体</li>
<li>InternalBenchmark : 内部使用的结构</li>
<li>InternalExample : 内部使用的结构</li>
<li>InternalTest : 内部使用的结构</li>
<li>M : main 测试使用的结构</li>
<li>PB : Parallel benchmarks 并行测试使用结果</li>
<li>T : 普通测试用例</li>
<li>TB : 测试用例的接口</li>
</ul>
<h4 id="testing-的通用方法"><a href="#testing-的通用方法" class="headerlink" title="testing 的通用方法"></a>testing 的通用方法</h4><p>T 结构内部是继承自 common 结构，common 结构提供集中方法，是我们经常会用到的：</p>
<p>当我们遇到一个断言错误的时候，我们就会判断这个测试用例失败，就会使用到：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Fail  : case 失败，测试用例继续</span><br><span class="line">FailedNow : case 失败，测试用例中断</span><br></pre></td></tr></table></figure>

<p>当我们遇到一个断言错误，只希望跳过这个错误，但是不希望标示测试用例失败，会使用到：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SkipNow : case 跳过，测试用例不继续</span><br></pre></td></tr></table></figure>

<p>当我们只希望在一个地方打印出信息，我们会用到 :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Log : 输出信息</span><br><span class="line">Logf : 输出有 format 的信息</span><br></pre></td></tr></table></figure>

<p>当我们希望跳过这个用例，并且打印出信息 :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Skip : Log + SkipNow</span><br><span class="line">Skipf : Logf + SkipNow</span><br></pre></td></tr></table></figure>

<p>当我们希望断言失败的时候，测试用例失败，打印出必要的信息，但是测试用例继续：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Error : Log + Fail</span><br><span class="line">Errorf : Logf + Fail</span><br></pre></td></tr></table></figure>

<p>当我们希望断言失败的时候，测试用例失败，打印出必要的信息，测试用例中断：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Fatal : Log + FailNow</span><br><span class="line">Fatalf : Logf + FailNow</span><br></pre></td></tr></table></figure>

<h3 id="基准测试"><a href="#基准测试" class="headerlink" title="基准测试"></a>基准测试</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 基准测试，go test -bench=.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkHello</span><span class="params">(t testing.B)</span></span> &#123;</span><br><span class="line">    b.ResetTimer()  <span class="comment">// 如果在运行前基准测试需要一些耗时的配置，则可以先重置定时器</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">        Hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// BenchmarkHello    10000000    282 ns/op</span></span><br><span class="line"><span class="comment">// 意思是执行 10000000 次，每次执行需要 282 纳秒。</span></span><br></pre></td></tr></table></figure>

<h3 id="测试-http-服务器"><a href="#测试-http-服务器" class="headerlink" title="测试 http 服务器"></a>测试 http 服务器</h3><h3 id="httptest"><a href="#httptest" class="headerlink" title="httptest"></a>httptest</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">server := httptest.NewServer(http.HandlerFunc(<span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">    	w.WriteHeader(http.StatusOK)</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">server.URL</span><br></pre></td></tr></table></figure>

<p>#### </p>
<h3 id="代码覆盖率和性能测试"><a href="#代码覆盖率和性能测试" class="headerlink" title="代码覆盖率和性能测试"></a>代码覆盖率和性能测试</h3><h3 id="pprof"><a href="#pprof" class="headerlink" title="pprof"></a>pprof</h3><p>runtime/pprof</p>
<p>net/http/pprof</p>
<p><strong>runtime/trace</strong></p>
<p>只需在程序执行前加上环境变量 GODEBUG=gctrace=1</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">GODEBUG=gctrace=1 go test -bench=.</span><br><span class="line">GODEBUG=gctrace=1 go run main.go</span><br></pre></td></tr></table></figure>

<h3 id="生成文档和示例代码"><a href="#生成文档和示例代码" class="headerlink" title="生成文档和示例代码"></a>生成文档和示例代码</h3><h3 id="性能调优分析指标"><a href="#性能调优分析指标" class="headerlink" title="性能调优分析指标"></a>性能调优分析指标</h3><ul>
<li>Wall Time</li>
<li>CPU Time</li>
<li>Block Time</li>
<li>Memory allocation</li>
<li>GC times / time spent</li>
</ul>
<h3 id="别让性能被锁住"><a href="#别让性能被锁住" class="headerlink" title="别让性能被锁住"></a>别让性能被锁住</h3><h3 id="高效字符串连接"><a href="#高效字符串连接" class="headerlink" title="高效字符串连接"></a>高效字符串连接</h3><p>字符串是不可变对象，已经生成不能改变，每次改变都是产生了一个新的字符串。</p>
<ul>
<li><p>string.Builder 性能最好</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> builder strings.Builder</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">    builder.WriteString(strconv.Itoa(i))</span><br><span class="line">&#125;</span><br><span class="line">str := builder.String()</span><br></pre></td></tr></table></figure>
</li>
<li><p>bytes.Buffer 次之</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> buf bytes.Buffer</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">    buf.WriteString(strconv.Itoa(i))</span><br><span class="line">&#125;</span><br><span class="line">str := buf.String()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>+</code></p>
</li>
<li><p>sprintf 最慢</p>
  <figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> s <span class="keyword">string</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">    s = fmt.Sprintf(<span class="string">"%v%v"</span>, s, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="GC-友好"><a href="#GC-友好" class="headerlink" title="GC 友好"></a>GC 友好</h3><h4 id="避免内存分配和复制"><a href="#避免内存分配和复制" class="headerlink" title="避免内存分配和复制"></a>避免内存分配和复制</h4><ul>
<li><p>复杂对象尽量传引用</p>
<ul>
<li>数组的传递</li>
<li>结构体传递</li>
</ul>
</li>
<li><p>复用内存</p>
<p>  slice 初始化合适的大小。</p>
</li>
</ul>
<h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><blockquote>
<p><a href="https://github.com/golang/go/wiki/LearnConcurrency" target="_blank" rel="noopener">https://github.com/golang/go/wiki/LearnConcurrency</a></p>
</blockquote>
<p>Go 实现了 CSP（通信顺序进程，Communicaing Sequential Process）模型来作为 goroutine 间的推荐通信方式</p>
<h3 id="Goroutine"><a href="#Goroutine" class="headerlink" title="Goroutine"></a>Goroutine</h3><p><strong>MPG模式</strong></p>
<p>M：操作系统的主线程（物理线程）</p>
<p>P：协程执行需要的上下文</p>
<p>G：协程</p>
<p>如果协程中出现了 panic，则整个程序都会崩溃。</p>
<p>设置运行 CPU 数量</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">num := runtime.NumCPU()  <span class="comment">// 获取系统的逻辑CPU个数</span></span><br><span class="line">runtime.GOMAXPROCS(<span class="number">233</span>)  <span class="comment">// 指定数量，go 1.8 后默认运行在多核上</span></span><br></pre></td></tr></table></figure>

<h3 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h3><blockquote>
<p>不要通过共享内存来通信，而应通过通信来共享内存。</p>
</blockquote>
<p>类似 Unix 下的双向管道，可指定单向，用于goroutine 之间通信，可传送任意数据类型。符号为 <code>&lt;- chan &lt;-</code>。</p>
<p>线程安全，多 goroutine 访问时，不需要加锁，即本身就是线程安全的。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// goroutine 与 main 通信</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    channel := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        channel &lt;- <span class="string">"Hello"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main 函数所处的是一个主 goroutine，由 runtime.main 启动。</p>
<p>main 函数一旦运行结束退出，其他的 goroutine 会被杀掉。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">channel := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)  <span class="comment">// 3 buffer</span></span><br></pre></td></tr></table></figure>

<p>channel 默认是阻塞的，满了阻塞写，空了阻塞读。</p>
<p>获取 channel 内容可使用 range 遍历，但发送方 channel 要手动 close 一下。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 我们将遍历在 `queue` 通道中的两个值。</span></span><br><span class="line">queue := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">2</span>)</span><br><span class="line">queue &lt;- <span class="string">"one"</span></span><br><span class="line">queue &lt;- <span class="string">"two"</span></span><br><span class="line"><span class="built_in">close</span>(queue)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个 `range` 迭代从 `queue` 中得到的每个值。因为我们在前面 `close` 了这个通道，这个迭代会在接收完 2 个值之后结束。</span></span><br><span class="line"><span class="comment">// 如果我们没有 `close` 它，我们将在这个循环中继续阻塞执行，等待接收第三个值</span></span><br><span class="line"><span class="keyword">for</span> elem := <span class="keyword">range</span> queue &#123;</span><br><span class="line">    fmt.Println(elem)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Go 中的 select</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// for 指定次数</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> msg1 := &lt;- c1:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">    	<span class="keyword">case</span> msg2 := &lt;- c2:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设定 timeout</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    timeout_cnt := <span class="number">0</span></span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> msg1 := &lt;- c1:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">        <span class="keyword">case</span> msg2 := &lt;- c2:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">        <span class="keyword">case</span> &lt;- time.After(time.Second * <span class="number">30</span>):</span><br><span class="line">        	timeout_cnt++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> time_cnt &gt; <span class="number">3</span> &#123;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 无阻塞 channel</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> msg1 := &lt;- c1:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">        <span class="keyword">case</span> msg2 := &lt;- c2:</span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">        <span class="keyword">default</span>: <span class="comment">// 加入 default 后无阻塞</span></span><br><span class="line">        	<span class="comment">// xx</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭 channel，channel 会返回两个值，一个是内容，一个是还有没有内容</span></span><br><span class="line"><span class="built_in">close</span>(channel)</span><br><span class="line"></span><br><span class="line">more := <span class="literal">true</span></span><br><span class="line"><span class="keyword">for</span> more &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> msg, more = &lt;- channel:</span><br><span class="line">            <span class="keyword">if</span> more &#123;</span><br><span class="line">    			<span class="comment">// xx</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// xx</span></span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sem = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, MaxOutstanding)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(r *Request)</span></span> &#123;</span><br><span class="line">    sem &lt;- <span class="number">1</span>    <span class="comment">// 等待活动队列清空。</span></span><br><span class="line">    process(r)  <span class="comment">// 可能需要很长时间。</span></span><br><span class="line">    &lt;-sem       <span class="comment">// 完成；使下一个请求可以运行。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Serve</span><span class="params">(queue <span class="keyword">chan</span> *Request)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        req := &lt;-queue</span><br><span class="line">        <span class="keyword">go</span> handle(req)  <span class="comment">// 无需等待 handle 结束。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 队列满了，依然开了 goroutine，改进</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Serve</span><span class="params">(queue <span class="keyword">chan</span> *Request)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        req := &lt;-queue</span><br><span class="line">        sem &lt;- <span class="number">1</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            process(req)</span><br><span class="line">            &lt;- sem</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// req 在所有 goroutine 中共享，一旦改变就容易出错</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Serve</span><span class="params">(queue <span class="keyword">chan</span> *Request)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        req := &lt;-queue</span><br><span class="line">        sem &lt;- <span class="number">1</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(req *Request)</span></span> &#123;</span><br><span class="line">            process(req)</span><br><span class="line">            &lt;- sem</span><br><span class="line">        &#125;(req)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用闭包</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Serve</span><span class="params">(queue <span class="keyword">chan</span> *Request)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> req := <span class="keyword">range</span> queue &#123;</span><br><span class="line">        req := req  <span class="comment">// 用相同的名字获得了该变量的一个新的版本， 以此来局部地刻意屏蔽循环变量，使它对每个 Go 协程保持唯一</span></span><br><span class="line">        sem &lt;- <span class="number">1</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            process(req)</span><br><span class="line">            &lt;- sem</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="理解调度器"><a href="#理解调度器" class="headerlink" title="理解调度器"></a>理解调度器</h3><h3 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是我们将要在多个并发实例中支持的任务了。</span></span><br><span class="line"><span class="comment">// 这些执行者将从 `jobs` 通道接收任务，并且通过 `results` 发送对应的结果。</span></span><br><span class="line"><span class="comment">// 我们将让每个任务间隔 1s 来模仿一个耗时的任务。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(id <span class="keyword">int</span>, jobs &lt;-<span class="keyword">chan</span> <span class="keyword">int</span>, results <span class="keyword">chan</span>&lt;- <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> j := <span class="keyword">range</span> jobs &#123;</span><br><span class="line">        fmt.Println(<span class="string">"worker"</span>, id, <span class="string">"processing job"</span>, j)</span><br><span class="line">        time.Sleep(time.Second)</span><br><span class="line">        results &lt;- j * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 为了使用 worker 线程池并且收集他们的结果，我们需要 2 个通道。</span></span><br><span class="line">    jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">100</span>)</span><br><span class="line">    results := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里启动了 3 个 worker，初始是阻塞的，因为还没有传递任务。</span></span><br><span class="line">    <span class="keyword">for</span> w := <span class="number">1</span>; w &lt;= <span class="number">3</span>; w++ &#123;</span><br><span class="line">        <span class="keyword">go</span> worker(w, jobs, results)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里我们发送 9 个 `jobs`，然后 `close` 这些通道来表示这些就是所有的任务了。</span></span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">9</span>; j++ &#123;</span><br><span class="line">        jobs &lt;- j</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">close</span>(jobs)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最后，我们收集所有这些任务的返回值。</span></span><br><span class="line">    <span class="keyword">for</span> a := <span class="number">1</span>; a &lt;= <span class="number">9</span>; a++ &#123;</span><br><span class="line">        &lt;-results</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">runtime.Gosched()  <span class="comment">// 运行其他协程执行</span></span><br></pre></td></tr></table></figure>

<h3 id="context"><a href="#context" class="headerlink" title="context"></a>context</h3><h3 id="原子操作"><a href="#原子操作" class="headerlink" title="原子操作"></a>原子操作</h3><p>这样的函数还有很多，参看 <a href="http://golang.org/pkg/sync/atomic/" target="_blank" rel="noopener">go 的 atomic 包文档</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">imort &quot;sync/atomic&quot;</span><br><span class="line"></span><br><span class="line">var cnt uint32 = 0</span><br><span class="line">atomic.AddUint32(&amp;cnt, 1)</span><br><span class="line"></span><br><span class="line">cntFinal := atomic.LoadUint32(&amp;cnt)  // 取数据</span><br></pre></td></tr></table></figure>

<h3 id="互斥锁-Mutex"><a href="#互斥锁-Mutex" class="headerlink" title="互斥锁 Mutex"></a>互斥锁 Mutex</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> memoryAccess sync.Mutex</span><br><span class="line"><span class="keyword">var</span> value <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    memoryAccess.Lock()</span><br><span class="line">    value++</span><br><span class="line">    memoryAccess.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">memoryAccess.Lock()</span><br><span class="line"><span class="keyword">if</span> value == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="built_in">println</span>(value)</span><br><span class="line">&#125;</span><br><span class="line">memoryAccess.Unlock()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在我们的例子中，`state` 是一个 map。</span></span><br><span class="line">    <span class="keyword">var</span> state = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里的 `mutex` 将同步对 `state` 的访问。</span></span><br><span class="line">    <span class="keyword">var</span> mutex = &amp;sync.Mutex&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// we'll see later, `ops` will count how many</span></span><br><span class="line">    <span class="comment">// operations we perform against the state.</span></span><br><span class="line">    <span class="comment">// 为了比较基于互斥锁的处理方式和我们后面将要看到的其他</span></span><br><span class="line">    <span class="comment">// 方式，`ops` 将记录我们对 state 的操作次数。</span></span><br><span class="line">    <span class="keyword">var</span> ops <span class="keyword">int64</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里我们运行 100 个 Go 协程来重复读取 state。</span></span><br><span class="line">    <span class="keyword">for</span> r := <span class="number">0</span>; r &lt; <span class="number">100</span>; r++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            total := <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 每次循环读取，我们使用一个键来进行访问，</span></span><br><span class="line">                <span class="comment">// `Lock()` 这个 `mutex` 来确保对 `state` 的</span></span><br><span class="line">                <span class="comment">// 独占访问，读取选定的键的值，`Unlock()` 这个</span></span><br><span class="line">                <span class="comment">// mutex，并且 `ops` 值加 1。</span></span><br><span class="line">                key := rand.Intn(<span class="number">5</span>)</span><br><span class="line">                mutex.Lock()</span><br><span class="line">                total += state[key]</span><br><span class="line">                mutex.Unlock()</span><br><span class="line">                atomic.AddInt64(&amp;ops, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 为了确保这个 Go 协程不会在调度中饿死，我们</span></span><br><span class="line">                <span class="comment">// 在每次操作后明确的使用 `runtime.Gosched()`</span></span><br><span class="line">                <span class="comment">// 进行释放。这个释放一般是自动处理的，像例如</span></span><br><span class="line">                <span class="comment">// 每个通道操作后或者 `time.Sleep` 的阻塞调用后</span></span><br><span class="line">                <span class="comment">// 相似，但是在这个例子中我们需要手动的处理。</span></span><br><span class="line">                runtime.Gosched()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 同样的，我们运行 10 个 Go 协程来模拟写入操作，使用</span></span><br><span class="line">    <span class="comment">// 和读取相同的模式。</span></span><br><span class="line">    <span class="keyword">for</span> w := <span class="number">0</span>; w &lt; <span class="number">10</span>; w++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line">                key := rand.Intn(<span class="number">5</span>)</span><br><span class="line">                val := rand.Intn(<span class="number">100</span>)</span><br><span class="line">                mutex.Lock()</span><br><span class="line">                state[key] = val</span><br><span class="line">                mutex.Unlock()</span><br><span class="line">                atomic.AddInt64(&amp;ops, <span class="number">1</span>)</span><br><span class="line">                runtime.Gosched()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 让这 10 个 Go 协程对 `state` 和 `mutex` 的操作</span></span><br><span class="line">    <span class="comment">// 运行 1 s。</span></span><br><span class="line">    time.Sleep(time.Second)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取并输出最终的操作计数。</span></span><br><span class="line">    opsFinal := atomic.LoadInt64(&amp;ops)</span><br><span class="line">    fmt.Println(<span class="string">"ops:"</span>, opsFinal)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对 `state` 使用一个最终的锁，显示它是如何结束的。</span></span><br><span class="line">    mutex.Lock()</span><br><span class="line">    fmt.Println(<span class="string">"state:"</span>, state)</span><br><span class="line">    mutex.Unlock()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="读写锁-RWMutex"><a href="#读写锁-RWMutex" class="headerlink" title="读写锁 RWMutex"></a>读写锁 RWMutex</h3><h3 id="Once"><a href="#Once" class="headerlink" title="Once"></a>Once</h3><p>调用无数次也只执行一次。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> once sync.Once</span><br><span class="line">onceBody := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(time.Now())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        once.Do(onceBody)</span><br><span class="line">        done &lt;- <span class="literal">true</span></span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">    fmt.Println(&lt;- done)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WaitGroup"><a href="#WaitGroup" class="headerlink" title="WaitGroup"></a>WaitGroup</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// A WaitGroup must not be copied after first use.</span></span><br><span class="line"><span class="comment">// 传给 goroutine 时需要传指针</span></span><br><span class="line">wg := sync.WaitGroup&#123;&#125;</span><br><span class="line"></span><br><span class="line">wg.Add(<span class="number">10</span>)  <span class="comment">// 创建 goroutine 时添加</span></span><br><span class="line">wg.Done()  <span class="comment">// goroutine 对应的函数运行结束后调用 Done</span></span><br><span class="line"></span><br><span class="line">wg.Wait()</span><br></pre></td></tr></table></figure>

<h3 id="竞争条件检测"><a href="#竞争条件检测" class="headerlink" title="竞争条件检测"></a>竞争条件检测</h3><p>go build，go run 或者 go test 命令后面加上 -race</p>
<h2 id="常用库"><a href="#常用库" class="headerlink" title="常用库"></a>常用库</h2><h3 id="os"><a href="#os" class="headerlink" title="os"></a>os</h3><p>尽量多用 os 提供的方法，这里的方法都是跨平台的，少用 syscall。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="time"><a href="#time" class="headerlink" title="time"></a>time</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">daysBetweenDates</span><span class="params">(date1 <span class="keyword">string</span>, date2 <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    d1, _ := time.Parse(<span class="string">"2006-01-02"</span>, date1)</span><br><span class="line">    d2, _ := time.Parse(<span class="string">"2006-01-02"</span>, date2)</span><br><span class="line">    delta := d1.Sub(d2)</span><br><span class="line">    <span class="keyword">return</span> abs(<span class="keyword">int</span>(delta.Hours()) / <span class="number">24</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    timeString := time.Now().Format(<span class="string">"2006-01-02 15:04:05"</span>)  <span class="comment">// 这是一个神奇的时间，改了就错</span></span><br><span class="line">    fmt.Println(timeString)</span><br><span class="line">    fmt.Println(time.Now().Format(<span class="string">"2017-09-07 18:05:32"</span>))</span><br><span class="line">    </span><br><span class="line">    p := fmt.Println</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 得到当前时间。</span></span><br><span class="line">    now := time.Now()</span><br><span class="line">    p(now)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过提供年月日等信息，你可以构建一个 `time`。时间总是关联着位置信息，例如时区。</span></span><br><span class="line">    then := time.Date(<span class="number">2009</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">34</span>, <span class="number">58</span>, <span class="number">651387237</span>, time.UTC)</span><br><span class="line">    p(then)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 你可以提取出时间的各个组成部分。</span></span><br><span class="line">    p(then.Year())</span><br><span class="line">    p(then.Month())</span><br><span class="line">    p(then.Day())</span><br><span class="line">    p(then.Hour())</span><br><span class="line">    p(then.Minute())</span><br><span class="line">    p(then.Second())</span><br><span class="line">    p(then.Nanosecond())</span><br><span class="line">    p(then.Location())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出是星期一到日的 `Weekday` 也是支持的。</span></span><br><span class="line">    p(then.Weekday())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这些方法来比较两个时间，分别测试一下是否是之前，之后或者是同一时刻，精确到秒。</span></span><br><span class="line">    p(then.Before(now))</span><br><span class="line">    p(then.After(now))</span><br><span class="line">    p(then.Equal(now))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方法 `Sub` 返回一个 `Duration` 来表示两个时间点的间隔时间。</span></span><br><span class="line">    diff := now.Sub(then)</span><br><span class="line">    p(diff)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 我们计算出不同单位下的时间长度值。</span></span><br><span class="line">    p(diff.Hours())</span><br><span class="line">    p(diff.Minutes())</span><br><span class="line">    p(diff.Seconds())</span><br><span class="line">    p(diff.Nanoseconds())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 你可以使用 `Add` 将时间后移一个时间间隔，或者使用一个 `-` 来将时间前移一个时间间隔。</span></span><br><span class="line">    p(then.Add(diff))</span><br><span class="line">    p(then.Add(-diff))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="定时器-Timers"><a href="#定时器-Timers" class="headerlink" title="定时器 Timers"></a>定时器 Timers</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">timer = time.NewTimer(time.Second * <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    &lt;-timer.C  <span class="comment">// 等待信号</span></span><br><span class="line">    <span class="comment">// xxx</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">timer.Stop()  <span class="comment">// 关掉定时器</span></span><br></pre></td></tr></table></figure>

<h4 id="打点器-Tickers"><a href="#打点器-Tickers" class="headerlink" title="打点器 Tickers"></a>打点器 Tickers</h4><p>间隔一段时间发一个信号。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ticker := time.NewTicker(time.Millisecond * <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> t := <span class="keyword">range</span>.ticker.C &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Tick at "</span>, t)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">ticker.Stop()</span><br></pre></td></tr></table></figure>

<h4 id="速率限制-Rate-Limiting"><a href="#速率限制-Rate-Limiting" class="headerlink" title="速率限制 Rate Limiting"></a>速率限制 Rate Limiting</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 首先我们将看一下基本的速率限制。假设我们想限制我们</span></span><br><span class="line">    <span class="comment">// 接收请求的处理，我们将这些请求发送给一个相同的通道。</span></span><br><span class="line">    requests := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line">        requests &lt;- i</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">close</span>(requests)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个 `limiter` 通道将每 200ms 接收一个值。这个是</span></span><br><span class="line">    <span class="comment">// 速率限制任务中的管理器。</span></span><br><span class="line">    limiter := time.Tick(time.Millisecond * <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过在每次请求前阻塞 `limiter` 通道的一个接收，我们限制</span></span><br><span class="line">    <span class="comment">// 自己每 200ms 执行一次请求。</span></span><br><span class="line">    <span class="keyword">for</span> req := <span class="keyword">range</span> requests &#123;</span><br><span class="line">        &lt;-limiter</span><br><span class="line">        fmt.Println(<span class="string">"request"</span>, req, time.Now())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有时候我们想临时进行速率限制，并且不影响整体的速率控制，</span></span><br><span class="line">    <span class="comment">// 我们可以通过[通道缓冲](channel-buffering.html)来实现。</span></span><br><span class="line">    <span class="comment">// 这个 `burstyLimiter` 通道用来进行 3 次临时的脉冲型速率限制。</span></span><br><span class="line">    burstyLimiter := <span class="built_in">make</span>(<span class="keyword">chan</span> time.Time, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 想将通道填充需要临时改变3次的值，做好准备。</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;</span><br><span class="line">        burstyLimiter &lt;- time.Now()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每 200 ms 我们将添加一个新的值到 `burstyLimiter`中，</span></span><br><span class="line">    <span class="comment">// 直到达到 3 个的限制。</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> t := <span class="keyword">range</span> time.Tick(time.Millisecond * <span class="number">200</span>) &#123;</span><br><span class="line">            burstyLimiter &lt;- t</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 现在模拟超过 5 个的接入请求。它们中刚开始的 3 个将</span></span><br><span class="line">    <span class="comment">// 由于受 `burstyLimiter` 的“脉冲”影响。</span></span><br><span class="line">    burstyRequests := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line">        burstyRequests &lt;- i</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">close</span>(burstyRequests)</span><br><span class="line">    <span class="keyword">for</span> req := <span class="keyword">range</span> burstyRequests &#123;</span><br><span class="line">        &lt;-burstyLimiter</span><br><span class="line">        fmt.Println(<span class="string">"request"</span>, req, time.Now())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="encoding"><a href="#encoding" class="headerlink" title="encoding"></a>encoding</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> b64 <span class="string">"encoding/base64"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这是将要编解码的字符串。</span></span><br><span class="line">    data := <span class="string">"abc123!?$*&amp;()'-=@~"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Go 同时支持标准的和 URL 兼容的 base64 格式。编码需要</span></span><br><span class="line">    <span class="comment">// 使用 `[]byte` 类型的参数，所以要将字符串转成此类型。</span></span><br><span class="line">    sEnc := b64.StdEncoding.EncodeToString([]<span class="keyword">byte</span>(data))</span><br><span class="line">    fmt.Println(sEnc)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解码可能会返回错误，如果不确定输入信息格式是否正确，</span></span><br><span class="line">    <span class="comment">// 那么，你就需要进行错误检查了。</span></span><br><span class="line">    sDec, _ := b64.StdEncoding.DecodeString(sEnc)</span><br><span class="line">    fmt.Println(<span class="keyword">string</span>(sDec))</span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 URL 兼容的 base64 格式进行编解码。</span></span><br><span class="line">    uEnc := b64.URLEncoding.EncodeToString([]<span class="keyword">byte</span>(data))</span><br><span class="line">    fmt.Println(uEnc)</span><br><span class="line">    uDec, _ := b64.URLEncoding.DecodeString(uEnc)</span><br><span class="line">    fmt.Println(<span class="keyword">string</span>(uDec))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="container"><a href="#container" class="headerlink" title="container"></a>container</h3><h4 id="heap-1"><a href="#heap-1" class="headerlink" title="heap"></a>heap</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> IntHeap []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h IntHeap)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span>           &#123; <span class="keyword">return</span> <span class="built_in">len</span>(h) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h IntHeap)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123; <span class="keyword">return</span> h[i] &lt; h[j] &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h IntHeap)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span>      &#123; h[i], h[j] = h[j], h[i] &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *IntHeap)</span> <span class="title">Push</span><span class="params">(x <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    *h = <span class="built_in">append</span>(*h, x.(<span class="keyword">int</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *IntHeap)</span> <span class="title">Pop</span><span class="params">()</span> <span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">    old := *h</span><br><span class="line">    n := <span class="built_in">len</span>(old)</span><br><span class="line">    x := old[n<span class="number">-1</span>]</span><br><span class="line">    *h = old[<span class="number">0</span> : n<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h := &amp;IntHeap&#123;<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>&#125;</span><br><span class="line">heap.Init(h)</span><br><span class="line">heap.Push(h, <span class="number">3</span>)</span><br><span class="line">heap.Pop(h)</span><br></pre></td></tr></table></figure>

<h4 id="list"><a href="#list" class="headerlink" title="list"></a>list</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Element <span class="keyword">struct</span> &#123;</span><br><span class="line">    next, prev *Element  <span class="comment">// 上一个元素和下一个元素</span></span><br><span class="line">    list *List  <span class="comment">// 元素所在链表</span></span><br><span class="line">    Value <span class="keyword">interface</span>&#123;&#125;  <span class="comment">// 元素</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> List <span class="keyword">struct</span> &#123;</span><br><span class="line">    root Element  <span class="comment">// 链表的根元素</span></span><br><span class="line">    <span class="built_in">len</span>  <span class="keyword">int</span>      <span class="comment">// 链表的长度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"container/list"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    list := list.New()</span><br><span class="line">    list.PushBack(<span class="number">1</span>)</span><br><span class="line">    list.PushBack(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    fmt.Printf(<span class="string">"len: %v\n"</span>, list.Len())</span><br><span class="line">    fmt.Printf(<span class="string">"first: %#v\n"</span>, list.Front())</span><br><span class="line">    fmt.Printf(<span class="string">"second: %#v\n"</span>, list.Front().Next())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Element</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="params">(e *Element)</span> <span class="title">Next</span><span class="params">()</span> *<span class="title">Element</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(e *Element)</span> <span class="title">Prev</span><span class="params">()</span> *<span class="title">Element</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">List</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">New</span><span class="params">()</span> *<span class="title">List</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">Back</span><span class="params">()</span> *<span class="title">Element</span>   // 最后一个元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">Front</span><span class="params">()</span> *<span class="title">Element</span>  // 第一个元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">Init</span><span class="params">()</span> *<span class="title">List</span>  // 链表初始化</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">InsertAfter</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;, mark *Element)</span> *<span class="title">Element</span> // 在某个元素后插入</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">InsertBefore</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;, mark *Element)</span> *<span class="title">Element</span>  // 在某个元素前插入</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span> // 在链表长度</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">MoveAfter</span><span class="params">(e, mark *Element)</span>  // 把 <span class="title">e</span> 元素移动到 <span class="title">mark</span> 之后</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">MoveBefore</span><span class="params">(e, mark *Element)</span>  // 把 <span class="title">e</span> 元素移动到 <span class="title">mark</span> 之前</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">MoveToBack</span><span class="params">(e *Element)</span> // 把 <span class="title">e</span> 元素移动到队列最后</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">MoveToFront</span><span class="params">(e *Element)</span> // 把 <span class="title">e</span> 元素移动到队列最头部</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">PushBack</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;)</span> *<span class="title">Element</span>  // 在队列最后插入元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">PushBackList</span><span class="params">(other *List)</span>  // 在队列最后插入接上新队列</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">PushFront</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;)</span> *<span class="title">Element</span>  // 在队列头部插入元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">PushFrontList</span><span class="params">(other *List)</span> // 在队列头部插入接上新队列</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(l *List)</span> <span class="title">Remove</span><span class="params">(e *Element)</span> <span class="title">interface</span></span>&#123;&#125; <span class="comment">// 删除某个元素</span></span><br></pre></td></tr></table></figure>

<h4 id="ring"><a href="#ring" class="headerlink" title="ring"></a>ring</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">type Ring struct &#123;</span><br><span class="line">    next, prev *Ring</span><br><span class="line">    Value      interface&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"container/ring"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ring := ring.New(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++ &#123;</span><br><span class="line">        ring.Value = i</span><br><span class="line">        ring = ring.Next()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算 1+2+3</span></span><br><span class="line">    s := <span class="number">0</span></span><br><span class="line">    ring.Do(<span class="function"><span class="keyword">func</span><span class="params">(p <span class="keyword">interface</span>&#123;&#125;)</span></span>&#123;</span><br><span class="line">        s += p.(<span class="keyword">int</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    fmt.Println(<span class="string">"sum is"</span>, s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Ring</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(n <span class="keyword">int</span>)</span> *<span class="title">Ring</span>  // 初始化环</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Do</span><span class="params">(f <span class="keyword">func</span>(<span class="keyword">interface</span>&#123;&#125;)</span>)  // 循环环进行操作</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span> // 环长度</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Link</span><span class="params">(s *Ring)</span> *<span class="title">Ring</span> // 连接两个环</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Move</span><span class="params">(n <span class="keyword">int</span>)</span> *<span class="title">Ring</span> // 指针从当前元素开始向后移动或者向前（<span class="title">n</span> 可以为负数）</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Next</span><span class="params">()</span> *<span class="title">Ring</span> // 当前元素的下个元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Prev</span><span class="params">()</span> *<span class="title">Ring</span> // 当前元素的上个元素</span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Ring)</span> <span class="title">Unlink</span><span class="params">(n <span class="keyword">int</span>)</span> *<span class="title">Ring</span> // 从当前元素开始，删除 <span class="title">n</span> 个元素</span></span><br></pre></td></tr></table></figure>

<h3 id="regexp"><a href="#regexp" class="headerlink" title="regexp"></a>regexp</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"bytes"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"regexp"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个测试一个字符串是否符合一个表达式。</span></span><br><span class="line">    match, _ := regexp.MatchString(<span class="string">"p([a-z]+)ch"</span>, <span class="string">"peach"</span>)</span><br><span class="line">    fmt.Println(match)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 上面我们是直接使用字符串，但是对于一些其他的正则任</span></span><br><span class="line">    <span class="comment">// 务，你需要 `Compile` 一个优化的 `Regexp` 结构体。</span></span><br><span class="line">    r, _ := regexp.Compile(<span class="string">"p([a-z]+)ch"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个结构体有很多方法。这里是类似我们前面看到的一个</span></span><br><span class="line">    <span class="comment">// 匹配测试。</span></span><br><span class="line">    fmt.Println(r.MatchString(<span class="string">"peach"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这是查找匹配字符串的。</span></span><br><span class="line">    fmt.Println(r.FindString(<span class="string">"peach punch"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个也是查找第一次匹配的字符串的，但是返回的匹配开</span></span><br><span class="line">    <span class="comment">// 始和结束位置索引，而不是匹配的内容。</span></span><br><span class="line">    fmt.Println(r.FindStringIndex(<span class="string">"peach punch"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// `Submatch` 返回完全匹配和局部匹配的字符串。例如，</span></span><br><span class="line">    <span class="comment">// 这里会返回 `p([a-z]+)ch` 和 `([a-z]+) 的信息。</span></span><br><span class="line">    fmt.Println(r.FindStringSubmatch(<span class="string">"peach punch"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 类似的，这个会返回完全匹配和局部匹配的索引位置。</span></span><br><span class="line">    fmt.Println(r.FindStringSubmatchIndex(<span class="string">"peach punch"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 带 `All` 的这个函数返回所有的匹配项，而不仅仅是首</span></span><br><span class="line">    <span class="comment">// 次匹配项。例如查找匹配表达式的所有项。</span></span><br><span class="line">    fmt.Println(r.FindAllString(<span class="string">"peach punch pinch"</span>, <span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// `All` 同样可以对应到上面的所有函数。</span></span><br><span class="line">    fmt.Println(r.FindAllStringSubmatchIndex(</span><br><span class="line">        <span class="string">"peach punch pinch"</span>, <span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个函数提供一个正整数来限制匹配次数。</span></span><br><span class="line">    fmt.Println(r.FindAllString(<span class="string">"peach punch pinch"</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 上面的例子中，我们使用了字符串作为参数，并使用了</span></span><br><span class="line">    <span class="comment">// 如 `MatchString` 这样的方法。我们也可以提供 `[]byte`</span></span><br><span class="line">    <span class="comment">// 参数并将 `String` 从函数命中去掉。</span></span><br><span class="line">    fmt.Println(r.Match([]<span class="keyword">byte</span>(<span class="string">"peach"</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建正则表达式常量时，可以使用 `Compile` 的变体</span></span><br><span class="line">    <span class="comment">// `MustCompile` 。因为 `Compile` 返回两个值，不能用于常量。</span></span><br><span class="line">    r = regexp.MustCompile(<span class="string">"p([a-z]+)ch"</span>)</span><br><span class="line">    fmt.Println(r)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// `regexp` 包也可以用来替换部分字符串为其他值。</span></span><br><span class="line">    fmt.Println(r.ReplaceAllString(<span class="string">"a peach"</span>, <span class="string">"&lt;fruit&gt;"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// `Func` 变量允许传递匹配内容到一个给定的函数中，</span></span><br><span class="line">    in := []<span class="keyword">byte</span>(<span class="string">"a peach"</span>)</span><br><span class="line">    out := r.ReplaceAllFunc(in, bytes.ToUpper)</span><br><span class="line">    fmt.Println(<span class="keyword">string</span>(out))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Compare</span><span class="params">(a, b <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Contains</span><span class="params">(s, substr <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ContainsAny</span><span class="params">(s, chars <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ContainsRune</span><span class="params">(s <span class="keyword">string</span>, r <span class="keyword">rune</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Count</span><span class="params">(s, substr <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">EqualFold</span><span class="params">(s, t <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Fields</span><span class="params">(s <span class="keyword">string</span>)</span> []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FieldsFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">HasPrefix</span><span class="params">(s, prefix <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">HasSuffix</span><span class="params">(s, suffix <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Index</span><span class="params">(s, substr <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexAny</span><span class="params">(s, chars <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexByte</span><span class="params">(s <span class="keyword">string</span>, c <span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexRune</span><span class="params">(s <span class="keyword">string</span>, r <span class="keyword">rune</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Join</span><span class="params">(a []<span class="keyword">string</span>, sep <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndex</span><span class="params">(s, substr <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexAny</span><span class="params">(s, chars <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexByte</span><span class="params">(s <span class="keyword">string</span>, c <span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Map</span><span class="params">(mapping <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">rune</span>, <span class="title">s</span> <span class="title">string</span>) <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Repeat</span><span class="params">(s <span class="keyword">string</span>, count <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Replace</span><span class="params">(s, old, <span class="built_in">new</span> <span class="keyword">string</span>, n <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ReplaceAll</span><span class="params">(s, old, <span class="built_in">new</span> <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Split</span><span class="params">(s, sep <span class="keyword">string</span>)</span> []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitAfter</span><span class="params">(s, sep <span class="keyword">string</span>)</span> []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitAfterN</span><span class="params">(s, sep <span class="keyword">string</span>, n <span class="keyword">int</span>)</span> []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitN</span><span class="params">(s, sep <span class="keyword">string</span>, n <span class="keyword">int</span>)</span> []<span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Title</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToLower</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToLowerSpecial</span><span class="params">(c unicode.SpecialCase, s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToTitle</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToTitleSpecial</span><span class="params">(c unicode.SpecialCase, s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToUpper</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToUpperSpecial</span><span class="params">(c unicode.SpecialCase, s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToValidUTF8</span><span class="params">(s, replacement <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Trim</span><span class="params">(s <span class="keyword">string</span>, cutset <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimLeft</span><span class="params">(s <span class="keyword">string</span>, cutset <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimLeftFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimPrefix</span><span class="params">(s, prefix <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimRight</span><span class="params">(s <span class="keyword">string</span>, cutset <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimRightFunc</span><span class="params">(s <span class="keyword">string</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimSpace</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimSuffix</span><span class="params">(s, suffix <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">Cap</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">Grow</span><span class="params">(n <span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">Reset</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">Write</span><span class="params">(p []<span class="keyword">byte</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">WriteByte</span><span class="params">(c <span class="keyword">byte</span>)</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">WriteRune</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Builder)</span> <span class="title">WriteString</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">Reader</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">NewReader</span><span class="params">(s <span class="keyword">string</span>)</span> *<span class="title">Reader</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Read</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadAt</span><span class="params">(b []<span class="keyword">byte</span>, off <span class="keyword">int64</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadByte</span><span class="params">()</span> <span class="params">(<span class="keyword">byte</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadRune</span><span class="params">()</span> <span class="params">(ch <span class="keyword">rune</span>, size <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Reset</span><span class="params">(s <span class="keyword">string</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Seek</span><span class="params">(offset <span class="keyword">int64</span>, whence <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int64</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Size</span><span class="params">()</span> <span class="title">int64</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">UnreadByte</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">UnreadRune</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">WriteTo</span><span class="params">(w io.Writer)</span> <span class="params">(n <span class="keyword">int64</span>, err error)</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">Replacer</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">NewReplacer</span><span class="params">(oldnew ...<span class="keyword">string</span>)</span> *<span class="title">Replacer</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Replacer)</span> <span class="title">Replace</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Replacer)</span> <span class="title">WriteString</span><span class="params">(w io.Writer, s <span class="keyword">string</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="bytes"><a href="#bytes" class="headerlink" title="bytes"></a>bytes</h3><p>操作 byte slice</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Compare</span><span class="params">(a, b []<span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Contains</span><span class="params">(b, subslice []<span class="keyword">byte</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ContainsAny</span><span class="params">(b []<span class="keyword">byte</span>, chars <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ContainsRune</span><span class="params">(b []<span class="keyword">byte</span>, r <span class="keyword">rune</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Count</span><span class="params">(s, sep []<span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Equal</span><span class="params">(a, b []<span class="keyword">byte</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">EqualFold</span><span class="params">(s, t []<span class="keyword">byte</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Fields</span><span class="params">(s []<span class="keyword">byte</span>)</span> [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FieldsFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(<span class="keyword">rune</span>)</span> <span class="title">bool</span>) [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">HasPrefix</span><span class="params">(s, prefix []<span class="keyword">byte</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">HasSuffix</span><span class="params">(s, suffix []<span class="keyword">byte</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Index</span><span class="params">(s, sep []<span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexAny</span><span class="params">(s []<span class="keyword">byte</span>, chars <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexByte</span><span class="params">(b []<span class="keyword">byte</span>, c <span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IndexRune</span><span class="params">(s []<span class="keyword">byte</span>, r <span class="keyword">rune</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Join</span><span class="params">(s [][]<span class="keyword">byte</span>, sep []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndex</span><span class="params">(s, sep []<span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexAny</span><span class="params">(s []<span class="keyword">byte</span>, chars <span class="keyword">string</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexByte</span><span class="params">(s []<span class="keyword">byte</span>, c <span class="keyword">byte</span>)</span> <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">LastIndexFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">bool</span>) <span class="title">int</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Map</span><span class="params">(mapping <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">rune</span>, <span class="title">s</span> []<span class="title">byte</span>) []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Repeat</span><span class="params">(b []<span class="keyword">byte</span>, count <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Replace</span><span class="params">(s, old, <span class="built_in">new</span> []<span class="keyword">byte</span>, n <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ReplaceAll</span><span class="params">(s, old, <span class="built_in">new</span> []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Runes</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">rune</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Split</span><span class="params">(s, sep []<span class="keyword">byte</span>)</span> [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitAfter</span><span class="params">(s, sep []<span class="keyword">byte</span>)</span> [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitAfterN</span><span class="params">(s, sep []<span class="keyword">byte</span>, n <span class="keyword">int</span>)</span> [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">SplitN</span><span class="params">(s, sep []<span class="keyword">byte</span>, n <span class="keyword">int</span>)</span> [][]<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Title</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToLower</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToLowerSpecial</span><span class="params">(c unicode.SpecialCase, s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToTitle</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToTitleSpecial</span><span class="params">(c unicode.SpecialCase, s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToUpper</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToUpperSpecial</span><span class="params">(c unicode.SpecialCase, s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ToValidUTF8</span><span class="params">(s, replacement []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Trim</span><span class="params">(s []<span class="keyword">byte</span>, cutset <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">bool</span>) []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimLeft</span><span class="params">(s []<span class="keyword">byte</span>, cutset <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimLeftFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">bool</span>) []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimPrefix</span><span class="params">(s, prefix []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimRight</span><span class="params">(s []<span class="keyword">byte</span>, cutset <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimRightFunc</span><span class="params">(s []<span class="keyword">byte</span>, f <span class="keyword">func</span>(r <span class="keyword">rune</span>)</span> <span class="title">bool</span>) []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimSpace</span><span class="params">(s []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">TrimSuffix</span><span class="params">(s, suffix []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">Buffer</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">NewBuffer</span><span class="params">(buf []<span class="keyword">byte</span>)</span> *<span class="title">Buffer</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">NewBufferString</span><span class="params">(s <span class="keyword">string</span>)</span> *<span class="title">Buffer</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Bytes</span><span class="params">()</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Cap</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Grow</span><span class="params">(n <span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Next</span><span class="params">(n <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Read</span><span class="params">(p []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">ReadByte</span><span class="params">()</span> <span class="params">(<span class="keyword">byte</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">ReadBytes</span><span class="params">(delim <span class="keyword">byte</span>)</span> <span class="params">(line []<span class="keyword">byte</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">ReadFrom</span><span class="params">(r io.Reader)</span> <span class="params">(n <span class="keyword">int64</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">ReadRune</span><span class="params">()</span> <span class="params">(r <span class="keyword">rune</span>, size <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">ReadString</span><span class="params">(delim <span class="keyword">byte</span>)</span> <span class="params">(line <span class="keyword">string</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Reset</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Truncate</span><span class="params">(n <span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">UnreadByte</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">UnreadRune</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">Write</span><span class="params">(p []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">WriteByte</span><span class="params">(c <span class="keyword">byte</span>)</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">WriteRune</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">WriteString</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(b *Buffer)</span> <span class="title">WriteTo</span><span class="params">(w io.Writer)</span> <span class="params">(n <span class="keyword">int64</span>, err error)</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">Reader</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="title">NewReader</span><span class="params">(b []<span class="keyword">byte</span>)</span> *<span class="title">Reader</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Read</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadAt</span><span class="params">(b []<span class="keyword">byte</span>, off <span class="keyword">int64</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadByte</span><span class="params">()</span> <span class="params">(<span class="keyword">byte</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">ReadRune</span><span class="params">()</span> <span class="params">(ch <span class="keyword">rune</span>, size <span class="keyword">int</span>, err error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Reset</span><span class="params">(b []<span class="keyword">byte</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Seek</span><span class="params">(offset <span class="keyword">int64</span>, whence <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int64</span>, error)</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">Size</span><span class="params">()</span> <span class="title">int64</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">UnreadByte</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">UnreadRune</span><span class="params">()</span> <span class="title">error</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(r *Reader)</span> <span class="title">WriteTo</span><span class="params">(w io.Writer)</span> <span class="params">(n <span class="keyword">int64</span>, err error)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="strconv"><a href="#strconv" class="headerlink" title="strconv"></a>strconv</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AppendBool</span><span class="params">(dst []<span class="keyword">byte</span>, b <span class="keyword">bool</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendFloat</span><span class="params">(dst []<span class="keyword">byte</span>, f <span class="keyword">float64</span>, fmt <span class="keyword">byte</span>, prec, bitSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendInt</span><span class="params">(dst []<span class="keyword">byte</span>, i <span class="keyword">int64</span>, base <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuote</span><span class="params">(dst []<span class="keyword">byte</span>, s <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuoteRune</span><span class="params">(dst []<span class="keyword">byte</span>, r <span class="keyword">rune</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuoteRuneToASCII</span><span class="params">(dst []<span class="keyword">byte</span>, r <span class="keyword">rune</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuoteRuneToGraphic</span><span class="params">(dst []<span class="keyword">byte</span>, r <span class="keyword">rune</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuoteToASCII</span><span class="params">(dst []<span class="keyword">byte</span>, s <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendQuoteToGraphic</span><span class="params">(dst []<span class="keyword">byte</span>, s <span class="keyword">string</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">AppendUint</span><span class="params">(dst []<span class="keyword">byte</span>, i <span class="keyword">uint64</span>, base <span class="keyword">int</span>)</span> []<span class="title">byte</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Atoi</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">CanBackquote</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FormatBool</span><span class="params">(b <span class="keyword">bool</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FormatFloat</span><span class="params">(f <span class="keyword">float64</span>, fmt <span class="keyword">byte</span>, prec, bitSize <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FormatInt</span><span class="params">(i <span class="keyword">int64</span>, base <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">FormatUint</span><span class="params">(i <span class="keyword">uint64</span>, base <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IsGraphic</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">IsPrint</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Itoa</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ParseBool</span><span class="params">(str <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">bool</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ParseFloat</span><span class="params">(s <span class="keyword">string</span>, bitSize <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">float64</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ParseInt</span><span class="params">(s <span class="keyword">string</span>, base <span class="keyword">int</span>, bitSize <span class="keyword">int</span>)</span> <span class="params">(i <span class="keyword">int64</span>, err error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ParseUint</span><span class="params">(s <span class="keyword">string</span>, base <span class="keyword">int</span>, bitSize <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">uint64</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Quote</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">QuoteRune</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">QuoteRuneToASCII</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">QuoteRuneToGraphic</span><span class="params">(r <span class="keyword">rune</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">QuoteToASCII</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">QuoteToGraphic</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Unquote</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">UnquoteChar</span><span class="params">(s <span class="keyword">string</span>, quote <span class="keyword">byte</span>)</span> <span class="params">(value <span class="keyword">rune</span>, multibyte <span class="keyword">bool</span>, tail <span class="keyword">string</span>, err error)</span></span></span><br><span class="line"><span class="function"><span class="title">type</span> <span class="title">NumError</span></span></span><br><span class="line"><span class="function">    <span class="title">func</span> <span class="params">(e *NumError)</span> <span class="title">Error</span><span class="params">()</span> <span class="title">string</span></span></span><br></pre></td></tr></table></figure>

<h3 id="casbin"><a href="#casbin" class="headerlink" title="casbin"></a>casbin</h3><h3 id="jwt-go"><a href="#jwt-go" class="headerlink" title="jwt-go"></a>jwt-go</h3><h3 id="cobra"><a href="#cobra" class="headerlink" title="cobra"></a>cobra</h3><h3 id="urfave-cli"><a href="#urfave-cli" class="headerlink" title="urfave/cli"></a>urfave/cli</h3><h3 id="termui"><a href="#termui" class="headerlink" title="termui"></a>termui</h3><h3 id="viper"><a href="#viper" class="headerlink" title="viper"></a>viper</h3><h3 id="redigo"><a href="#redigo" class="headerlink" title="redigo"></a>redigo</h3><h3 id="grpc-go"><a href="#grpc-go" class="headerlink" title="grpc-go"></a>grpc-go</h3><h3 id="pkg-errors"><a href="#pkg-errors" class="headerlink" title="pkg/errors"></a>pkg/errors</h3><h3 id="notify"><a href="#notify" class="headerlink" title="notify"></a>notify</h3><h3 id="gopherjs"><a href="#gopherjs" class="headerlink" title="gopherjs"></a>gopherjs</h3><h3 id="logrus"><a href="#logrus" class="headerlink" title="logrus"></a>logrus</h3><h3 id="zap"><a href="#zap" class="headerlink" title="zap"></a>zap</h3><h3 id="excelize"><a href="#excelize" class="headerlink" title="excelize"></a>excelize</h3><h3 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h3><h3 id="fasthttp"><a href="#fasthttp" class="headerlink" title="fasthttp"></a>fasthttp</h3><h3 id="gopsutil"><a href="#gopsutil" class="headerlink" title="gopsutil"></a>gopsutil</h3><h3 id="resty"><a href="#resty" class="headerlink" title="resty"></a>resty</h3><h3 id="GORM"><a href="#GORM" class="headerlink" title="GORM"></a>GORM</h3><h3 id="gonum"><a href="#gonum" class="headerlink" title="gonum"></a>gonum</h3><h3 id="jsoniter"><a href="#jsoniter" class="headerlink" title="jsoniter"></a>jsoniter</h3><h3 id="gofpdf"><a href="#gofpdf" class="headerlink" title="gofpdf"></a>gofpdf</h3><h3 id="Testify"><a href="#Testify" class="headerlink" title="Testify"></a>Testify</h3><h2 id="写个爬虫"><a href="#写个爬虫" class="headerlink" title="写个爬虫"></a>写个爬虫</h2><blockquote>
<p>简单分布式爬虫，爬取相亲网站资料</p>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1gb7jrimvxij20tw09v3zs.jpg" alt="image.png"></p>
<h2 id="工具集"><a href="#工具集" class="headerlink" title="工具集"></a>工具集</h2><h3 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h3><p><strong>1)sql2go</strong><br>用于将 sql 语句转换为 golang 的 struct. 使用 ddl 语句即可。<br>例如对于创建表的语句: show create table xxx. 将输出的语句，直接粘贴进去就行。<br><a href="http://stming.cn/tool/sql2go.html" target="_blank" rel="noopener">http://stming.cn/tool/sql2go.html</a></p>
<p><strong>2)toml2go</strong><br>用于将编码后的 toml 文本转换问 golang 的 struct.<br><a href="https://xuri.me/toml-to-go/" target="_blank" rel="noopener">https://xuri.me/toml-to-go/</a></p>
<p><strong>3)curl2go</strong><br>用来将 curl 命令转化为具体的 golang 代码.<br><a href="https://mholt.github.io/curl-to-go/" target="_blank" rel="noopener">https://mholt.github.io/curl-to-go/</a></p>
<p><strong>4)json2go</strong><br>用于将 json 文本转换为 struct.<br><a href="https://mholt.github.io/json-to-go/" target="_blank" rel="noopener">https://mholt.github.io/json-to-go/</a></p>
<p><strong>5) mysql 转 ES 工具</strong><br><a href="http://www.ischoolbar.com/EsParser/" target="_blank" rel="noopener">http://www.ischoolbar.com/EsParser/</a></p>
<p><strong>6)golang</strong><br>模拟模板的工具，在支持泛型之前，可以考虑使用。<br><a href="https://github.com/cheekybits/genny" target="_blank" rel="noopener">https://github.com/cheekybits/genny</a></p>
<p><strong>7) 查看某一个库的依赖情况，类似于 go list 功能</strong><br><a href="https://github.com/KyleBanks/depth" target="_blank" rel="noopener">https://github.com/KyleBanks/depth</a></p>
<p>8) 一个好用的文件压缩和解压工具，集成了 zip，tar 等多种功能，主要还有跨平台。<br><a href="https://github.com/mholt/archiver" target="_blank" rel="noopener">https://github.com/mholt/archiver</a></p>
<p><strong>9) go 内置命令</strong><br>go list 可以查看某一个包的依赖关系.<br>go vet 可以检查代码不符合 golang 规范的地方。</p>
<p><strong>10) 热编译工具</strong><br><a href="https://github.com/silenceper/gowatch" target="_blank" rel="noopener">https://github.com/silenceper/gowatch</a></p>
<p><strong>11)revive</strong><br>golang 代码质量检测工具<br><a href="https://github.com/mgechev/revive" target="_blank" rel="noopener">https://github.com/mgechev/revive</a></p>
<p><strong>12)Go Callvis</strong><br>golang 的代码调用链图工具<br><a href="https://github.com/TrueFurby/go-callvis" target="_blank" rel="noopener">https://github.com/TrueFurby/go-callvis</a></p>
<p><strong>13)Realize</strong><br>开发流程改进工具<br><a href="https://github.com/oxequa/realize" target="_blank" rel="noopener">https://github.com/oxequa/realize</a></p>
<p><strong>14)Gotests</strong><br>自动生成测试用例工具<br><a href="https://github.com/cweill/gotests" target="_blank" rel="noopener">https://github.com/cweill/gotests</a></p>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p><strong>1)perf</strong><br>代理工具，支持内存，cpu，堆栈查看，并支持火焰图.<br>perf 工具和 go-torch 工具，快捷定位程序问题.<br><a href="https://github.com/uber-archive/go-torch" target="_blank" rel="noopener">https://github.com/uber-archive/go-torch</a><br><a href="https://github.com/google/gops" target="_blank" rel="noopener">https://github.com/google/gops</a></p>
<p><strong>2) dlv 远程调试</strong><br>基于 goland+dlv 可以实现远程调式的能力.<br><a href="https://github.com/go-delve/delve" target="_blank" rel="noopener">https://github.com/go-delve/delve</a><br>提供了对 golang 原生的支持，相比 gdb 调试，简单太多。</p>
<p><strong>3) 网络代理工具</strong><br>goproxy 代理，支持多种协议，支持 ssh 穿透和 kcp 协议.<br><a href="https://github.com/snail007/goproxy" target="_blank" rel="noopener">https://github.com/snail007/goproxy</a></p>
<p><strong>4) 抓包工具</strong><br>go-sniffer 工具，可扩展的抓包工具，可以开发自定义协议的工具包。现在只支持了 http，mysql，redis，mongodb.<br>基于这个工具，我们开发了 qapp 协议的抓包。<br><a href="https://github.com/40t/go-sniffer" target="_blank" rel="noopener">https://github.com/40t/go-sniffer</a></p>
<p><strong>5) 反向代理工具，快捷开放内网端口供外部使用。</strong><br>ngrok 可以让内网服务外部调用<br><a href="https://ngrok.com/" target="_blank" rel="noopener">https://ngrok.com/</a><br><a href="https://github.com/inconshreveable/ngrok" target="_blank" rel="noopener">https://github.com/inconshreveable/ngrok</a></p>
<p><strong>6) 配置化生成证书</strong><br>从根证书，到业务侧证书一键生成.<br><a href="https://github.com/cloudflare/cfssl" target="_blank" rel="noopener">https://github.com/cloudflare/cfssl</a></p>
<p><strong>7) 免费的证书获取工具</strong><br>基于 acme 协议，从 letsencrypt 生成免费的证书，有效期 1 年，可自动续期。<br><a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">https://github.com/Neilpang/acme.sh</a></p>
<p>8) 开发环境管理工具，单机搭建可移植工具的利器。支持多种虚拟机后端。<br><strong>vagrant</strong> 常被拿来同 docker 相比，值得拥有。<br><a href="https://github.com/hashicorp/vagrant" target="_blank" rel="noopener">https://github.com/hashicorp/vagrant</a></p>
<p><strong>9) 轻量级容器调度工具</strong><br>nomad 可以非常方便的管理容器和传统应用，相比 k8s 来说，简单不要太多.<br><a href="https://github.com/hashicorp/nomad" target="_blank" rel="noopener">https://github.com/hashicorp/nomad</a></p>
<p><strong>10) 敏感信息和密钥管理工具</strong><br><a href="https://github.com/hashicorp/vault" target="_blank" rel="noopener">https://github.com/hashicorp/vault</a></p>
<p><strong>11) 高度可配置化的 http 转发工具，基于 etcd 配置。</strong><br><a href="https://github.com/gojek/weaver" target="_blank" rel="noopener">https://github.com/gojek/weaver</a></p>
<p><strong>12) 进程监控工具 supervisor</strong><br><a href="https://www.jianshu.com/p/39b476e808d8" target="_blank" rel="noopener">https://www.jianshu.com/p/39b476e808d8</a></p>
<p>13) 基于 <strong>procFile</strong> 进程管理工具。相比 supervisor 更加简单。<br><a href="https://github.com/ddollar/foreman" target="_blank" rel="noopener">https://github.com/ddollar/foreman</a></p>
<p>14) 基于 http，https，websocket 的<strong>调试代理工具</strong>，配置功能丰富。在线教育的 nohost web 调试工具，基于此开发.<br><a href="https://github.com/avwo/whistle" target="_blank" rel="noopener">https://github.com/avwo/whistle</a></p>
<p><strong>15) 分布式调度工具</strong><br><a href="https://github.com/shunfei/cronsun/blob/master/README_ZH.md" target="_blank" rel="noopener">https://github.com/shunfei/cronsun/blob/master/README_ZH.md</a><br><a href="https://github.com/ouqiang/gocron" target="_blank" rel="noopener">https://github.com/ouqiang/gocron</a></p>
<p><strong>16) 自动化运维平台 Gaia</strong><br><a href="https://github.com/gaia-pipeline/gaia" target="_blank" rel="noopener">https://github.com/gaia-pipeline/gaia</a></p>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/j3gficicyOvatzJibnFP6EXDYRTOzL8ZgT4oXh17qR8vTl5uHKrXtFcp45GS6VyRXMJw4vnSQ3mDibKxL7ficGrPshw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="img"></p>
<h3 id="常用网站"><a href="#常用网站" class="headerlink" title="常用网站"></a>常用网站</h3><p>go 百科全书: <a href="https://awesome-go.com/" target="_blank" rel="noopener">https://awesome-go.com/</a></p>
<p>json 解析: <a href="https://www.json.cn/" target="_blank" rel="noopener">https://www.json.cn/</a></p>
<p>出口 IP: <a href="https://ipinfo.io/" target="_blank" rel="noopener">https://ipinfo.io/</a></p>
<p>redis 命令: <a href="http://doc.redisfans.com/" target="_blank" rel="noopener">http://doc.redisfans.com/</a></p>
<p>ES 命令首页: <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html" target="_blank" rel="noopener">https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html</a></p>
<p>UrlEncode: <a href="http://tool.chinaz.com/Tools/urlencode.aspx" target="_blank" rel="noopener">http://tool.chinaz.com/Tools/urlencode.aspx</a></p>
<p>Base64: <a href="https://tool.oschina.net/encrypt?type=3" target="_blank" rel="noopener">https://tool.oschina.net/encrypt?type=3</a></p>
<p>Guid: <a href="https://www.guidgen.com/" target="_blank" rel="noopener">https://www.guidgen.com/</a></p>
<p>常用工具: <a href="http://www.ofmonkey.com/" target="_blank" rel="noopener">http://www.ofmonkey.com/</a></p>
<h3 id="常用库-1"><a href="#常用库-1" class="headerlink" title="常用库"></a>常用库</h3><p><strong>日志</strong><br><a href="https://github.com/Sirupsen/logrus" target="_blank" rel="noopener">https://github.com/Sirupsen/logrus</a><br><a href="https://github.com/uber-go/zap" target="_blank" rel="noopener">https://github.com/uber-go/zap</a></p>
<p><strong>配置</strong><br>兼容 json，toml，yaml，hcl 等格式的日志库.<br><a href="https://github.com/spf13/viper" target="_blank" rel="noopener">https://github.com/spf13/viper</a></p>
<p><strong>存储</strong><br>mysql: <a href="https://github.com/go-xorm/xorm" target="_blank" rel="noopener">https://github.com/go-xorm/xorm</a><br>es: <a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener">https://github.com/elastic/elasticsearch</a><br>redis: <a href="https://github.com/gomodule/redigo" target="_blank" rel="noopener">https://github.com/gomodule/redigo</a><br>mongo: <a href="https://github.com/mongodb/mongo-go-driver" target="_blank" rel="noopener">https://github.com/mongodb/mongo-go-driver</a><br>kafka: <a href="https://github.com/Shopify/sarama" target="_blank" rel="noopener">https://github.com/Shopify/sarama</a></p>
<p><strong>数据结构</strong><br><a href="https://github.com/emirpasic/gods" target="_blank" rel="noopener">https://github.com/emirpasic/gods</a></p>
<p><strong>命令行</strong><br><a href="https://github.com/spf13/cobra" target="_blank" rel="noopener">https://github.com/spf13/cobra</a></p>
<p><strong>框架</strong><br><a href="https://github.com/grpc/grpc-go" target="_blank" rel="noopener">https://github.com/grpc/grpc-go</a><br><a href="https://github.com/gin-gonic/gin" target="_blank" rel="noopener">https://github.com/gin-gonic/gin</a></p>
<p><strong>并发</strong><br><a href="https://github.com/Jeffail/tunny" target="_blank" rel="noopener">https://github.com/Jeffail/tunny</a><br><a href="https://github.com/benmanns/goworker" target="_blank" rel="noopener">https://github.com/benmanns/goworker</a><br>现在我们框架在用的，虽然 star 不多，但是确实好用，当然还可以更好用.<br><a href="https://github.com/rafaeldias/async" target="_blank" rel="noopener">https://github.com/rafaeldias/async</a></p>
<p><strong>工具</strong><br>定义了实用的判定类，以及针对结构体的校验逻辑，避免业务侧写复杂的代码.<br><a href="https://github.com/asaskevich/govalidator" target="_blank" rel="noopener">https://github.com/asaskevich/govalidator</a><br><a href="https://github.com/bytedance/go-tagexpr" target="_blank" rel="noopener">https://github.com/bytedance/go-tagexpr</a></p>
<p>protobuf 文件动态解析的接口，可以实现反射相关的能力。<br><a href="https://github.com/jhump/protoreflect" target="_blank" rel="noopener">https://github.com/jhump/protoreflect</a></p>
<p><strong>表达式引擎工具</strong><br><a href="https://github.com/Knetic/govaluate" target="_blank" rel="noopener">https://github.com/Knetic/govaluate</a><br><a href="https://github.com/google/cel-go" target="_blank" rel="noopener">https://github.com/google/cel-go</a></p>
<p><strong>字符串处理</strong><br><a href="https://github.com/huandu/xstrings" target="_blank" rel="noopener">https://github.com/huandu/xstrings</a></p>
<p><strong>ratelimit 工具</strong><br><a href="https://github.com/uber-go/ratelimit" target="_blank" rel="noopener">https://github.com/uber-go/ratelimit</a><br><a href="https://blog.csdn.net/chenchongg/article/details/85342086" target="_blank" rel="noopener">https://blog.csdn.net/chenchongg/article/details/85342086</a><br><a href="https://github.com/juju/ratelimit" target="_blank" rel="noopener">https://github.com/juju/ratelimit</a></p>
<p><strong>golang 熔断的库</strong><br>熔断除了考虑频率限制，还要考虑 qps，出错率等其他东西.<br><a href="https://github.com/afex/hystrix-go" target="_blank" rel="noopener">https://github.com/afex/hystrix-go</a><br><a href="https://github.com/sony/gobreaker" target="_blank" rel="noopener">https://github.com/sony/gobreaker</a></p>
<p><strong>表格</strong><br><a href="https://github.com/chenjiandongx/go-echarts" target="_blank" rel="noopener">https://github.com/chenjiandongx/go-echarts</a></p>
<p><strong>tail 工具库</strong><br><a href="https://github.com/hpcloud/taglshi" target="_blank" rel="noopener">https://github.com/hpcloud/taglshi</a></p>
<h2 id="最佳实践-1"><a href="#最佳实践-1" class="headerlink" title="最佳实践"></a>最佳实践</h2><p><a href="https://golang.org/doc/effective_go.html" target="_blank" rel="noopener">Effective Go</a> ，Go 的语法不复杂，所以，Go 语言的最佳实践只需要看这篇官方文档就够了。</p>
<h3 id="以下是在实际开发过程中遇到的一些问题，仅供参考："><a href="#以下是在实际开发过程中遇到的一些问题，仅供参考：" class="headerlink" title="以下是在实际开发过程中遇到的一些问题，仅供参考："></a>以下是在实际开发过程中遇到的一些问题，仅供参考：</h3><ol>
<li>异常处理统一使用 error，不要使用 panic/recover 来模拟 throw…catch，最初我是这么做的，后来发现这完全是自以为是的做法。</li>
<li>原生的 error 过于简单，而在实际的 API 开发过程中，不同的异常情况需要附带不同的返回码，基于此，有必要对 error 再进行一层封装。</li>
<li>任何协程逻辑执行体，逻辑最开始处必须要有 defer recover () 异常恢复处理，否则 goroutine 内出现的 panic，将导致整个进程宕掉，需要避免部分逻辑 BUG 造成全局影响。</li>
<li>在 Golang 中，变量 (chan 类型除外) 的操作是非线程安全的，也包括像 int 这样的基本类型，因此并发操作全局变量时一定要考虑加锁，特别是对 map 的并发操作。</li>
<li>所有对 map 键值的获取，都应该判断存在性，最好是对同类操作进行统一封装，避免出现不必要的运行时异常。</li>
<li>定义 slice 数据类型时，尽量预设长度，避免内部出现不必要的数据重组。</li>
</ol>
<h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><p>Go 语言比较常见并且使用广泛的代码规范就是官方提供的 <a href="https://github.com/golang/go/wiki/CodeReviewComments" target="_blank" rel="noopener">Go Code Review Comments</a>，无论你是短期还是长期使用 Go 语言编程，都应该<strong>至少完整地阅读一遍这个官方的代码规范指南</strong>，它既是我们在写代码时应该遵守的规则，也是在代码审查时需要注意的规范。</p>
<h4 id="goimports"><a href="#goimports" class="headerlink" title="goimports"></a>goimports</h4><p><a href="https://godoc.org/golang.org/x/tools/cmd/goimports" target="_blank" rel="noopener">goimports</a> 是 Go 语言官方提供的工具，它能够为我们自动格式化 Go 语言代码并对所有引入的包进行管理，包括自动增删依赖的包引用、将依赖包按字母序排序并分类。相信很多人使用的 IDE 都会将另一个官方提供的工具 <a href="https://golang.org/cmd/gofmt/" target="_blank" rel="noopener">gofmt</a> 对代码进行格式化，而 <code>goimports</code> 就是等于 <code>gofmt</code> 加上依赖包管理。</p>
<h4 id="golint"><a href="#golint" class="headerlink" title="golint"></a>golint</h4><p>在基础库或者框架中使用 <code>golint</code> 进行静态检查（或者同时使用 <code>golint</code> 和 <a href="https://github.com/golangci/golangci-lint" target="_blank" rel="noopener">golangci-lint</a>），在其他的项目中使用可定制化的 <code>golangci-lint</code> 来进行静态检查，因为在基础库和框架中施加强限制对于整体的代码质量有着更大的收益。</p>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p><a href="https://github.com/golang-standards/project-layout" target="_blank" rel="noopener">https://github.com/golang-standards/project-layout</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">├── LICENSE.md</span><br><span class="line">├── Makefile</span><br><span class="line">├── README.md</span><br><span class="line">├── api</span><br><span class="line">├── assets</span><br><span class="line">├── build</span><br><span class="line">├── cmd</span><br><span class="line">├── configs</span><br><span class="line">├── deployments</span><br><span class="line">├── docs</span><br><span class="line">├── examples</span><br><span class="line">├── githooks</span><br><span class="line">├── init</span><br><span class="line">├── internal</span><br><span class="line">├── pkg</span><br><span class="line">├── scripts</span><br><span class="line">├── test</span><br><span class="line">├── third_party</span><br><span class="line">├── tools</span><br><span class="line">├── vendor</span><br><span class="line">├── web</span><br><span class="line">└── website</span><br></pre></td></tr></table></figure>

<h3 id="模块拆分"><a href="#模块拆分" class="headerlink" title="模块拆分"></a>模块拆分</h3><h3 id="显式与隐式"><a href="#显式与隐式" class="headerlink" title="显式与隐式"></a>显式与隐式</h3><h3 id="面向接口-1"><a href="#面向接口-1" class="headerlink" title="面向接口"></a>面向接口</h3><h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><ul>
<li>聊聊 GPM？</li>
<li>go 的 new 和 make 区别</li>
<li>go 怎么从源码编译到二进制文件</li>
<li>go 的调度模型</li>
<li>go 的锁如何实现，用了什么 cpu 指令</li>
<li>go 的 runtime 如何实现</li>
<li>看过 sql 的连接池实现吗</li>
<li>c++ 的 map 和 go 的 map 的区别（红黑树和 hashtable）</li>
<li>ctx 包了解吗？有什么用？</li>
<li>go 什么情况下会发生内存泄漏？（他说 ctx 没有 cancel 的时候，这个真不知道）</li>
<li>怎么实现协程完美退出？</li>
<li>智力题：1000 瓶酒中有 1 瓶毒酒，10 只老鼠，7 天后毒性才发作，第 8 天要卖了，怎么求那瓶毒酒？</li>
<li>简单 dp 题，n*n 矩阵从左上角到右下角有多少种走法（只限往下和往右走）</li>
<li>用 channel 实现定时器？（实际上是两个协程同步）</li>
<li>channel 的实现？</li>
<li>go 为什么高并发好？讲了 go 的调度模型</li>
<li>操作系统内存管理？进程通讯，为什么共享存储区效率最高</li>
<li>实现一个 hashmap，解决 hash 冲突的方法，解决 hash 倾斜的方法</li>
<li>c++ 的模板跟 go 的 interface 的区别</li>
<li>怎么理解 go 的 interface</li>
<li>go 代码运行结果（闭包函数）</li>
<li>git 和 svn 区别，模型</li>
<li>唯一订单号问题，并发量高的话怎么解决</li>
<li>hash 表设计要注意什么问题</li>
<li>数组和为 n 的数组对</li>
<li>lru 实现</li>
<li>多个线程读，一个线程写一个 int32 会不会有问题，int64 呢（这里面试官后来说了要看数据总线的位数，32 位的话写 int32 没问题，int64 就有问题）</li>
<li>GO 语言中的协程与 Python 中的协程的区别？ 主要讲解 Go 中 GMP 机制</li>
</ul>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go doc json  // 输出 json 包对应的文档</span><br></pre></td></tr></table></figure>

<h3 id="跨平台编译"><a href="#跨平台编译" class="headerlink" title="跨平台编译"></a>跨平台编译</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">GOOS=darwin GOARCH=amd64 go build</span><br><span class="line"></span><br><span class="line">GOOS=windows GOARCH=amd64 go build</span><br></pre></td></tr></table></figure>

<h3 id="go-get-被墙"><a href="#go-get-被墙" class="headerlink" title="go get 被墙"></a>go get 被墙</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export http_proxy=socks5://127.0.0.1:1080</span><br><span class="line"></span><br><span class="line">GitHub 上有官方镜像库，如 https://github.com/golang/net 即 https://golang.org/x/net</span><br><span class="line">git clone https://github.com/golang/tools.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 然后进对应目录 go install，bin 目录就有了。</span></span><br><span class="line">go install github/xxx/xxx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> go mod 优先使用镜像</span></span><br><span class="line">go env -w GOPROXY=https://mirrors.aliyun.com/goproxy/</span><br></pre></td></tr></table></figure>

<h3 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"time"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"math/rand"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 例如，`rand.Intn` 返回一个随机的整数 n，`0 &lt;= n &lt;= 100`。</span></span><br><span class="line">    fmt.Print(rand.Intn(<span class="number">100</span>), <span class="string">","</span>)</span><br><span class="line">    fmt.Print(rand.Intn(<span class="number">100</span>))</span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// `rand.Float64` 返回一个64位浮点数 `f`，`0.0 &lt;= f &lt;= 1.0`。</span></span><br><span class="line">    fmt.Println(rand.Float64())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个技巧可以用来生成其他范围的随机浮点数，例如 `5.0 &lt;= f &lt;= 10.0`</span></span><br><span class="line">    fmt.Print((rand.Float64()*<span class="number">5</span>)+<span class="number">5</span>, <span class="string">","</span>)</span><br><span class="line">    fmt.Print((rand.Float64() * <span class="number">5</span>) + <span class="number">5</span>)</span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认情况下，给定的种子是确定的，每次都会产生相同的随机数数字序列。要产生变化的序列，需要给定一个变化的种子。</span></span><br><span class="line">    <span class="comment">// 需要注意的是，如果你出于加密目的，需要使用随机数的话，请使用 `crypto/rand` 包，此方法不够安全。</span></span><br><span class="line">    s1 := rand.NewSource(time.Now().UnixNano())</span><br><span class="line">    r1 := rand.New(s1)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用上面返回的 `rand.Source` 的函数和调用 `rand` 包中函数是相同的。</span></span><br><span class="line">    fmt.Print(r1.Intn(<span class="number">100</span>), <span class="string">","</span>)</span><br><span class="line">    fmt.Print(r1.Intn(<span class="number">100</span>))</span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果使用相同的种子生成的随机数生成器，将会产生相同的随机数序列。</span></span><br><span class="line">    s2 := rand.NewSource(<span class="number">42</span>)</span><br><span class="line">    r2 := rand.New(s2)</span><br><span class="line">    fmt.Print(r2.Intn(<span class="number">100</span>), <span class="string">","</span>)</span><br><span class="line">    fmt.Print(r2.Intn(<span class="number">100</span>))</span><br><span class="line">    fmt.Println()</span><br><span class="line">    s3 := rand.NewSource(<span class="number">42</span>)</span><br><span class="line">    r3 := rand.New(s3)</span><br><span class="line">    fmt.Print(r3.Intn(<span class="number">100</span>), <span class="string">","</span>)</span><br><span class="line">    fmt.Print(r3.Intn(<span class="number">100</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Tricks"><a href="#Tricks" class="headerlink" title="Tricks"></a>Tricks</h3><h4 id="如何声明一个最大的int和uint常量？"><a href="#如何声明一个最大的int和uint常量？" class="headerlink" title="如何声明一个最大的int和uint常量？"></a>如何声明一个最大的int和uint常量？</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MaxUint = ^<span class="keyword">uint</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> MaxInt = <span class="keyword">int</span>(^<span class="keyword">uint</span>(<span class="number">0</span>) &gt;&gt; <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="如何在编译时刻决定系统原生字的尺寸？"><a href="#如何在编译时刻决定系统原生字的尺寸？" class="headerlink" title="如何在编译时刻决定系统原生字的尺寸？"></a>如何在编译时刻决定系统原生字的尺寸？</h4><p>这个技巧和Go无关。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Is64bitArch = ^<span class="keyword">uint</span>(<span class="number">0</span>) &gt;&gt; <span class="number">63</span> == <span class="number">1</span></span><br><span class="line"><span class="keyword">const</span> Is32bitArch = ^<span class="keyword">uint</span>(<span class="number">0</span>) &gt;&gt; <span class="number">63</span> == <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> WordBits = <span class="number">32</span> &lt;&lt; (^<span class="keyword">uint</span>(<span class="number">0</span>) &gt;&gt; <span class="number">63</span>) <span class="comment">// 64或32</span></span><br></pre></td></tr></table></figure>

<h4 id="使用闭包进行调试"><a href="#使用闭包进行调试" class="headerlink" title="使用闭包进行调试"></a>使用闭包进行调试</h4><p>当您在分析和调试复杂的程序时，无数个函数在不同的代码文件中相互调用，如果这时候能够准确地知道哪个文件中的具体哪个函数正在执行，对于调试是十分有帮助的。您可以使用 <code>runtime</code> 或 <code>log</code> 包中的特殊函数来实现这样的功能。包 <code>runtime</code> 中的函数 <code>Caller()</code> 提供了相应的信息，因此可以在需要的时候实现一个 <code>where()</code> 闭包函数来打印函数执行的位置：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">where := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    _, file, line, _ := runtime.Caller(<span class="number">1</span>)</span><br><span class="line">    log.Printf(<span class="string">"%s:%d"</span>, file, line)</span><br><span class="line">&#125;</span><br><span class="line">where()</span><br><span class="line"><span class="comment">// some code</span></span><br><span class="line">where()</span><br><span class="line"><span class="comment">// some more code</span></span><br><span class="line">where()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">log.SetFlags(log.Llongfile)</span><br><span class="line">log.Print(&quot;&quot;)</span><br><span class="line"></span><br><span class="line">var where = log.Print</span><br><span class="line">func func1() &#123;</span><br><span class="line">where()</span><br><span class="line">... some code</span><br><span class="line">where()</span><br><span class="line">... some code</span><br><span class="line">where()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="https://wywwzjj.top">wywwzjj</a>
            </p><p>原文链接：<a href="https://wywwzjj.top/2020/01/24/Go-学习/">https://wywwzjj.top/2020/01/24/Go-学习/</a>
            </p><p>发表日期：<a href="https://wywwzjj.top/2020/01/24/Go-学习/">January 24th 2020, 12:12:07 pm</a>
            </p><p>更新日期：<a href="https://wywwzjj.top/2020/01/24/Go-学习/">March 22nd 2020, 6:11:48 pm</a>
            </p><p>版权声明：本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2020/01/30/ThinkPHP-3-X-5-X-order-by-注入/" title="ThinkPHP 3.X / 5.X order by 注入">
                    <div class="nextTitle">ThinkPHP 3.X / 5.X order by 注入</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2020/01/23/PHP-FPM-RCE/" title="PHP-FPM RCE (CVE-2019-11043)">
                    <div class="prevTitle">PHP-FPM RCE (CVE-2019-11043)</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="//github.com/wywwzjj" class="iconfont-archer github" target="_blank" title="github"></a>
            
        
    
        
            
                <a href="//twitter.com/wywwzjj" class="iconfont-archer twitter" target="_blank" title="twitter"></a>
            
        
    
        
            
                <span class="iconfont-archer qq" title="qq">
                  
                  <img class="profile-qr" src="/assets/QQ.png">
                </span>
            
        
    
        
    
        
            
                <a href="mailto:wywwzjj@gmail.com" class="iconfont-archer email" title="email"></a>
            
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title="rss"></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
        
        
        <span id="busuanzi_container_site_pv" class="theme-info">
            |&nbsp;&nbsp;总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;&nbsp;次
        </span>
        <span id="busuanzi_container_site_uv" class="theme-info">
            &nbsp;&nbsp;|&nbsp;&nbsp;访客数&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;人次&nbsp;&nbsp;|
        </span>
        <!-- <span id="busuanzi_container_site_pv">阅读次数: <span id="busuanzi_value_site_pv"></span> : )</span> -->
        
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么要学-Go？"><span class="toc-number">1.</span> <span class="toc-text">为什么要学 Go？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#学习资源"><span class="toc-number">2.</span> <span class="toc-text">学习资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有关安全项目"><span class="toc-number">3.</span> <span class="toc-text">有关安全项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基础语法"><span class="toc-number">4.</span> <span class="toc-text">基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#变量声明"><span class="toc-number">4.1.</span> <span class="toc-text">变量声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量类型"><span class="toc-number">4.2.</span> <span class="toc-text">变量类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运算符"><span class="toc-number">4.3.</span> <span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#new-与-make"><span class="toc-number">4.4.</span> <span class="toc-text">new 与 make</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常量与枚举"><span class="toc-number">4.5.</span> <span class="toc-text">常量与枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#条件语句"><span class="toc-number">4.6.</span> <span class="toc-text">条件语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#循环"><span class="toc-number">4.7.</span> <span class="toc-text">循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#函数"><span class="toc-number">4.8.</span> <span class="toc-text">函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指针"><span class="toc-number">4.9.</span> <span class="toc-text">指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数组"><span class="toc-number">4.10.</span> <span class="toc-text">数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#切片"><span class="toc-number">4.11.</span> <span class="toc-text">切片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#排序"><span class="toc-number">4.11.1.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#就地去重，需要先排序"><span class="toc-number">4.11.2.</span> <span class="toc-text">就地去重，需要先排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除元素"><span class="toc-number">4.11.3.</span> <span class="toc-text">删除元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#切片比较"><span class="toc-number">4.11.4.</span> <span class="toc-text">切片比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reverse"><span class="toc-number">4.11.5.</span> <span class="toc-text">reverse</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#底层结构"><span class="toc-number">4.11.6.</span> <span class="toc-text">底层结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Copy"><span class="toc-number">4.11.7.</span> <span class="toc-text">Copy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cut"><span class="toc-number">4.11.8.</span> <span class="toc-text">Cut</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Delete-without-preserving-order"><span class="toc-number">4.11.9.</span> <span class="toc-text">Delete without preserving order</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Expand"><span class="toc-number">4.11.10.</span> <span class="toc-text">Expand</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extend"><span class="toc-number">4.11.11.</span> <span class="toc-text">Extend</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Filter-in-place"><span class="toc-number">4.11.12.</span> <span class="toc-text">Filter (in place)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insert"><span class="toc-number">4.11.13.</span> <span class="toc-text">Insert</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#InsertVector"><span class="toc-number">4.11.14.</span> <span class="toc-text">InsertVector</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Push-Front-Unshift"><span class="toc-number">4.11.15.</span> <span class="toc-text">Push Front/Unshift</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pop-Front-Shift"><span class="toc-number">4.11.16.</span> <span class="toc-text">Pop Front/Shift</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Filtering-without-allocating"><span class="toc-number">4.12.</span> <span class="toc-text">Filtering without allocating</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reversing"><span class="toc-number">4.13.</span> <span class="toc-text">Reversing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shuffling"><span class="toc-number">4.14.</span> <span class="toc-text">Shuffling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Batching-with-minimal-allocation"><span class="toc-number">4.15.</span> <span class="toc-text">Batching with minimal allocation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Map"><span class="toc-number">4.16.</span> <span class="toc-text">Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stack"><span class="toc-number">4.17.</span> <span class="toc-text">stack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#heap"><span class="toc-number">4.18.</span> <span class="toc-text">heap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串"><span class="toc-number">4.19.</span> <span class="toc-text">字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件操作"><span class="toc-number">4.20.</span> <span class="toc-text">文件操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命令执行"><span class="toc-number">4.21.</span> <span class="toc-text">命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛型"><span class="toc-number">4.22.</span> <span class="toc-text">泛型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#面向“对象”"><span class="toc-number">5.</span> <span class="toc-text">面向“对象”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#结构体和方法"><span class="toc-number">5.1.</span> <span class="toc-text">结构体和方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#包和封装"><span class="toc-number">5.2.</span> <span class="toc-text">包和封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扩展已有类型"><span class="toc-number">5.3.</span> <span class="toc-text">扩展已有类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义别名"><span class="toc-number">5.3.1.</span> <span class="toc-text">定义别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用组合"><span class="toc-number">5.3.2.</span> <span class="toc-text">使用组合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用内嵌来扩展已有类型"><span class="toc-number">5.4.</span> <span class="toc-text">使用内嵌来扩展已有类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#依赖管理"><span class="toc-number">6.</span> <span class="toc-text">依赖管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#依赖管理-1"><span class="toc-number">6.1.</span> <span class="toc-text">依赖管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GOPATH-和-GOVENDOR"><span class="toc-number">6.2.</span> <span class="toc-text">GOPATH 和 GOVENDOR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#go-mod"><span class="toc-number">6.3.</span> <span class="toc-text">go mod</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#面向接口"><span class="toc-number">7.</span> <span class="toc-text">面向接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#duck-typing"><span class="toc-number">7.1.</span> <span class="toc-text">duck typing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#接口的概念"><span class="toc-number">7.2.</span> <span class="toc-text">接口的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#接口的定义和实现"><span class="toc-number">7.3.</span> <span class="toc-text">接口的定义和实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#接口的值类型"><span class="toc-number">7.4.</span> <span class="toc-text">接口的值类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#接口的组合"><span class="toc-number">7.5.</span> <span class="toc-text">接口的组合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用系统接口"><span class="toc-number">7.6.</span> <span class="toc-text">常用系统接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#函数式编程"><span class="toc-number">8.</span> <span class="toc-text">函数式编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#闭包"><span class="toc-number">8.1.</span> <span class="toc-text">闭包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#反射"><span class="toc-number">9.</span> <span class="toc-text">反射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误处理和资源管理"><span class="toc-number">10.</span> <span class="toc-text">错误处理和资源管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#defer"><span class="toc-number">10.1.</span> <span class="toc-text">defer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#错误处理概念"><span class="toc-number">10.2.</span> <span class="toc-text">错误处理概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务器统一出错处理"><span class="toc-number">10.3.</span> <span class="toc-text">服务器统一出错处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#panic-和-recover"><span class="toc-number">10.4.</span> <span class="toc-text">panic 和 recover</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#最佳实践"><span class="toc-number">10.4.1.</span> <span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题追踪和调试"><span class="toc-number">10.5.</span> <span class="toc-text">问题追踪和调试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#打印日志"><span class="toc-number">10.5.1.</span> <span class="toc-text">打印日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GDB"><span class="toc-number">10.5.2.</span> <span class="toc-text">GDB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试与调优"><span class="toc-number">11.</span> <span class="toc-text">测试与调优</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TDD"><span class="toc-number">11.1.</span> <span class="toc-text">TDD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单元测试"><span class="toc-number">11.2.</span> <span class="toc-text">单元测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#example"><span class="toc-number">11.2.1.</span> <span class="toc-text">example</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#testing-的变量"><span class="toc-number">11.2.2.</span> <span class="toc-text">testing 的变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#testing-包内的结构"><span class="toc-number">11.2.3.</span> <span class="toc-text">testing 包内的结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#testing-的通用方法"><span class="toc-number">11.2.4.</span> <span class="toc-text">testing 的通用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基准测试"><span class="toc-number">11.3.</span> <span class="toc-text">基准测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试-http-服务器"><span class="toc-number">11.4.</span> <span class="toc-text">测试 http 服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#httptest"><span class="toc-number">11.5.</span> <span class="toc-text">httptest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码覆盖率和性能测试"><span class="toc-number">11.6.</span> <span class="toc-text">代码覆盖率和性能测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pprof"><span class="toc-number">11.7.</span> <span class="toc-text">pprof</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成文档和示例代码"><span class="toc-number">11.8.</span> <span class="toc-text">生成文档和示例代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#性能调优分析指标"><span class="toc-number">11.9.</span> <span class="toc-text">性能调优分析指标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#别让性能被锁住"><span class="toc-number">11.10.</span> <span class="toc-text">别让性能被锁住</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高效字符串连接"><span class="toc-number">11.11.</span> <span class="toc-text">高效字符串连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GC-友好"><span class="toc-number">11.12.</span> <span class="toc-text">GC 友好</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#避免内存分配和复制"><span class="toc-number">11.12.1.</span> <span class="toc-text">避免内存分配和复制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#并发编程"><span class="toc-number">12.</span> <span class="toc-text">并发编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Goroutine"><span class="toc-number">12.1.</span> <span class="toc-text">Goroutine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#channel"><span class="toc-number">12.2.</span> <span class="toc-text">channel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#理解调度器"><span class="toc-number">12.3.</span> <span class="toc-text">理解调度器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程池"><span class="toc-number">12.4.</span> <span class="toc-text">线程池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#runtime"><span class="toc-number">12.5.</span> <span class="toc-text">runtime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#context"><span class="toc-number">12.6.</span> <span class="toc-text">context</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原子操作"><span class="toc-number">12.7.</span> <span class="toc-text">原子操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#互斥锁-Mutex"><span class="toc-number">12.8.</span> <span class="toc-text">互斥锁 Mutex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读写锁-RWMutex"><span class="toc-number">12.9.</span> <span class="toc-text">读写锁 RWMutex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Once"><span class="toc-number">12.10.</span> <span class="toc-text">Once</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WaitGroup"><span class="toc-number">12.11.</span> <span class="toc-text">WaitGroup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#竞争条件检测"><span class="toc-number">12.12.</span> <span class="toc-text">竞争条件检测</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常用库"><span class="toc-number">13.</span> <span class="toc-text">常用库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#os"><span class="toc-number">13.1.</span> <span class="toc-text">os</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#time"><span class="toc-number">13.2.</span> <span class="toc-text">time</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定时器-Timers"><span class="toc-number">13.2.1.</span> <span class="toc-text">定时器 Timers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#打点器-Tickers"><span class="toc-number">13.2.2.</span> <span class="toc-text">打点器 Tickers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#速率限制-Rate-Limiting"><span class="toc-number">13.2.3.</span> <span class="toc-text">速率限制 Rate Limiting</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encoding"><span class="toc-number">13.3.</span> <span class="toc-text">encoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#container"><span class="toc-number">13.4.</span> <span class="toc-text">container</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#heap-1"><span class="toc-number">13.4.1.</span> <span class="toc-text">heap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#list"><span class="toc-number">13.4.2.</span> <span class="toc-text">list</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ring"><span class="toc-number">13.4.3.</span> <span class="toc-text">ring</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#regexp"><span class="toc-number">13.5.</span> <span class="toc-text">regexp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strings"><span class="toc-number">13.6.</span> <span class="toc-text">strings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bytes"><span class="toc-number">13.7.</span> <span class="toc-text">bytes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strconv"><span class="toc-number">13.8.</span> <span class="toc-text">strconv</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#casbin"><span class="toc-number">13.9.</span> <span class="toc-text">casbin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jwt-go"><span class="toc-number">13.10.</span> <span class="toc-text">jwt-go</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cobra"><span class="toc-number">13.11.</span> <span class="toc-text">cobra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urfave-cli"><span class="toc-number">13.12.</span> <span class="toc-text">urfave/cli</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#termui"><span class="toc-number">13.13.</span> <span class="toc-text">termui</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#viper"><span class="toc-number">13.14.</span> <span class="toc-text">viper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redigo"><span class="toc-number">13.15.</span> <span class="toc-text">redigo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grpc-go"><span class="toc-number">13.16.</span> <span class="toc-text">grpc-go</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pkg-errors"><span class="toc-number">13.17.</span> <span class="toc-text">pkg/errors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#notify"><span class="toc-number">13.18.</span> <span class="toc-text">notify</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gopherjs"><span class="toc-number">13.19.</span> <span class="toc-text">gopherjs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logrus"><span class="toc-number">13.20.</span> <span class="toc-text">logrus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zap"><span class="toc-number">13.21.</span> <span class="toc-text">zap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#excelize"><span class="toc-number">13.22.</span> <span class="toc-text">excelize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dig"><span class="toc-number">13.23.</span> <span class="toc-text">dig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fasthttp"><span class="toc-number">13.24.</span> <span class="toc-text">fasthttp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gopsutil"><span class="toc-number">13.25.</span> <span class="toc-text">gopsutil</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resty"><span class="toc-number">13.26.</span> <span class="toc-text">resty</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GORM"><span class="toc-number">13.27.</span> <span class="toc-text">GORM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gonum"><span class="toc-number">13.28.</span> <span class="toc-text">gonum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jsoniter"><span class="toc-number">13.29.</span> <span class="toc-text">jsoniter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gofpdf"><span class="toc-number">13.30.</span> <span class="toc-text">gofpdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testify"><span class="toc-number">13.31.</span> <span class="toc-text">Testify</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写个爬虫"><span class="toc-number">14.</span> <span class="toc-text">写个爬虫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#工具集"><span class="toc-number">15.</span> <span class="toc-text">工具集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开发"><span class="toc-number">15.1.</span> <span class="toc-text">开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#调试"><span class="toc-number">15.2.</span> <span class="toc-text">调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络"><span class="toc-number">15.3.</span> <span class="toc-text">网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用网站"><span class="toc-number">15.4.</span> <span class="toc-text">常用网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用库-1"><span class="toc-number">15.5.</span> <span class="toc-text">常用库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最佳实践-1"><span class="toc-number">16.</span> <span class="toc-text">最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#以下是在实际开发过程中遇到的一些问题，仅供参考："><span class="toc-number">16.1.</span> <span class="toc-text">以下是在实际开发过程中遇到的一些问题，仅供参考：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码规范"><span class="toc-number">16.2.</span> <span class="toc-text">代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#goimports"><span class="toc-number">16.2.1.</span> <span class="toc-text">goimports</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#golint"><span class="toc-number">16.2.2.</span> <span class="toc-text">golint</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#目录结构"><span class="toc-number">16.3.</span> <span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块拆分"><span class="toc-number">16.4.</span> <span class="toc-text">模块拆分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#显式与隐式"><span class="toc-number">16.5.</span> <span class="toc-text">显式与隐式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#面向接口-1"><span class="toc-number">16.6.</span> <span class="toc-text">面向接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#面试题"><span class="toc-number">17.</span> <span class="toc-text">面试题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#杂项"><span class="toc-number">18.</span> <span class="toc-text">杂项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#跨平台编译"><span class="toc-number">18.1.</span> <span class="toc-text">跨平台编译</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#go-get-被墙"><span class="toc-number">18.2.</span> <span class="toc-text">go get 被墙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#随机数"><span class="toc-number">18.3.</span> <span class="toc-text">随机数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tricks"><span class="toc-number">18.4.</span> <span class="toc-text">Tricks</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#如何声明一个最大的int和uint常量？"><span class="toc-number">18.4.1.</span> <span class="toc-text">如何声明一个最大的int和uint常量？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#如何在编译时刻决定系统原生字的尺寸？"><span class="toc-number">18.4.2.</span> <span class="toc-text">如何在编译时刻决定系统原生字的尺寸？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用闭包进行调试"><span class="toc-number">18.4.3.</span> <span class="toc-text">使用闭包进行调试</span></a></li></ol></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 58
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href="/2020/03/22/LeetCode-Weekly-Contest-181/">LeetCode Weekly Contest 181</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href="/2020/03/22/LeetCode-Weekly-Contest-22/">LeetCode Weekly Contest 22（双周赛）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/21</span><a class="archive-post-title" href="/2020/03/21/LeetCode-数据库专题/">LeetCode 数据库专题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href="/2020/03/08/LeetCode-Weekly-Contest-179/">LeetCode Weekly Contest 179</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href="/2020/03/08/LeetCode-Weekly-Contest-21/">LeetCode Weekly Contest 21（双周赛）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span><a class="archive-post-title" href="/2020/02/23/LeetCode-Weekly-Contest-177/">LeetCode Weekly Contest 177</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2020/01/30/ThinkPHP-3-X-5-X-order-by-注入/">ThinkPHP 3.X / 5.X order by 注入</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/24</span><a class="archive-post-title" href="/2020/01/24/Go-学习/">Go 学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/23</span><a class="archive-post-title" href="/2020/01/23/PHP-FPM-RCE/">PHP-FPM RCE (CVE-2019-11043)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/17</span><a class="archive-post-title" href="/2020/01/17/ThinkPHP-6.0-任意文件写入/">ThinkPHP 6.0 任意文件写入</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/16</span><a class="archive-post-title" href="/2019/12/16/CSAPP-Chapter-12-Notes/">CSAPP 并发编程 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href="/2019/12/15/smarty-3.1.31-RCE/">smarty 3.1.31 RCE（CVE-2017-1000480）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/02</span><a class="archive-post-title" href="/2019/12/02/CSAPP-Chapter-11-Notes/">CSAPP 网络编程 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href="/2019/11/25/CSAPP-Chapter-10-Notes/">CSAPP 系统级 IO 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/21</span><a class="archive-post-title" href="/2019/11/21/ThinkCMF-前台模板注入-RCE/">ThinkCMF 前台模板注入 RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/11</span><a class="archive-post-title" href="/2019/11/11/CSAPP-Chapter-9-Notes/">CSAPP 虚拟存储器 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2019/10/28/CSAPP-Chapter-8-Notes/">CSAPP 异常控制流 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/24</span><a class="archive-post-title" href="/2019/10/24/Python-pickle-反序列化实例分析/">Python pickle 反序列化实例分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/21</span><a class="archive-post-title" href="/2019/10/21/CSAPP-Chapter-6-Notes/">CSAPP 存储器层次结构 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/10</span><a class="archive-post-title" href="/2019/10/10/CSAPP-Chapter-3-Notes/">CSAPP 程序的机器级表示 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href="/2019/10/06/BalsnCTF-2019-web题/">Balsn CTF 2019 web 题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/08</span><a class="archive-post-title" href="/2019/09/08/CSAPP-Chapter-2-Notes/">CSAPP 信息的表示和处理 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/01</span><a class="archive-post-title" href="/2019/09/01/CSAPP-Chapter-1-Notes/">CSAPP 计算机系统漫游 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/20</span><a class="archive-post-title" href="/2019/08/20/当PHP反序列化遇上SSRF/">当 PHP 反序列化遇上 SSRF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/18</span><a class="archive-post-title" href="/2019/07/18/Discuz-ML!-V3.X-RCE/">Discuz ML! V3.X RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/11</span><a class="archive-post-title" href="/2019/07/11/PHP-写入配置文件经典问题/">PHP 写配置文件经典问题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/18</span><a class="archive-post-title" href="/2019/05/18/phar-与反序列化学习/">phar 与反序列化学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span><a class="archive-post-title" href="/2019/05/17/Redis-未授权访问相关利用/">Redis 未授权访问相关利用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href="/2019/05/12/命令注入总结/">命令注入总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/07</span><a class="archive-post-title" href="/2019/04/07/vulnhub-靶机实战系列-HackInOS/">vulnhub 靶机实战系列 HackInOS</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href="/2019/04/04/Leetcode-322-Coin-Change/">Leetcode 322.Coin Change[DP]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/无字母数字-webshell/">无字母数字 webshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href="/2019/03/02/PHP-SECURITY-CALENDAR-2017/">PHP SECURITY CALENDAR Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href="/2019/03/01/sqlmap-tamper-列表/">sqlmap tamper 列表</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/26</span><a class="archive-post-title" href="/2019/02/26/Jarvis-OJ-inject/">Jarvis OJ inject</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span><a class="archive-post-title" href="/2019/02/25/Jarvis-OJ-phpinfo/">Jarvis OJ phpinfo</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href="/2019/02/02/Hackme-Writeup/">Hackme-Web-Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href="/2019/02/02/Jarvis-OJ-Writeup/">Jarvis OJ Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/01</span><a class="archive-post-title" href="/2019/02/01/Prompt-1-xss-通关记录/">Prompt 1 to win 通关记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/安恒杯-一月-Web/">安恒杯 一月 web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/2019-Fireshell-Web-Vice/">2019 fireshell web Vice</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href="/2019/01/02/POJ-2352-Stars-树状数组/">POJ 2352 Stars[树状数组]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href="/2019/01/02/POJ-2352-Stars-树状数组/">POJ 2352 Stars[树状数组]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href="/2018/12/30/2017-NJCTF-Guess/">2017 NJCTF web guess</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href="/2018/12/30/Code-Breaking-Writeup/">Code Breaking Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href="/2018/12/22/优雅实现哈夫曼编码/">优雅实现哈夫曼编码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span><a class="archive-post-title" href="/2018/12/08/Please_don't_stop_rua_233333/">Please don't stop rua 233333</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/30</span><a class="archive-post-title" href="/2018/11/30/Docker-常用命令/">Docker-常用命令清单</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/23</span><a class="archive-post-title" href="/2018/11/23/漏洞练习平台及工具/">漏洞练习平台及工具</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span><a class="archive-post-title" href="/2018/11/02/Sqli-labs-通关记录/">Sqli-labs 通关笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ-3984-迷宫问题-BFS/">POJ 3984 迷宫问题[BFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ-1321-棋盘问题-DFS/">POJ 1321 棋盘问题[DFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/23</span><a class="archive-post-title" href="/2018/10/23/Raccoon-Writeup/">Raccoon web Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/02</span><a class="archive-post-title" href="/2018/10/02/学习一项技能要花多少时间/">学习一项技能要花多少时间？</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span><a class="archive-post-title" href="/2018/09/26/Bugku-Web-writeup/">Bugku Web 部分WP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/28</span><a class="archive-post-title" href="/2018/07/28/ACM-常用Trick/">ACM 常用小 Trick</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span><a class="archive-post-title" href="/2018/05/16/十年学会编程/">Teach Yourself Programming in Ten Years</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href="/2018/01/25/Hello-World/">Hello World</a>
        </li>
    
    </ul></div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="Writeup"><span class="iconfont-archer">&#xe606;</span>Writeup</span>
    
        <span class="sidebar-tag-name" data-tags="php 伪随机数"><span class="iconfont-archer">&#xe606;</span>php 伪随机数</span>
    
        <span class="sidebar-tag-name" data-tags="读书笔记"><span class="iconfont-archer">&#xe606;</span>读书笔记</span>
    
        <span class="sidebar-tag-name" data-tags="ssrf"><span class="iconfont-archer">&#xe606;</span>ssrf</span>
    
        <span class="sidebar-tag-name" data-tags="算法"><span class="iconfont-archer">&#xe606;</span>算法</span>
    
        <span class="sidebar-tag-name" data-tags="Docker"><span class="iconfont-archer">&#xe606;</span>Docker</span>
    
        <span class="sidebar-tag-name" data-tags="漏洞分析"><span class="iconfont-archer">&#xe606;</span>漏洞分析</span>
    
        <span class="sidebar-tag-name" data-tags="PHP"><span class="iconfont-archer">&#xe606;</span>PHP</span>
    
        <span class="sidebar-tag-name" data-tags="反序列化"><span class="iconfont-archer">&#xe606;</span>反序列化</span>
    
        <span class="sidebar-tag-name" data-tags="SQLi"><span class="iconfont-archer">&#xe606;</span>SQLi</span>
    
        <span class="sidebar-tag-name" data-tags="php"><span class="iconfont-archer">&#xe606;</span>php</span>
    
        <span class="sidebar-tag-name" data-tags="ThinkPHP"><span class="iconfont-archer">&#xe606;</span>ThinkPHP</span>
    
        <span class="sidebar-tag-name" data-tags="心得"><span class="iconfont-archer">&#xe606;</span>心得</span>
    
        <span class="sidebar-tag-name" data-tags="webshell"><span class="iconfont-archer">&#xe606;</span>webshell</span>
    
        <span class="sidebar-tag-name" data-tags="命令注入"><span class="iconfont-archer">&#xe606;</span>命令注入</span>
    
        <span class="sidebar-tag-name" data-tags="smarty"><span class="iconfont-archer">&#xe606;</span>smarty</span>
    
        <span class="sidebar-tag-name" data-tags="xss"><span class="iconfont-archer">&#xe606;</span>xss</span>
    
        <span class="sidebar-tag-name" data-tags="redis"><span class="iconfont-archer">&#xe606;</span>redis</span>
    
        <span class="sidebar-tag-name" data-tags="渗透测试"><span class="iconfont-archer">&#xe606;</span>渗透测试</span>
    
        <span class="sidebar-tag-name" data-tags="SSRF"><span class="iconfont-archer">&#xe606;</span>SSRF</span>
    
        <span class="sidebar-tag-name" data-tags="代码审计"><span class="iconfont-archer">&#xe606;</span>代码审计</span>
    
        <span class="sidebar-tag-name" data-tags="笔记"><span class="iconfont-archer">&#xe606;</span>笔记</span>
    
        <span class="sidebar-tag-name" data-tags="SQL"><span class="iconfont-archer">&#xe606;</span>SQL</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br>
    1、请确保node版本大于6.2<br>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "wywwzjj"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


